<!DOCTYPE html><html><head>
      <title>&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x305D;&#x306E;&#xFF12;</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h1 class="mume-header" id="%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88%E6%B7%B1%E5%B1%A4%E5%AD%A6%E7%BF%92%E3%81%9D%E3%81%AE2">&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x30EC;&#x30DD;&#x30FC;&#x30C8;[&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x305D;&#x306E;&#xFF12;]</h1>

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>
<h2 class="mume-header" id="1%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">1.&#x306F;&#x3058;&#x3081;&#x306B;</h2>

<pre class="language-text">&#x672C;&#x30EC;&#x30DD;&#x30FC;&#x30C8;&#x306F;rabbit challenge&#x53D7;&#x8B1B;&#x8005;&#x300C;Manabu Kobatake&#x300D;&#x304C;&#x307E;&#x3068;&#x3081;&#x305F;
&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;day3&#xFF5E;day4&#x306B;&#x4FC2;&#x308B;&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x30EC;&#x30DD;&#x30FC;&#x30C8;&#x3067;&#x3059;&#x3002;
&#x3010;&#x7121;&#x65AD;&#x8EE2;&#x8F09;&#x7981;&#x6B62;&#x3011;
</pre>
<h2 class="mume-header" id="2section1%E5%86%8D%E5%B8%B0%E5%9E%8B%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%81%AE%E6%A6%82%E5%BF%B5">2.Section1:&#x518D;&#x5E30;&#x578B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x6982;&#x5FF5;</h2>

<pre class="language-text">RNN&#x3068;&#x306F;&#x3001;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x306B;&#x5BFE;&#x5FDC;&#x53EF;&#x80FD;&#x306A;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x3042;&#x308B;&#x3002;
&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x3068;&#x306F;&#xFF1F;
    &#x6642;&#x9593;&#x7684;&#x9806;&#x5E8F;&#x3092;&#x8FFD;&#x3063;&#x3066;&#x4E00;&#x5B9A;&#x9593;&#x9694;&#x3054;&#x3068;&#x306B;&#x89B3;&#x5BDF;&#x3055;&#x308C;&#x3001;
    &#x3057;&#x304B;&#x3082;&#x7DCF;&#x5408;&#x306B;&#x7D71;&#x8A08;&#x7684;&#x4F9D;&#x5B58;&#x95A2;&#x4FC2;&#x304C;&#x8A8D;&#x3081;&#x3089;&#x308C;&#x308B;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x7CFB;&#x5217;
    &#x682A;&#x4FA1;&#x30FB;&#x30FB;&#x30FB;&#x6642;&#x9593;&#x3068;&#x3068;&#x3082;&#x306B;&#x4FA1;&#x683C;&#x306E;&#x9AD8;&#x3055;&#x304C;&#x5909;&#x52D5;&#x3059;&#x308B;&#x3002;
    &#x97F3;&#x58F0;&#x30FB;&#x30FB;&#x30FB;&#x6642;&#x9593;&#x3068;&#x3068;&#x3082;&#x306B;&#x5468;&#x6CE2;&#x6570;&#x3001;&#x5927;&#x304D;&#x3055;&#x304C;&#x5909;&#x52D5;&#x3059;&#x308B;
    &#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x30FB;&#x30FB;&#x30FB;&#x6642;&#x9593;&#x3068;&#x3068;&#x3082;&#x306B;&#x6587;&#x5B57;&#x304C;&#x5909;&#x308F;&#x308B;&#x3002;
</pre>
<p>RNN&#x306E;&#x6570;&#x5B66;&#x7684;&#x8A18;&#x8FF0;<br><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi>W</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">u_t=W_{(in)}x^t+Wz^{t-1}+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1487559999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x203B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;</mtext><mi>b</mi><mtext>&#x306F;</mtext><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><mtext>&#x3068;</mtext><mi>W</mi><mtext>&#x306E;&#x53CC;&#x65B9;&#x306B;&#x5BFE;&#x5FDC;&#x3059;&#x308B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;&#x306E;&#x5408;&#x7B97;</mtext></mrow><annotation encoding="application/x-tex">&#x203B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;b&#x306F;W_{(in)}&#x3068;W&#x306E;&#x53CC;&#x65B9;&#x306B;&#x5BFE;&#x5FDC;&#x3059;&#x308B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;&#x306E;&#x5408;&#x7B97;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04964em;vertical-align:-0.3551999999999999em;"></span><span class="mord">&#x203B;</span><span class="mord cjk_fallback">&#x30D0;&#x30A4;&#x30A2;&#x30B9;</span><span class="mord mathnormal">b</span><span class="mord cjk_fallback">&#x306F;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3068;</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord cjk_fallback">&#x306E;&#x53CC;&#x65B9;&#x306B;&#x5BFE;&#x5FDC;&#x3059;&#x308B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;&#x306E;&#x5408;&#x7B97;</span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>W_in<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>W<span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi>W</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z_t=f(W_{(in)}x^t+Wz^{t-1}+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1487559999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>functions<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub><mo>=</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>Z</mi><mi>t</mi></msup><mo>+</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">v_t=W_{(out)}Z^t+c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1487559999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">v<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>W_out<span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>Z</mi><mi>t</mi></msup><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_t=g(W_{(out)}Z^t+c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1487559999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>functions<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token punctuation">:</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre class="language-text">RNN&#x306E;&#x7279;&#x5FB4;&#x3068;&#x306F;&#xFF1F;
    &#x6642;&#x7CFB;&#x5217;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x6271;&#x3046;&#x306B;&#x306F;&#x3001;&#x521D;&#x671F;&#x306E;&#x72B6;&#x614B;&#x3068;&#x904E;&#x53BB;&#x306E;&#x6642;&#x9593;t-1&#x306E;&#x72B6;&#x614B;&#x3092;&#x4FDD;&#x6301;&#x3057;&#x3001;
    &#x305D;&#x3053;&#x304B;&#x3089;&#x6B21;&#x306E;&#x6642;&#x9593;&#x3067;&#x306E;t&#x3092;&#x518D;&#x5E30;&#x7684;&#x306B;&#x6C42;&#x3081;&#x308B;&#x518D;&#x5E30;&#x69CB;&#x9020;&#x304C;&#x5FC5;&#x8981;&#x306B;&#x306A;&#x308B;&#x3002;

RNN&#x306B;&#x304A;&#x3051;&#x308B;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x8ABF;&#x6574;&#x6CD5;&#x306E;&#x4E00;&#x7A2E;&#x3068;&#x3057;&#x3066;BPTT(Back Propagation Through Time)
&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x3082;&#x306E;&#x304C;&#x3042;&#x308B;&#x3002;
&#x3053;&#x308C;&#x306F;&#x8AA4;&#x5DEE;&#x9006;&#x4F1D;&#x64AD;&#x6CD5;&#x306E;&#x4E00;&#x7A2E;&#x306B;&#x3042;&#x305F;&#x308B;&#x3002;
</pre>
<p>BPTT&#x306E;&#x6570;&#x5B66;&#x7684;&#x8A18;&#x8FF0;<br><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mtext>&#x3092;</mtext><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><mtext>&#x3067;&#x5FAE;&#x5206;</mtext></mrow><annotation encoding="application/x-tex">E&#x3092;W_{(in)}&#x3067;&#x5FAE;&#x5206;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord cjk_fallback">&#x3092;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3067;&#x5FAE;&#x5206;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><msup><mi>u</mi><mi>t</mi></msup><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mi>t</mi></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial W_{(in)}} = \frac{\partial E}{\partial u^t}
\begin{bmatrix}
\frac{u^t}{W_{(in)}}
\end{bmatrix}^T
=\delta^t
\begin{bmatrix}
x^t
\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4837479999999998em;vertical-align:-0.60364em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.031251em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05344em;"><span style="top:-3.0534399999999997em;"><span class="pstrut" style="height:3.00324em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.5534399999999999em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3812309999999999em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.431241em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace></mrow><annotation encoding="application/x-tex">\qquad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x53F3;&#x4E0A;&#x306E;</mtext><mi>T</mi><mo>&#x22EF;</mo><mtext>&#x6642;&#x9593;&#x7684;&#x306B;&#x3055;&#x304B;&#x306E;&#x307C;&#x3063;&#x3066;&#x5FAE;&#x5206;&#x3092;&#x884C;&#x3046;&#x3001;&#x306E;&#x610F;&#x5473;</mtext></mrow><annotation encoding="application/x-tex">&#x53F3;&#x4E0A;&#x306E;T\cdots &#x6642;&#x9593;&#x7684;&#x306B;&#x3055;&#x304B;&#x306E;&#x307C;&#x3063;&#x3066;&#x5FAE;&#x5206;&#x3092;&#x884C;&#x3046;&#x3001;&#x306E;&#x610F;&#x5473;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x53F3;&#x4E0A;&#x306E;</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">&#x6642;&#x9593;&#x7684;&#x306B;&#x3055;&#x304B;&#x306E;&#x307C;&#x3063;&#x3066;&#x5FAE;&#x5206;&#x3092;&#x884C;&#x3046;&#x3001;&#x306E;&#x610F;&#x5473;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial u^t}=\frac{\partial E}{\partial v^t}\frac{\partial v^t}{\partial u^t}=\delta^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">    np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">,</span>delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mtext>&#x3092;</mtext><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mtext>&#x3067;&#x5FAE;&#x5206;</mtext></mrow><annotation encoding="application/x-tex">E&#x3092;W_{(out)}&#x3067;&#x5FAE;&#x5206;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord cjk_fallback">&#x3092;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3067;&#x5FAE;&#x5206;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow></mfrac><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><msup><mi>v</mi><mi>t</mi></msup><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup><mo>=</mo><msup><mi>&#x3B4;</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi></mrow></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>z</mi><mi>t</mi></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial W_{(out)}} = \frac{\partial E}{\partial v^t}
\begin{bmatrix}
\frac{v^t}{W_{(out)}}
\end{bmatrix}^T
=\delta^{out,t}
\begin{bmatrix}
z^t
\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4837479999999998em;vertical-align:-0.60364em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.031251em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05344em;"><span style="top:-3.0534399999999997em;"><span class="pstrut" style="height:3.00324em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.5534399999999999em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3812309999999999em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.431241em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">    np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>delta_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mtext>&#x3092;</mtext><mi>W</mi><mtext>&#x3067;&#x5FAE;&#x5206;</mtext></mrow><annotation encoding="application/x-tex">E&#x3092;W&#x3067;&#x5FAE;&#x5206;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord cjk_fallback">&#x3092;</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord cjk_fallback">&#x3067;&#x5FAE;&#x5206;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>W</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>W</mi></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial W} = \frac{\partial E}{\partial u^t}
\begin{bmatrix}
\frac{\partial u^t}{\partial W}
\end{bmatrix}^T
=\delta^t
\begin{bmatrix}
z^{t-1}
\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.031251em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9316200000000001em;"><span style="top:-2.9316199999999997em;"><span class="pstrut" style="height:3.00324em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.43161999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.3812309999999999em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.431241em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python">    np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mtext>&#x3092;</mtext><mi>b</mi><mtext>&#x3067;&#x5FAE;&#x5206;</mtext></mrow><annotation encoding="application/x-tex">E&#x3092;b&#x3067;&#x5FAE;&#x5206;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord cjk_fallback">&#x3092;</span><span class="mord mathnormal">b</span><span class="mord cjk_fallback">&#x3067;&#x5FAE;&#x5206;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>b</mi></mrow></mfrac><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup><mspace width="2em"></mspace><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>b</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial b}=\frac{\partial E}{\partial u^t}\frac{\partial u^t}{\partial b}=\delta^t\qquad\frac{\partial u^t}{\partial b}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mtext>&#x3092;</mtext><mi>c</mi><mtext>&#x3067;&#x5FAE;&#x5206;</mtext></mrow><annotation encoding="application/x-tex">E&#x3092;c&#x3067;&#x5FAE;&#x5206;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord cjk_fallback">&#x3092;</span><span class="mord mathnormal">c</span><span class="mord cjk_fallback">&#x3067;&#x5FAE;&#x5206;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>c</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>c</mi></mrow></mfrac><mo>=</mo><msup><mi>&#x3B4;</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi></mrow></msup><mspace width="2em"></mspace><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>c</mi></mrow></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial c}=\frac{\partial E}{\partial v^t}\frac{\partial v^t}{\partial c}=\delta^{out,t}\qquad\frac{\partial v^t}{\partial c}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>&#x3B4;</mi><mi>t</mi></msup><mtext>&#x3092;&#x6C42;&#x3081;&#x308B;</mtext></mrow><annotation encoding="application/x-tex">\delta^{t}&#x3092;&#x6C42;&#x3081;&#x308B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3092;&#x6C42;&#x3081;&#x308B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>v</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mo fence="true">{</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mi>f</mi><mo stretchy="false">(</mo><msup><mi>u</mi><mi>t</mi></msup><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mo>=</mo><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">&#x2032;</mo></msup><mo stretchy="false">(</mo><msup><mi>u</mi><mi>t</mi></msup><mo stretchy="false">)</mo><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mi>T</mi></msubsup><mo>&#x22C5;</mo><msup><mi>&#x3B4;</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi></mrow></msup><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup></mrow><annotation encoding="application/x-tex">\frac{\partial E}{\partial u^t}=\frac{\partial E}{\partial v^t}\frac{\partial v^t}{\partial u^t}=
\frac{\partial E}{\partial v^t}\frac{\partial \begin{Bmatrix}W_{(out)}f(u^t)+c\end{Bmatrix}}{\partial u^t}=
f&apos;(u^t)W_{(out)}^T\cdot \delta^{out,t}=\delta^t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.8550099999999998em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5100099999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.71251em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="minner mtight"><span class="mopen sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">{</span></span></span><span class="mord mtight"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0705399999999998em;"><span style="top:-3.0705399999999994em;"><span class="pstrut" style="height:3.1336514285714285em;"></span><span class="mord sizing reset-size3 size6"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.57054em;"><span></span></span></span></span></span></span></span><span class="mclose sizing reset-size3 size6 mtight delimcenter" style="top:0.07500000000000001em;"><span class="delimsizing size1 mtight"><span class="mtight">}</span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3383309999999997em;vertical-align:-0.49699999999999994em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999998em;"><span style="top:-2.378em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x6642;&#x7CFB;&#x5217;&#x7684;&#x306B;</mtext><mn>1</mn><mtext>&#x3064;&#x524D;&#x306E;&#x72B6;&#x614B;&#x306E;</mtext><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mtext>&#x3092;&#x6C42;&#x3081;&#x308B;</mtext></mrow><annotation encoding="application/x-tex">&#x6642;&#x7CFB;&#x5217;&#x7684;&#x306B;1&#x3064;&#x524D;&#x306E;&#x72B6;&#x614B;&#x306E;\delta^{t-1}&#x3092;&#x6C42;&#x3081;&#x308B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x6642;&#x7CFB;&#x5217;&#x7684;&#x306B;</span><span class="mord">1</span><span class="mord cjk_fallback">&#x3064;&#x524D;&#x306E;&#x72B6;&#x614B;&#x306E;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3092;&#x6C42;&#x3081;&#x308B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup><mrow><mo fence="true">{</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mi>t</mi></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><mo>=</mo><msup><mi>&#x3B4;</mi><mi>t</mi></msup><mrow><mo fence="true">{</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>W</mi><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">&#x2032;</mo></msup><mo stretchy="false">(</mo><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\delta^{t-1}=\frac{\partial E}{\partial u^{t-1}}=\frac{\partial E}{\partial u^{t}}\frac{\partial u^{t}}{\partial u^{t-1}}=\delta^t\begin{Bmatrix}\frac{\partial u^t}{\partial z^{t-1}}\frac{\partial z^{t-1}}{\partial u^{t-1}}\end{Bmatrix}=\delta^t\begin{Bmatrix}Wf&apos;(u^{t-1})\end{Bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3482399999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7253428571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-0.65002em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.93896em;"><span style="top:-2.9389600000000002em;"><span class="pstrut" style="height:3.01792em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.00324em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8703428571428571em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01792em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.43895999999999996em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">}</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi></mrow></msup><mrow><mo fence="true">{</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>W</mi><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">&#x2032;</mo></msup><mo stretchy="false">(</mo><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\delta^{t-z-1}=\delta^{t-z}\begin{Bmatrix}Wf&apos;(u^{t-z-1})\end{Bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span></p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># &#x394;^t-1=(&#x394;t^T&#x30FB;W^T + &#x394;_out^t&#x30FB;W_out^T)&#x30FB;f&apos;(u^t)</span>
delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span>W<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>delta_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span>W_out<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> functions<span class="token punctuation">.</span>d_sigmoid<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x66F4;&#x65B0;&#x5F0F;</mtext><mo stretchy="false">(</mo><mtext>&#x3044;&#x305A;&#x308C;&#x3082;&#x5B66;&#x7FD2;&#x7387;</mtext><mi>&#x3F5;</mi><mtext>&#x3092;&#x304B;&#x3051;&#x3066;&#x6E1B;&#x7B97;&#x3059;&#x308B;</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x66F4;&#x65B0;&#x5F0F;(&#x3044;&#x305A;&#x308C;&#x3082;&#x5B66;&#x7FD2;&#x7387;\epsilon &#x3092;&#x304B;&#x3051;&#x3066;&#x6E1B;&#x7B97;&#x3059;&#x308B;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x66F4;&#x65B0;&#x5F0F;</span><span class="mopen">(</span><span class="mord cjk_fallback">&#x3044;&#x305A;&#x308C;&#x3082;&#x5B66;&#x7FD2;&#x7387;</span><span class="mord mathnormal">&#x3F5;</span><span class="mord cjk_fallback">&#x3092;&#x304B;&#x3051;&#x3066;&#x6E1B;&#x7B97;&#x3059;&#x308B;</span><span class="mclose">)</span></span></span></span><br>
&#x5165;&#x529B;&#x5C64;&#x2192;&#x4E2D;&#x9593;&#x5C64;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><mi>t</mi></msubsup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub></mrow></mfrac><mo>=</mo><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><mi>t</mi></msubsup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>&#x2211;</mo><mrow><mi>z</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>T</mi><mi>t</mi></msub></munderover><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi></mrow></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi></mrow></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">W_{(in)}^{t+1}=W_{(in)}^t-\epsilon\frac{\partial E}{\partial W_{(in)}}=W_{(in)}^t-\epsilon \displaystyle \sum_{z=0}^{T_t}\delta^{t-z}\begin{bmatrix}x^{t-z}\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3694389999999999em;vertical-align:-0.5151999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.3598em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.5151999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2905559999999998em;vertical-align:-0.49699999999999994em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.378em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.4837479999999998em;vertical-align:-0.60364em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2905559999999998em;vertical-align:-0.49699999999999994em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.378em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.1065490000000002em;vertical-align:-1.267113em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394360000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.311105em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x4E2D;&#x9593;&#x5C64;&#x2192;&#x51FA;&#x529B;&#x5C64;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mi>t</mi></msubsup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub></mrow></mfrac><mo>=</mo><msubsup><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><mi>t</mi></msubsup><mo>&#x2212;</mo><mi>&#x3F5;</mi><msup><mi>&#x3B4;</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi></mrow></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>z</mi><mi>t</mi></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">W_{(out)}^{t+1}=W_{(out)}^t-\epsilon\frac{\partial E}{\partial W_{(out)}}=W_{(out)}^t-\epsilon\delta^{out,t}\begin{bmatrix}z^t\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3694389999999999em;vertical-align:-0.5151999999999999em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.3598em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.5151999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2905559999999998em;vertical-align:-0.49699999999999994em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.378em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.4837479999999998em;vertical-align:-0.60364em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3447999999999998em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3694857142857143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.60364em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2905559999999998em;vertical-align:-0.49699999999999994em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-2.378em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.431241em;vertical-align:-0.35001em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x4E2D;&#x9593;&#x5C64;&#x2192;&#x4E2D;&#x9593;&#x5C64;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>W</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>W</mi></mrow></mfrac><mo>=</mo><msup><mi>W</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>&#x2211;</mo><mrow><mi>z</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>T</mi><mi>t</mi></msub></munderover><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi></mrow></msup><msup><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>T</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">W^{t+1}=W^t-\epsilon\frac{\partial E}{\partial W}=W^t-\epsilon \displaystyle \sum_{z=0}^{T_t}\delta^{t-z}\begin{bmatrix}z^{t-z-1}\end{bmatrix}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.1065490000000002em;vertical-align:-1.267113em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394360000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.311105em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.081231em;"><span style="top:-3.3029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x30D0;&#x30A4;&#x30A2;&#x30B9;b<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>b</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>b</mi></mrow></mfrac><mo>=</mo><msup><mi>b</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>&#x2211;</mo><mrow><mi>z</mi><mo>=</mo><mn>0</mn></mrow><msub><mi>T</mi><mi>t</mi></msub></munderover><msup><mi>&#x3B4;</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mi>z</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">b^{t+1}=b^t-\epsilon\frac{\partial E}{\partial b}=b^t-\epsilon \displaystyle \sum_{z=0}^{T_t}\delta^{t-z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.1065490000000002em;vertical-align:-1.267113em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394360000000003em;"><span style="top:-1.882887em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.311105em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.267113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x30D0;&#x30A4;&#x30A2;&#x30B9;c<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi>c</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mi>c</mi></mrow></mfrac><mo>=</mo><msup><mi>c</mi><mi>t</mi></msup><mo>&#x2212;</mo><mi>&#x3F5;</mi><msup><mi>&#x3B4;</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo separator="true">,</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">c^{t+1}=c^t-\epsilon\frac{\partial E}{\partial c}=c^t-\epsilon \delta^{out,t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight">c</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">E</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>E</mi><mi>t</mi></msup><mo>=</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><msup><mi>y</mi><mi>t</mi></msup><mo separator="true">,</mo><msup><mi>d</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E^t=loss(y^t,d^t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>=</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>z</mi><mi>t</mi></msup><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>d</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad=loss(g(W_{(out)}z^t+c),d^t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1487559999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>=</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><munder accentunder="true"><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mi>W</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">&#x203E;</mo></munder><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>d</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad=loss(g(W_{(out)}\underline{f(W_{(in)}x^tWz^{t-1}+b)}+c),d^t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3693079999999997em;vertical-align:-0.5551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">oss</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999998em;"><span style="top:-2.4848em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.5551999999999999em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>&#x2193;</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad\qquad\qquad\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2193;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mi>W</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad f(W_{(in)}x^tWz^{t-1}+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1693079999999998em;vertical-align:-0.3551999999999999em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>&#x2193;</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad\qquad\qquad\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2193;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mi>W</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad f(W_{(in)}x^tWf(u^{t-1})+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1693079999999998em;vertical-align:-0.3551999999999999em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>&#x2193;</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad\qquad\qquad\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2193;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mi>W</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>W</mi><msup><mi>z</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>2</mn></mrow></msup><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad f(W_{(in)}x^tWf(W_{(in)}x^{t-1}+Wz^{t-2}+b)+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1693079999999998em;vertical-align:-0.3551999999999999em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>&#x2193;</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad\qquad\qquad\downarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2193;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mi>t</mi></msup><mi>W</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><msup><mi>x</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><mi>W</mi><mi>f</mi><mo stretchy="false">(</mo><msup><mi>u</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>2</mn></mrow></msup><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad f(W_{(in)}x^tWf(W_{(in)}x^{t-1}+Wf(u^{t-2})+b)+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1693079999999998em;vertical-align:-0.3551999999999999em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\qquad\qquad\qquad\qquad\quad\qquad\qquad\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mtext>&#x304C;&#x6642;&#x7CFB;&#x5217;&#x306B;&#x3064;&#x306A;&#x304C;&#x3063;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x3092;&#x8868;&#x3057;&#x3066;&#x3044;&#x308B;</mtext><mo stretchy="false">(</mo><mtext>&#x518D;&#x5E30;&#x7684;</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z&#x304C;&#x6642;&#x7CFB;&#x5217;&#x306B;&#x3064;&#x306A;&#x304C;&#x3063;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x3092;&#x8868;&#x3057;&#x3066;&#x3044;&#x308B;(&#x518D;&#x5E30;&#x7684;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord cjk_fallback">&#x304C;&#x6642;&#x7CFB;&#x5217;&#x306B;&#x3064;&#x306A;&#x304C;&#x3063;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x3092;&#x8868;&#x3057;&#x3066;&#x3044;&#x308B;</span><span class="mopen">(</span><span class="mord cjk_fallback">&#x518D;&#x5E30;&#x7684;</span><span class="mclose">)</span></span></span></span></p>
<h3 class="mume-header" id="2-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">2-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">RNN&#x306F;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x53D6;&#x308A;&#x6271;&#x3046;&#x3053;&#x3068;&#x306B;&#x9069;&#x3057;&#x305F;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x3042;&#x308B;&#x304C;&#x3001;
&#x57FA;&#x672C;&#x7684;&#x306A;&#x30B3;&#x30F3;&#x30BB;&#x30D7;&#x30C8;&#x305D;&#x306E;&#x3082;&#x306E;&#x306F;&#x901A;&#x5E38;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x6982;&#x5FF5;&#x3092;&#x8E0F;&#x8972;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;
&#x305F;&#x3060;&#x3001;&#x9055;&#x3046;&#x306E;&#x306F;&#x9806;&#x4F1D;&#x64AD;&#x306E;&#x969B;&#x306B;&#x300C;&#x6642;&#x7CFB;&#x5217;&#x4E0A;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x51FA;&#x529B;&#x300D;&#x3092;&#x5404;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x5165;&#x529B;&#x3068;&#x3057;&#x3066;
&#x5B66;&#x7FD2;&#x306B;&#x7528;&#x3044;&#x3066;&#x3044;&#x308B;&#x70B9;&#x3068;&#x3001;&#x9006;&#x4F1D;&#x64AD;&#x6CD5;&#x306B;&#x3088;&#x3063;&#x3066;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x66F4;&#x65B0;&#x91CF;&#x3092;&#x6C7A;&#x5B9A;&#x3065;&#x3051;&#x308B;&#x969B;&#x306B;
&#x300C;&#x6642;&#x7CFB;&#x5217;&#x4E0A;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x51FA;&#x529B;&#x300D;&#x3082;&#x9006;&#x4F1D;&#x64AD;&#x306E;&#x5BFE;&#x8C61;&#x3068;&#x306A;&#x308B;&#x3053;&#x3068;&#x3067;&#x3042;&#x308B;&#x3002;
&#x3044;&#x305A;&#x308C;&#x3082;&#x6642;&#x7CFB;&#x5217;&#x9593;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x3064;&#x306A;&#x304C;&#x308A;&#x3092;&#x518D;&#x5E30;&#x7684;&#x306B;&#x51E6;&#x7406;&#x3057;&#x3066;&#x3044;&#x304F;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#x3002;
BPTT&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x9006;&#x4F1D;&#x64AD;&#x6CD5;&#x306E;&#x4E00;&#x7A2E;&#x306B;&#x3088;&#x308A;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x66F4;&#x65B0;&#x91CF;&#x3092;&#x6C42;&#x3081;&#x308B;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#x304C;&#x3001;
&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x51FA;&#x529B;z^t&#x3092;&#x7D10;&#x89E3;&#x3044;&#x3066;&#x3044;&#x304F;&#x3068;&#x904E;&#x53BB;&#x306E;&#x6642;&#x7CFB;&#x5217;&#x306E;&#x51FA;&#x529B;&#x304C;&#x73FE;&#x308F;&#x308C;&#x308B;&#x3002;
&#x305F;&#x3060;&#x3001;&#x975E;&#x5E38;&#x306B;&#x8A08;&#x7B97;&#x91CF;&#x304C;&#x591A;&#x304F;&#x3001;&#x76F8;&#x5FDC;&#x306E;&#x30CF;&#x30FC;&#x30C9;&#x30B9;&#x30DA;&#x30C3;&#x30AF;&#x304C;&#x6C42;&#x3081;&#x3089;&#x308C;&#x308B;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;
&#x3067;&#x3042;&#x308B;&#x3068;&#x306E;&#x5370;&#x8C61;&#x3092;&#x53D7;&#x3051;&#x305F;&#x3002;
</pre>
<h3 class="mume-header" id="2-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">2-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<p>&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x3092;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;&#x306E;&#x5909;&#x66F4;&#x3001;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x6570;&#x3092;&#x8ABF;&#x6574;&#x3057;&#x3066;&#x5B9F;&#x884C;&#x3057;&#x305F;&#x7D50;&#x679C;&#x3092;&#x6BD4;&#x8F03;</p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;<br>&#x521D;&#x671F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;</th>
<th style="text-align:center">&#x4E2D;&#x9593;&#x5C64;&#xD7;8</th>
<th style="text-align:center">&#x4E2D;&#x9593;&#x5C64;&#xD7;16</th>
<th style="text-align:center">&#x4E2D;&#x9593;&#x5C64;&#xD7;32</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center" colspan="4">sigmoid<br>&#x6A19;&#x6E96;&#x504F;&#x5DEE;</td>



</tr>
<tr>
<td style="text-align:center">sigmoid<br>Xavier</td>
<td style="text-align:center" colspan="2">-</td>

<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">sigmoid<br>He</td>
<td style="text-align:center" colspan="2">-</td>

<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">ReLU<br>&#x6A19;&#x6E96;&#x504F;&#x5DEE;</td>
<td style="text-align:center" colspan="2">-</td>

<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<pre class="language-text">&#x3010;&#x8003;&#x5BDF;&#x3011;
    &#x4E2D;&#x9593;&#x5C64;&#x306E;&#x6570;&#x3092;&#x5897;&#x3084;&#x3059;&#x3068;&#x53CE;&#x675F;&#x306B;&#x81F3;&#x308B;&#x307E;&#x3067;&#x306E;&#x6642;&#x9593;&#x304C;&#x77ED;&#x304F;&#x306A;&#x308B;&#x50BE;&#x5411;&#x304C;&#x898B;&#x3066;&#x53D6;&#x308C;&#x308B;&#x3002;
    &#x307E;&#x305F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x521D;&#x671F;&#x5316;&#x65B9;&#x6CD5;&#x3068;&#x3057;&#x3066;Xavier&#x3084;He&#x3092;&#x9078;&#x629E;&#x3057;&#x305F;&#x5834;&#x5408;&#x3082;
    &#x6A19;&#x6E96;&#x504F;&#x5DEE;&#x3067;&#x884C;&#x3046;&#x3088;&#x308A;&#x3082;&#x82E5;&#x5E72;&#x53CE;&#x675F;&#x307E;&#x3067;&#x306E;&#x6642;&#x9593;&#x304C;&#x82E5;&#x5E72;&#x77ED;&#x7E2E;&#x3055;&#x308C;&#x308B;&#x3002;
    &#x306A;&#x304A;&#x3001;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;&#x306B;ReLU&#x3092;&#x7528;&#x3044;&#x305F;&#x5834;&#x5408;&#x3001;&#x52FE;&#x914D;&#x7206;&#x767A;&#x304C;&#x767A;&#x751F;&#x3057;&#x3044;&#x3064;&#x307E;&#x3067;&#x305F;&#x3063;&#x3066;&#x3082;&#x53CE;&#x675F;&#x3057;&#x306A;&#x3044;&#x3002;
</pre>
<p>&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306E;&#x30B3;&#x30FC;&#x30C9;&#x3092;&#x89E3;&#x6790;&#x3057;&#x3001;&#x5404;&#x30B3;&#x30FC;&#x30C9;&#x304C;&#x8868;&#x73FE;&#x3057;&#x3066;&#x3044;&#x308B;&#x6570;&#x5F0F;&#x3092;&#x30B3;&#x30E1;&#x30F3;&#x30C8;&#x4E0A;&#x306B;&#x8A18;&#x8F09;&#x3057;&#x305F;&#x3002;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>iters_num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    
    <span class="token comment"># A, B&#x521D;&#x671F;&#x5316; (a + b = d)</span>
    a_int <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>largest_number<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
    a_bin <span class="token operator">=</span> binary<span class="token punctuation">[</span>a_int<span class="token punctuation">]</span> <span class="token comment"># binary encoding</span>
    b_int <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>largest_number<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
    b_bin <span class="token operator">=</span> binary<span class="token punctuation">[</span>b_int<span class="token punctuation">]</span> <span class="token comment"># binary encoding</span>
    
    <span class="token comment"># &#x6B63;&#x89E3;&#x30C7;&#x30FC;&#x30BF;</span>
    d_int <span class="token operator">=</span> a_int <span class="token operator">+</span> b_int
    d_bin <span class="token operator">=</span> binary<span class="token punctuation">[</span>d_int<span class="token punctuation">]</span>
    
    <span class="token comment"># &#x51FA;&#x529B;&#x30D0;&#x30A4;&#x30CA;&#x30EA;</span>
    out_bin <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>d_bin<span class="token punctuation">)</span>
    
    <span class="token comment"># &#x6642;&#x7CFB;&#x5217;&#x5168;&#x4F53;&#x306E;&#x8AA4;&#x5DEE;</span>
    all_loss <span class="token operator">=</span> <span class="token number">0</span>    
    
    <span class="token comment"># &#x6642;&#x7CFB;&#x5217;&#x30EB;&#x30FC;&#x30D7;</span>
    <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>binary_dim<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># &#x5165;&#x529B;&#x5024;</span>
        X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>a_bin<span class="token punctuation">[</span> <span class="token operator">-</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b_bin<span class="token punctuation">[</span> <span class="token operator">-</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment"># &#x6642;&#x523B;t&#x306B;&#x304A;&#x3051;&#x308B;&#x6B63;&#x89E3;&#x30C7;&#x30FC;&#x30BF;</span>
        dd <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>d_bin<span class="token punctuation">[</span>binary_dim <span class="token operator">-</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># u^t&#x3001;&#x3064;&#x307E;&#x308A;&#x5165;&#x529B;&#x3068;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;z&#x306E;&#x5408;&#x7B97;&#x3092;&#x6C42;&#x3081;&#x308B;</span>
        <span class="token comment"># u^t = X&#x30FB;W_in + z^t-1&#x30FB;W</span>
        <span class="token comment">#-----------------------------------------------</span>
        u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> W_in<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> W<span class="token punctuation">)</span>
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># u^t&#x3092;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;f&#x306B;&#x304B;&#x3051;&#x3066;z^t&#x3092;&#x6C42;&#x3081;&#x308B;</span>
        <span class="token comment"># z^t = f(u^t)</span>
        <span class="token comment">#-----------------------------------------------</span>
        z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> functions<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#         z[:,t+1] = functions.relu(u[:,t+1])</span>
<span class="token comment">#         z[:,t+1] = np.tanh(u[:,t+1])    </span>
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># z^t&#x3068;W_out&#x3092;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;g&#x306B;&#x304B;&#x3051;&#x3066;y^t-1&#x3092;&#x6C42;&#x3081;&#x308B;</span>
        <span class="token comment"># y^t-1 = g(z^t&#x30FB;W_out)</span>
        <span class="token comment">#-----------------------------------------------</span>
        y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> functions<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> W_out<span class="token punctuation">)</span><span class="token punctuation">)</span>


        <span class="token comment">#&#x8AA4;&#x5DEE;&#x3092;&#x6C42;&#x3081;&#x308B;(&#x5E73;&#x5747;&#x4E8C;&#x4E57;&#x8AA4;&#x5DEE;)</span>
        loss <span class="token operator">=</span> functions<span class="token punctuation">.</span>mean_squared_error<span class="token punctuation">(</span>dd<span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>
        
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># &#x9006;&#x4F1D;&#x64AD;&#x7528;&#x306B;&#x394;_out&#x3092;&#x6C42;&#x3081;&#x308B;(E&apos;(y^t-1)&#x30FB;g&apos;(y^t-1))</span>
        <span class="token comment">#-----------------------------------------------</span>
        delta_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> functions<span class="token punctuation">.</span>d_mean_squared_error<span class="token punctuation">(</span>dd<span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> functions<span class="token punctuation">.</span>d_sigmoid<span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>        
        
        <span class="token comment"># &#x6642;&#x7CFB;&#x5217;&#x5206;&#x306E;&#x8AA4;&#x5DEE;&#x3092;&#x3059;&#x3079;&#x3066;&#x7D2F;&#x7A4D;&#x3059;&#x308B;</span>
        all_loss <span class="token operator">+=</span> loss

        out_bin<span class="token punctuation">[</span>binary_dim <span class="token operator">-</span> t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    
    <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>binary_dim<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>a_bin<span class="token punctuation">[</span><span class="token operator">-</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>b_bin<span class="token punctuation">[</span><span class="token operator">-</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        
        
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># &#x6642;&#x7CFB;&#x5217;&#x7684;&#xFF11;&#x3064;&#x524D;&#x306E;&#x394;^t-1&#x3092;&#x6C42;&#x3081;&#x308B;</span>
        <span class="token comment"># &#x394;^t-1 = (&#x394;^t&#x30FB;W + &#x394;out^t-1&#x30FB;W_out)&#x30FB;f&apos;(u^t)</span>
        <span class="token comment">#-----------------------------------------------</span>
        delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span> W<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>delta_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span> W_out<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> functions<span class="token punctuation">.</span>d_sigmoid<span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#         delta[:,t] = (np.dot(delta[:,t+1].T, W.T) + np.dot(delta_out[:,t].T, W_out.T)) * functions.d_relu(u[:,t+1])</span>
<span class="token comment">#         delta[:,t] = (np.dot(delta[:,t+1].T, W.T) + np.dot(delta_out[:,t].T, W_out.T)) * d_tanh(u[:,t+1])    </span>

        <span class="token comment"># &#x52FE;&#x914D;&#x66F4;&#x65B0;</span>
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># &#x51FA;&#x529B;&#x7528;&#x306E;&#x91CD;&#x307F;&#x66F4;&#x65B0;&#x91CF;&#x3092;&#x6C42;&#x3081;&#x308B;&#xFF08;z_t&#x30FB;&#x394;out_t-1&#xFF09;</span>
        <span class="token comment">#-----------------------------------------------</span>
        W_out_grad <span class="token operator">+=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> delta_out<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># &#x4E2D;&#x9593;&#x5C64;&#x7528;&#x306E;&#x91CD;&#x307F;&#x66F4;&#x65B0;&#x91CF;&#x3092;&#x6C42;&#x3081;&#x308B;(z^t-1&#x30FB;&#x394;^t-1)</span>
        <span class="token comment">#-----------------------------------------------</span>
        W_grad <span class="token operator">+=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">#-----------------------------------------------</span>
        <span class="token comment"># &#x5165;&#x529B;&#x7528;&#x306E;&#x91CD;&#x307F;&#x66F4;&#x65B0;&#x91CF;&#x3092;&#x6C42;&#x3081;&#x308B;(X&#x30FB;&#x394;^t-1)</span>
        <span class="token comment">#-----------------------------------------------</span>
        W_in_grad <span class="token operator">+=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">,</span> delta<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># &#x52FE;&#x914D;&#x9069;&#x7528;(&#x5B66;&#x7FD2;&#x7387;&#x3092;&#x304B;&#x3051;&#x308B;)</span>
    W_in <span class="token operator">-=</span> learning_rate <span class="token operator">*</span> W_in_grad
    W_out <span class="token operator">-=</span> learning_rate <span class="token operator">*</span> W_out_grad
    W <span class="token operator">-=</span> learning_rate <span class="token operator">*</span> W_grad

    <span class="token comment"># &#x30C6;&#x30F3;&#x30DD;&#x30E9;&#x30EA;&#x5909;&#x6570;&#x306E;&#x521D;&#x671F;&#x5316;    </span>
    W_in_grad <span class="token operator">*=</span> <span class="token number">0</span>
    W_out_grad <span class="token operator">*=</span> <span class="token number">0</span>
    W_grad <span class="token operator">*=</span> <span class="token number">0</span>
</pre><h3 class="mume-header" id="2-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">2-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    RNN&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306B;&#x306F;&#x5927;&#x304D;&#x304F;&#x5206;&#x3051;&#x3066;3&#x3064;&#x306E;&#x91CD;&#x307F;&#x304C;&#x3042;&#x308B;&#x3002;
    1&#x3064;&#x306F;&#x5165;&#x529B;&#x304B;&#x3089;&#x73FE;&#x5728;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x3092;&#x5B9A;&#x7FA9;&#x3059;&#x308B;&#x969B;&#x306B;&#x304B;&#x3051;&#x3089;&#x308C;&#x308B;&#x91CD;&#x307F;&#x3001;
    1&#x3064;&#x306F;&#x4E2D;&#x9593;&#x5C64;&#x304B;&#x3089;&#x51FA;&#x529B;&#x3092;&#x5B9A;&#x7FA9;&#x3059;&#x308B;&#x969B;&#x306B;&#x304B;&#x3051;&#x3089;&#x308C;&#x308B;&#x91CD;&#x307F;&#x3067;&#x3042;&#x308B;&#x3002;
    &#x6B8B;&#x308A;1&#x3064;&#x306E;&#x91CD;&#x307F;&#x306B;&#x3064;&#x3044;&#x3066;&#x8AAC;&#x660E;&#x305B;&#x3088;&#x3002;

    &#x3010;&#x56DE;&#x7B54;&#x3011;
        &#x6642;&#x7CFB;&#x5217;&#x4E0A;&#x3001;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x304B;&#x3089;&#x4ECA;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x3092;&#x5B9A;&#x7FA9;&#x3059;&#x308B;&#x969B;&#x306B;&#x304B;&#x3051;&#x3089;&#x308C;&#x308B;&#x91CD;&#x307F;

&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    &#x4EE5;&#x4E0B;&#x306F;&#x518D;&#x5E30;&#x578B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306B;&#x304A;&#x3044;&#x3066;&#x69CB;&#x6587;&#x6728;&#x3092;&#x5165;&#x529B;&#x3068;&#x3057;&#x3066;&#x518D;&#x5E30;&#x7684;&#x306B;
    &#x5206;&#x5168;&#x4F53;&#x306E;&#x8868;&#x73FE;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3092;&#x5F97;&#x308B;&#x30D7;&#x30ED;&#x30B0;&#x30E9;&#x30E0;&#x3067;&#x3042;&#x308B;&#x3002;
    &#x305F;&#x3060;&#x3057;&#x3001;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x91CD;&#x307F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306F;&#x30B0;&#x30ED;&#x30FC;&#x30D0;&#x30EB;&#x5909;&#x6570;&#x3068;&#x3057;&#x3066;
    &#x5B9A;&#x7FA9;&#x3057;&#x3066;&#x3042;&#x308B;&#x3082;&#x306E;&#x3068;&#x3057;&#x3001;_activation&#x95A2;&#x6570;&#x306F;&#x306A;&#x3093;&#x3089;&#x304B;&#x306E;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;&#x3067;&#x3042;&#x308B;&#x3068;&#x3059;&#x308B;&#x3002;
    &#x6728;&#x69CB;&#x9020;&#x306F;&#x518D;&#x5E30;&#x7684;&#x306A;&#x8F9E;&#x66F8;&#x3067;&#x5B9A;&#x7FA9;&#x3057;&#x3066;&#x3042;&#x308A;&#x3001;root&#x304C;&#x6700;&#x3082;&#x5916;&#x5074;&#x306E;&#x8F9E;&#x66F8;&#x3067;&#x3042;&#x308B;&#x3068;&#x4EEE;&#x5B9A;&#x3059;&#x308B;&#x3002;
    &#xFF08;&#x304F;&#xFF09;&#x306B;&#x5F53;&#x3066;&#x306F;&#x307E;&#x308B;&#x306E;&#x306F;&#x3069;&#x308C;&#x304B;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_RNN_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%881.png" alt="png"></p>
<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    &#x4E0B;&#x56F3;&#x306E;y1&#x3092;x&#x30FB;z0&#x30FB;z1&#x30FB;w_in&#x30FB;W&#x30FB;W_out&#x3092;&#x7528;&#x3044;&#x3066;&#x6570;&#x5F0F;&#x3067;&#x8868;&#x305B;&#x3002;
    &#x203B;&#x30D0;&#x30A4;&#x30A2;&#x30B9;&#x306F;&#x4EFB;&#x610F;&#x306E;&#x6587;&#x5B57;&#x3067;&#x5B9A;&#x7FA9;&#x305B;&#x3088;
    &#x203B;&#x307E;&#x305F;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x51FA;&#x529B;&#x306B;&#x306F;&#x30B7;&#x30B0;&#x30E2;&#x30A4;&#x30C9;&#x95A2;&#x6570;g(x)&#x3092;&#x4F5C;&#x7528;&#x3055;&#x305B;&#x3088;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_RNN_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%882.png" alt="png"></p>
<p>&#x3010;&#x56DE;&#x7B54;&#x3011;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></msub><mo>&#x22C5;</mo><mi>x</mi><mo>+</mo><mi>W</mi><mo>&#x22C5;</mo><msub><mi>z</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z_1=f(W_{(in)}\cdot x+W\cdot z_0+b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">in</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mrow><mo stretchy="false">(</mo><mi>o</mi><mi>u</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></msub><mo>&#x22C5;</mo><msub><mi>z</mi><mn>1</mn></msub><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y_1=g(W_{(out)}\cdot z_1+c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span></p>
<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_RNN_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%883.png" alt="png"></p>
<h2 class="mume-header" id="3section2lstm">3.Section2:LSTM</h2>

<pre class="language-text">RNN&#x306E;&#x8AB2;&#x984C;
    &#x6642;&#x7CFB;&#x5217;&#x3092;&#x9061;&#x308C;&#x3070;&#x9061;&#x308B;&#x307B;&#x3069;&#x3001;&#x52FE;&#x914D;&#x304C;&#x6D88;&#x5931;&#x3057;&#x3066;&#x3044;&#x304F;&#x3002;
    &#x7279;&#x306B;&#x9577;&#x3044;&#x6642;&#x7CFB;&#x5217;&#x306E;&#x5B66;&#x7FD2;&#x304C;&#x56F0;&#x96E3;&#x3067;RNN&#x3067;&#x306F;&#x975E;&#x5E38;&#x306B;&#x8D77;&#x3053;&#x308A;&#x3084;&#x3059;&#x3044;
    &#x3000;&#x2192;&#x6642;&#x7CFB;&#x5217;&#x540C;&#x58EB;&#x306E;&#x7A4D;&#x304C;&#x5C64;&#x306E;&#x6271;&#x3044;&#x3068;&#x540C;&#x7B49;
        0.5&#xD7;0.5&#xD7;...0.5

&#x89E3;&#x6C7A;&#x7B56;
    &#x52FE;&#x914D;&#x6D88;&#x5931;&#x554F;&#x984C;&#x81EA;&#x4F53;&#x306F;DNN&#x306E;&#x9805;&#x3067;&#x6271;&#x3063;&#x305F;&#x65B9;&#x6CD5;&#x3068;&#x306F;&#x7570;&#x306A;&#x308A;
    &#x69CB;&#x9020;&#x81EA;&#x4F53;&#x3092;&#x5909;&#x3048;&#x3066;&#x89E3;&#x6C7A;&#x3057;&#x305F;&#x306E;&#x304C;LSTM

&#x52FE;&#x914D;&#x7206;&#x767A;
    &#x52FE;&#x914D;&#x304C;&#x5C64;&#x3092;&#x9006;&#x4F1D;&#x64AD;&#x3059;&#x308B;&#x3054;&#x3068;&#x306B;&#x6307;&#x6570;&#x95A2;&#x6570;&#x7684;&#x306B;&#x5927;&#x304D;&#x304F;&#x306A;&#x3063;&#x3066;&#x3044;&#x304F;&#x73FE;&#x8C61;
    &#x3053;&#x306E;&#x73FE;&#x8C61;&#x306B;&#x3088;&#x308A;&#x5B66;&#x7FD2;&#x304C;&#x3046;&#x307E;&#x304F;&#x9032;&#x307E;&#x306A;&#x3044;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_LSTM_%E5%AE%9A%E5%BC%8F.png" alt="png"></p>
<pre class="language-text">CEC(Constant Error Carousel)
    RNN&#x306B;&#x304A;&#x3051;&#x308B;&#x4E2D;&#x9593;&#x5C64;&#x3092;&#x629C;&#x304D;&#x51FA;&#x3057;&#x305F;&#x3082;&#x306E;&#x3002;&#x5B66;&#x7FD2;&#x6A5F;&#x80FD;&#x3068;&#x8A18;&#x61B6;&#x6A5F;&#x80FD;&#x3092;&#x5206;&#x96E2;&#x3057;&#x305F;&#x3068;&#x304D;&#x306E;&#x5F8C;&#x8005;&#x3092;&#x3064;&#x304B;&#x3055;&#x3069;&#x308B;&#x3002;
    &#x52FE;&#x914D;&#x6D88;&#x5931;&#x554F;&#x984C;&#x304A;&#x3088;&#x3073;&#x52FE;&#x914D;&#x7206;&#x767A;&#x3092;&#x89E3;&#x6C7A;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x306F;&#x52FE;&#x914D;&#x304C;&#xFF11;&#x3067;&#x3042;&#x308C;&#x3070;&#x3088;&#x3044;&#x3002;

    &#x8AB2;&#x984C;
        &#x60C5;&#x5831;&#x3092;&#x899A;&#x3048;&#x308B;&#x3060;&#x3051;&#x306A;&#x306E;&#x3067;&#x5B66;&#x7FD2;&#x6A5F;&#x80FD;&#x304C;&#x306A;&#x3044;
        &#x6642;&#x9593;&#x4F9D;&#x5B58;&#x5EA6;&#x306B;&#x95A2;&#x4FC2;&#x306A;&#x304F;&#x91CD;&#x307F;&#x304C;&#x4E00;&#x5B9A;&#x3002;

&#x5165;&#x529B;&#x30B2;&#x30FC;&#x30C8;&#x3068;&#x51FA;&#x529B;&#x30B2;&#x30FC;&#x30C8;
    &#x5165;&#x529B;&#x30B2;&#x30FC;&#x30C8;
        &#x5165;&#x529B;&#x3055;&#x308C;&#x305F;&#x60C5;&#x5831;&#x3092;CEC&#x306B;&#x3069;&#x306E;&#x3088;&#x3046;&#x306B;&#x8A18;&#x61B6;&#x3055;&#x305B;&#x308B;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;
        &#x4ECA;&#x56DE;&#x306E;&#x5165;&#x529B;&#x306E;&#x91CD;&#x307F;Wi&#x3068;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;Ui&#x3092;&#x305D;&#x308C;&#x305E;&#x308C;
        &#x3069;&#x306E;&#x7A0B;&#x5EA6;&#x306E;&#x91CD;&#x307F;&#x3065;&#x3051;&#x3067;CEC&#x306B;&#x6E21;&#x3059;&#x304B;&#x306B;&#x3064;&#x3044;&#x3066;
        &#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;&#x7528;&#x3044;&#x3066;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x3002;
        (CEC&#x3078;&#x8A18;&#x61B6;&#x3055;&#x305B;&#x308B;&#x65B9;&#x6CD5;&#x3092;&#x5B66;&#x7FD2;&#x3059;&#x308B;)
    &#x51FA;&#x529B;&#x30B2;&#x30FC;&#x30C8;
        CEC&#x304C;&#x899A;&#x3048;&#x3066;&#x3044;&#x308B;&#x60C5;&#x5831;&#x3092;&#x53D6;&#x308A;&#x51FA;&#x3057;&#x3066;&#x51FA;&#x529B;&#x3092;&#x751F;&#x6210;&#x3059;&#x308B;&#x969B;&#x3001;
        &#x305D;&#x306E;&#x3088;&#x3046;&#x306B;CEC&#x306E;&#x51FA;&#x529B;&#x3092;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;
        &#x4ECA;&#x56DE;&#x306E;&#x51FA;&#x529B;&#x306E;&#x91CD;&#x307F;Wo&#x3068;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;Uo&#x3092;&#x305E;&#x308C;&#x305E;&#x308C;
        &#x3069;&#x306E;&#x7A0B;&#x5EA6;&#x306E;&#x91CD;&#x307F;&#x3065;&#x3051;&#x3067;CEC&#x304B;&#x3089;&#x53D6;&#x5F97;&#x3059;&#x308B;&#x304B;&#x306B;&#x3064;&#x3044;&#x3066;
        &#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;&#x7528;&#x3044;&#x3066;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x3002;
    
LSTM&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x306E;&#x8AB2;&#x984C;
    CEC&#x306F;&#x3001;&#x904E;&#x53BB;&#x306E;&#x60C5;&#x5831;&#x304C;&#x5168;&#x3066;&#x84C4;&#x7A4D;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
        &#x2193;
    &#x904E;&#x53BB;&#x306E;&#x60C5;&#x5831;&#x304C;&#x4E0D;&#x8981;&#x3068;&#x306A;&#x3063;&#x3066;&#x3082;&#x524A;&#x9664;&#x3067;&#x304D;&#x305A;&#x4FDD;&#x7BA1;&#x3055;&#x308C;&#x7D9A;&#x3051;&#x308B;&#x3002;

    &#x305D;&#x3053;&#x3067;&#x904E;&#x53BB;&#x306E;&#x60C5;&#x5831;&#x304C;&#x4E0D;&#x8981;&#x3068;&#x306A;&#x3063;&#x305F;&#x30BF;&#x30A4;&#x30DF;&#x30F3;&#x30B0;&#x3067;&#x60C5;&#x5831;&#x3092;&#x7834;&#x68C4;&#x3059;&#x308B;&#x6A5F;&#x80FD;&#x304C;&#x5FC5;&#x8981;&#x3002;
        &#x2193;
    &#x5FD8;&#x5374;&#x30B2;&#x30FC;&#x30C8;&#x306E;&#x6982;&#x5FF5;&#x3092;&#x8FFD;&#x52A0;

&#x5FD8;&#x5374;&#x30B2;&#x30FC;&#x30C8;
    CEC&#x306E;&#x4E2D;&#x306E;&#x60C5;&#x5831;&#x3092;&#x3042;&#x308B;&#x30BF;&#x30A4;&#x30DF;&#x30F3;&#x30B0;&#x3067;&#x7834;&#x68C4;&#x3059;&#x308B;&#x3002;
    &#x4ECA;&#x56DE;&#x306E;&#x5165;&#x529B;&#x306E;&#x91CD;&#x307F;Wf&#x3068;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;Uf&#x3092;&#x57FA;&#x306B;&#x3001;
    &#x5FD8;&#x5374;&#x3059;&#x3079;&#x304D;&#x60C5;&#x5831;&#x3092;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x3002;

&#x8997;&#x304D;&#x7A74;&#x7D50;&#x5408;
    CEC&#x306E;&#x4FDD;&#x5B58;&#x60C5;&#x5831;&#x3092;&#x4EFB;&#x610F;&#x306E;&#x30BF;&#x30A4;&#x30DF;&#x30F3;&#x30B0;&#x3067;&#x4ED6;&#x306E;&#x30CE;&#x30FC;&#x30C9;&#x306B;&#x4F1D;&#x64AD;&#x3055;&#x305B;&#x305F;&#x308A;&#x3042;&#x308B;&#x3044;&#x306F;&#x5FD8;&#x5374;&#x3055;&#x305B;&#x305F;&#x3044;&#x3002;
    CEC&#x81EA;&#x8EAB;&#x306E;&#x5024;&#x306F;&#x3001;&#x30B2;&#x30FC;&#x30C8;&#x5236;&#x5FA1;&#x306B;&#x5F71;&#x97FF;&#x3092;&#x4E0E;&#x3048;&#x3066;&#x3044;&#x306A;&#x3044;&#x3002;

    &#x305D;&#x3053;&#x3067;CEC&#x81EA;&#x8EAB;&#x306E;&#x5024;&#x306B;&#x3001;&#x91CD;&#x307F;&#x884C;&#x5217;&#x3092;&#x4ECB;&#x3057;&#x3066;&#x4F1D;&#x64AD;&#x53EF;&#x80FD;&#x306B;&#x3057;&#x305F;&#x69CB;&#x9020;&#x304C;&#x8003;&#x6848;&#x3055;&#x308C;&#x305F;&#x3002;
    &#x3053;&#x306E;&#x69CB;&#x9020;&#x306E;&#x3053;&#x3068;&#x3092;&#x300C;&#x8997;&#x304D;&#x7A74;&#x7D50;&#x5408;&#x300D;&#x3068;&#x3044;&#x3046;&#x3002;

    &#x5404;&#x30B2;&#x30FC;&#x30C8;&#x3067;W&#x3084;U&#x306E;&#x307B;&#x304B;&#x306B;CEC&#x306E;&#x60C5;&#x5831;&#x3092;&#x5224;&#x65AD;&#x6750;&#x6599;&#x3068;&#x3057;&#x3066;
    &#x5229;&#x7528;&#x3059;&#x308B;&#x3068;&#x3044;&#x3046;&#x8A66;&#x307F;&#x3060;&#x304C;&#x3001;&#x5927;&#x304D;&#x306A;&#x52B9;&#x679C;&#x306F;&#x5F97;&#x3089;&#x308C;&#x306A;&#x3044;&#x3002;
</pre>
<h3 class="mume-header" id="3-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">3-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">LSTM&#x306F;RNN&#x3067;&#x767A;&#x751F;&#x3057;&#x3084;&#x3059;&#x3044;&#x52FE;&#x914D;&#x6D88;&#x5931;&#x3082;&#x3057;&#x304F;&#x306F;&#x52FE;&#x914D;&#x7206;&#x767A;&#x3092;&#x56DE;&#x907F;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;
&#x69CB;&#x9020;&#x306E;&#x5909;&#x66F4;&#x306A;&#x3069;&#x5FC5;&#x8981;&#x306A;&#x624B;&#x5F53;&#x3066;&#x3092;&#x9060;&#x616E;&#x306A;&#x304F;&#x65BD;&#x3057;&#x305F;&#x30E2;&#x30C7;&#x30EB;&#x3068;&#x8A00;&#x3048;&#x308B;&#x3002;
CEC&#x3068;&#x5165;&#x529B;&#x30B2;&#x30FC;&#x30C8;&#x3001;&#x51FA;&#x529B;&#x30B2;&#x30FC;&#x30C8;&#x3001;&#x5FD8;&#x5374;&#x30B2;&#x30FC;&#x30C8;&#x305D;&#x308C;&#x305E;&#x308C;&#x304C;&#x62C5;&#x3046;&#x5F79;&#x5272;&#x304C;&#x660E;&#x78BA;&#x306B;&#x5206;&#x304B;&#x308C;&#x3066;&#x304A;&#x308A;&#x3001;
&#x500B;&#x3005;&#x306E;&#x767A;&#x60F3;&#x305D;&#x306E;&#x3082;&#x306E;&#x306F;&#x6BD4;&#x8F03;&#x7684;&#x7406;&#x89E3;&#x3057;&#x3084;&#x3059;&#x3044;&#x3002;
&#x3057;&#x304B;&#x3057;&#x3001;&#x7406;&#x60F3;&#x3092;&#x8FFD;&#x3044;&#x304B;&#x3051;&#x308B;&#x3042;&#x307E;&#x308A;&#x69CB;&#x9020;&#x304C;&#x8907;&#x96D1;&#x5316;&#x3057;&#x305F;&#x3053;&#x3068;&#x3067;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x304C;&#x591A;&#x304F;&#x306A;&#x308A;&#x3001;
&#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x3082;&#x5927;&#x304D;&#x304F;&#x306A;&#x308A;&#x3059;&#x304E;&#x305F;&#x3002;
&#x305D;&#x306E;&#x305F;&#x3081;&#x3001;&#x5F8C;&#x8FF0;&#x3059;&#x308B;GRU&#x306E;&#x6982;&#x5FF5;&#x304C;&#x751F;&#x307E;&#x308C;&#x305F;&#x3002;
</pre>
<h3 class="mume-header" id="3-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">3-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x6F14;&#x7FD2;&#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#xFF1A;&#x52FE;&#x914D;&#x306E;&#x30CE;&#x30EB;&#x30E0;&#x3092;&#x3057;&#x304D;&#x3044;&#x5024;&#x306B;&#x6B63;&#x898F;&#x5316;&#x3059;&#x308B;&#x30ED;&#x30B8;&#x30C3;&#x30AF;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_LSTM_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%882.png" alt="png"></p>
<pre class="language-text">&#x25A0;&#x6F14;&#x7FD2;&#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#xFF1A;LSTM&#x306E;CEC&#x304B;&#x3089;&#x306E;&#x51FA;&#x529B;c(t)&#x3092;&#x6C42;&#x3081;&#x308B;&#x30ED;&#x30B8;&#x30C3;&#x30AF;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_LSTM_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%883.png" alt="png"></p>
<h3 class="mume-header" id="3-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">3-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_LSTM_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%881.png" alt="png"></p>
<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    &#x4EE5;&#x4E0B;&#x306E;&#x6587;&#x7AE0;&#x3092;LSTM&#x306B;&#x5165;&#x529B;&#x3057;&#x7A7A;&#x6B04;&#x306B;&#x5F53;&#x3066;&#x306F;&#x307E;&#x308B;&#x5358;&#x8A9E;&#x3092;&#x4E88;&#x6E2C;&#x3057;&#x305F;&#x3044;&#x3068;&#x3059;&#x308B;&#x3002;
    &#x6587;&#x4E2D;&#x306E;&#x300C;&#x3068;&#x3066;&#x3082;&#x300D;&#x3068;&#x3044;&#x3046;&#x8A00;&#x8449;&#x306F;&#x7A7A;&#x6B04;&#x306E;&#x4E88;&#x6E2C;&#x306B;&#x304A;&#x3044;&#x3066;
    &#x306A;&#x304F;&#x306A;&#x3063;&#x3066;&#x3082;&#x5F71;&#x97FF;&#x3092;&#x53CA;&#x307C;&#x3055;&#x306A;&#x3044;&#x3068;&#x8003;&#x3048;&#x3089;&#x308C;&#x308B;&#x3002;
    &#x3053;&#x306E;&#x3088;&#x3046;&#x306A;&#x5834;&#x5408;&#x3001;&#x3069;&#x306E;&#x30B2;&#x30FC;&#x30C8;&#x304C;&#x4F5C;&#x7528;&#x3059;&#x308B;&#x3068;&#x8003;&#x3048;&#x3089;&#x308C;&#x308B;&#x304B;&#x3002;

    &#x300C;&#x6620;&#x753B;&#x9762;&#x767D;&#x304B;&#x3063;&#x305F;&#x306D;&#x3002;&#x3068;&#x3053;&#x308D;&#x3067;&#x3001;&#x3068;&#x3066;&#x3082;&#x304A;&#x8179;&#x304C;&#x7A7A;&#x3044;&#x305F;&#x304B;&#x3089;&#x4F55;&#x304B;&#xFF3F;&#xFF3F;&#xFF3F;&#xFF3F;&#x3002;&#x300D;

    &#x3010;&#x56DE;&#x7B54;&#x3011;&#xFF1A;&#x5FD8;&#x5374;&#x30B2;&#x30FC;&#x30C8;&#x304C;&#x4F5C;&#x696D;&#x3057;&#x3001;&#x300C;&#x3068;&#x3066;&#x3082;&#x300D;&#x306B;&#x95A2;&#x3059;&#x308B;CEC&#x4E0A;&#x306E;&#x60C5;&#x5831;&#x3092;&#x4E0D;&#x8981;&#x306A;&#x3082;&#x306E;&#x3068;&#x3057;&#x3066;&#x7834;&#x68C4;&#x3059;&#x308B;&#x3002;
</pre>
<h2 class="mume-header" id="4section3gru">4.Section3:GRU</h2>

<pre class="language-text">LSTM&#x306E;&#x8AB2;&#x984C;
    LSTM&#x3067;&#x306F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x304C;&#x591A;&#x304F;&#x3001;&#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x304C;&#x9AD8;&#x304F;&#x306A;&#x308B;&#x554F;&#x984C;&#x304C;&#x3042;&#x3063;&#x305F;&#x3002;
    &#xFF08;RNN&#x3092;&#x3046;&#x307E;&#x304F;&#x52D5;&#x304B;&#x3057;&#x305F;&#x304B;&#x3063;&#x305F;&#x304C;&#x3084;&#x308A;&#x3059;&#x304E;&#x305F;&#xFF09;

GRU(Gated recurrent unit)
    GRU&#x3067;&#x306F;&#x305D;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3092;&#x5927;&#x5E45;&#x306B;&#x524A;&#x6E1B;&#x3057;&#x3001;
    &#x7CBE;&#x5EA6;&#x306F;&#x540C;&#x7B49;&#x307E;&#x305F;&#x306F;&#x305D;&#x308C;&#x4EE5;&#x4E0A;&#x304C;&#x671B;&#x3081;&#x308B;&#x3088;&#x3046;&#x306B;&#x306A;&#x3063;&#x305F;&#x69CB;&#x9020;
    &#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x304C;&#x4F4E;&#x3044;&#x3068;&#x3044;&#x3046;&#x30E1;&#x30EA;&#x30C3;&#x30C8;&#x304C;&#x3042;&#x308B;&#x3002;

&#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;&#x3068;&#x66F4;&#x65B0;&#x30B2;&#x30FC;&#x30C8;
    LSTM&#x306B;&#x6BD4;&#x3079;&#x3066;&#x30B7;&#x30F3;&#x30D7;&#x30EB;&#x306A;&#x69CB;&#x9020;&#x3068;&#x3057;&#x3001;&#x8A08;&#x7B97;&#x91CF;&#x3092;&#x6E1B;&#x3089;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;
    &#x96A0;&#x308C;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x3092;h(t)&#x3068;&#x3057;&#x3066;&#x4FDD;&#x5B58;&#x3059;&#x308B;&#x3002;

    &#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;
        &#x4ECA;&#x56DE;&#x306E;&#x5165;&#x529B;Wr&#x3068;&#x524D;&#x56DE;&#x306E;&#x51FA;&#x529B;Ur&#x3092;&#x3082;&#x3068;&#x306B;
        &#x96A0;&#x308C;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x3092;&#x3069;&#x306E;&#x3088;&#x3046;&#x306B;&#x4FDD;&#x6301;&#x3057;&#x3066;&#x304A;&#x304F;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;&#x2192;r(t)
        &#x2192;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x306B;&#x304B;&#x3051;&#x308B;
    &#x66F4;&#x65B0;&#x30B2;&#x30FC;&#x30C8;
        &#x4ECA;&#x56DE;&#x306E;&#x5165;&#x529B;Wz&#x3068;&#x524D;&#x56DE;&#x306E;&#x51FA;&#x529B;Uz&#x3092;&#x3082;&#x3068;&#x306B;
        &#x3069;&#x306E;&#x3088;&#x3046;&#x306B;&#x51FA;&#x529B;&#x3059;&#x308B;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;&#x2192;z(t)
        &#x2192;&#x524D;&#x56DE;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x306B;&#x304B;&#x3051;&#x308B;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_GRU_%E5%AE%9A%E5%BC%8F.png" alt="png"></p>
<p>&#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;&#x51FA;&#x529B;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mi>r</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>W</mi><mi>r</mi></msub><mo>&#x22C5;</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>U</mi><mi>r</mi></msub><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\quad r(t)=W_r\cdot x(t)+U_r\cdot h(t-1)+b_h(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><br>
&#x5165;&#x529B;&#xFF0B;&#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;&#x51FA;&#x529B;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>r</mi></msub><mo>&#x22C5;</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>U</mi><mi>r</mi></msub><mo>&#x22C5;</mo><mo stretchy="false">(</mo><mi>r</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><msub><mi>b</mi><mi>h</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\quad h(t)=f(W_r\cdot x(t)+U_r\cdot (r(t)\cdot h(t-1))b_h(t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">))</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span><br>
&#x66F4;&#x65B0;&#x30B2;&#x30FC;&#x30C8;&#x51FA;&#x529B;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mi>z</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>W</mi><mi>z</mi></msub><mo>&#x22C5;</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>U</mi><mi>z</mi></msub><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mi>z</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\quad z(t)=W_z\cdot x(t)+U_z\cdot h(t-1)+b_z(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><br>
GRU&#x51FA;&#x529B;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>z</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo>&#x2212;</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>&#x2212;</mo><mi>z</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\quad h(t)=z(t)\cdot h(t-1)+(1-z(t))\cdot h(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></p>
<h3 class="mume-header" id="4-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">4-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">GRU&#x306F;LSTM&#x306E;&#x8AB2;&#x984C;&#x3067;&#x3042;&#x308B;&#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x304C;&#x5927;&#x304D;&#x3044;&#x70B9;&#x3092;&#x514B;&#x670D;&#x3057;&#x305F;&#x6A5F;&#x69CB;&#x3067;&#x3001;
&#x5358;&#x7D14;&#x306B;&#x8CA0;&#x8377;&#x306E;&#x6291;&#x5236;&#x306E;&#x307F;&#x306A;&#x3089;&#x305A;&#x3001;&#x7CBE;&#x5EA6;&#x306E;&#x5411;&#x4E0A;&#x3082;&#x898B;&#x8FBC;&#x3081;&#x308B;&#x3053;&#x3068;&#x304C;&#x5927;&#x304D;&#x3044;&#x3002;
&#x8CA0;&#x8377;&#x306E;&#x6291;&#x5236;&#x3067;&#x304D;&#x3066;&#x3044;&#x308B;&#x7406;&#x7531;&#x306F;LSTM&#x306B;&#x6BD4;&#x3079;&#x3066;&#x30B7;&#x30F3;&#x30D7;&#x30EB;&#x306A;&#x69CB;&#x9020;&#x306B;&#x3057;&#x305F;&#x3053;&#x3068;&#x306B;&#x3042;&#x308B;&#x3002;
&#x96A0;&#x308C;&#x5C64;&#x3092;h(t)&#x3068;&#x3057;&#x3066;&#x4FDD;&#x6301;&#x3057;&#x3001;&#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;&#x306B;&#x3088;&#x308A;&#x96A0;&#x308C;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x3092;&#x3069;&#x3046;
&#x6271;&#x3046;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3057;&#x3001;&#x66F4;&#x65B0;&#x30B2;&#x30FC;&#x30C8;&#x306B;&#x3088;&#x308A;&#x51FA;&#x529B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;
&#x3053;&#x306E;&#x305F;&#x3081;&#x3001;LSTM&#x3088;&#x308A;&#x3082;&#x6271;&#x3046;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306F;&#x5C11;&#x306A;&#x304F;&#x3066;&#x6E08;&#x3080;&#x3002;
</pre>
<h3 class="mume-header" id="4-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">4-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x6F14;&#x7FD2;&#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#xFF1A;GRU&#x306E;&#x6700;&#x7D42;&#x51FA;&#x529B;h(t)&#x3092;&#x6C42;&#x3081;&#x308B;&#x30ED;&#x30B8;&#x30C3;&#x30AF;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_GRU_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%881.png" alt="png"></p>
<h3 class="mume-header" id="4-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">4-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    LSTM&#x3068;CEC&#x304C;&#x62B1;&#x3048;&#x308B;&#x8AB2;&#x984C;&#x306B;&#x3064;&#x3044;&#x3066;&#x3001;&#x305D;&#x308C;&#x305E;&#x308C;&#x7C21;&#x6F54;&#x306B;&#x8FF0;&#x3079;&#x3088;&#x3002;
    LSTM&#x306E;&#x8AB2;&#x984C;
        4&#x3064;&#x306E;&#x90E8;&#x54C1;&#x304C;&#x3042;&#x308A;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x304C;&#x591A;&#x3059;&#x304E;&#x3066;&#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x304C;&#x9AD8;&#x3044;&#x3053;&#x3068;
        
    CEC&#x306E;&#x8AB2;&#x984C;
        &#x5B66;&#x7FD2;&#x80FD;&#x529B;&#x304C;&#x306A;&#x3044;&#x306E;&#x3067;&#x5404;&#x30B2;&#x30FC;&#x30C8;&#x3067;&#x88DC;&#x3046;&#x3053;&#x3068;&#x3068;&#x306A;&#x308B;&#x3002;

&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    LSTM&#x3068;GRU&#x306E;&#x9055;&#x3044;&#x3092;&#x7C21;&#x6F54;&#x306B;&#x8FF0;&#x3079;&#x3088;&#x3002;
    LSTM&#x306F;CEC,&#x5165;&#x529B;&#x30B2;&#x30FC;&#x30C8;,&#x5FD8;&#x5374;&#x30B2;&#x30FC;&#x30C8;,&#x51FA;&#x529B;&#x30B2;&#x30FC;&#x30C8;&#x3068;&#x3044;&#x3046;4&#x3064;&#x306E;&#x90E8;&#x54C1;&#x304B;&#x3089;&#x69CB;&#x6210;&#x3055;&#x308C;&#x308B;&#x3002;
    GRU&#x306F;&#x30EA;&#x30BB;&#x30C3;&#x30C8;&#x30B2;&#x30FC;&#x30C8;,&#x66F4;&#x65B0;&#x30B2;&#x30FC;&#x30C8;&#x306E;2&#x3064;&#x306E;&#x90E8;&#x54C1;&#x306E;&#x307F;&#x3067;&#x69CB;&#x6210;&#x3055;&#x308C;&#x308B;&#x3002;
    LSTM&#x306B;&#x6BD4;&#x3057;&#x3066;GRU&#x306F;&#x90E8;&#x54C1;&#x306E;&#x6570;&#x3059;&#x306A;&#x308F;&#x3061;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x6570;&#x304C;&#x5C11;&#x306A;&#x304F;&#x3001;&#x305D;&#x306E;&#x5206;&#x8A08;&#x7B97;&#x8CA0;&#x8377;&#x3082;&#x4F4E;&#x3044;&#x3002;
</pre>
<h2 class="mume-header" id="5section4%E5%8F%8C%E6%96%B9%E5%90%91rnn">5.Section4:&#x53CC;&#x65B9;&#x5411;RNN</h2>

<pre class="language-text">&#x53CC;&#x65B9;&#x5411;RNN(Bidirectional RNN)&#x3068;&#x306F;
    &#x904E;&#x53BB;&#x306E;&#x60C5;&#x5831;&#x3060;&#x3051;&#x3067;&#x306A;&#x304F;&#x3001;&#x672A;&#x6765;&#x306E;&#x60C5;&#x5831;&#x3092;&#x52A0;&#x5473;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3001;
    &#x7CBE;&#x5EA6;&#x3092;&#x5411;&#x4E0A;&#x3055;&#x305B;&#x308B;&#x305F;&#x3081;&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x30E2;&#x30C7;&#x30EB;&#x3002;
    &#x5B66;&#x7FD2;&#x6642;&#x306B;&#x3001;&#x904E;&#x53BB;&#x3068;&#x672A;&#x6765;&#x306E;&#x60C5;&#x5831;&#x306E;&#x5165;&#x529B;&#x3092;&#x5FC5;&#x8981;&#x3068;&#x3059;&#x308B;&#x3053;&#x3068;&#x304B;&#x3089;&#x3001;
    &#x904B;&#x7528;&#x6642;&#x3082;&#x904E;&#x53BB;&#x304B;&#x3089;&#x672A;&#x6765;&#x307E;&#x3067;&#x306E;&#x3059;&#x3079;&#x3066;&#x306E;&#x60C5;&#x5831;&#x3092;&#x5165;&#x529B;&#x3057;&#x3066;&#x306F;&#x3058;&#x3081;&#x3066;&#x4E88;&#x6E2C;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x306A;&#x308B;&#x3002;

&#x5B9F;&#x7528;&#x4F8B;
    &#x6587;&#x7AE0;&#x306E;&#x63A8;&#x6572;&#x3084;&#x3001;&#x6A5F;&#x68B0;&#x7FFB;&#x8A33;&#x7B49;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E5%8F%8C%E6%96%B9%E5%90%91RNN_%E5%AE%9A%E5%BC%8F.png" alt="png"></p>
<h3 class="mume-header" id="5-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">5-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">&#x53CC;&#x65B9;&#x5411;RNN&#x306F;&#x6642;&#x7CFB;&#x5217;&#x4E0A;&#x3001;&#x6B21;&#x306E;&#x6642;&#x70B9;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x5B66;&#x7FD2;&#x306B;&#x904E;&#x53BB;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x3060;&#x3051;&#x3067;&#x306A;&#x304F;&#x3001;
&#x672A;&#x6765;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x306E;&#x72B6;&#x614B;&#x3082;&#x52A0;&#x5473;&#x3059;&#x308B;&#x3068;&#x3044;&#x3046;&#x30A2;&#x30D7;&#x30ED;&#x30FC;&#x30C1;&#x3067;&#x3001;
&#x901A;&#x5E38;&#x306E;RNN&#x3088;&#x308A;&#x3082;&#x3088;&#x308A;&#x7CBE;&#x5EA6;&#x306E;&#x9AD8;&#x3044;&#x7D50;&#x679C;&#x304C;&#x671F;&#x5F85;&#x3067;&#x304D;&#x308B;&#x3002;
&#x904E;&#x53BB;&#x3068;&#x672A;&#x6765;&#x306E;&#x4E2D;&#x9593;&#x5C64;&#x51FA;&#x529B;&#x3092;&#x540C;&#x4E00;&#x30BB;&#x30C3;&#x30C8;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3068;&#x3057;&#x3066;&#x9023;&#x7D50;&#x3057;
&#x5404;&#x6642;&#x70B9;&#x3067;&#x306E;&#x5B66;&#x7FD2;&#x306B;&#x7528;&#x3044;&#x308B;&#x3002;
&#x4E3B;&#x306B;&#x6587;&#x7AE0;&#x306E;&#x63A8;&#x6572;&#x3084;&#x6A5F;&#x68B0;&#x7FFB;&#x8A33;&#x7B49;&#x306B;&#x7528;&#x3044;&#x3089;&#x308C;&#x308B;&#x3053;&#x3068;&#x304C;&#x591A;&#x3044;&#x3002;
&#x305F;&#x3060;&#x3057;&#x3001;&#x8A08;&#x7B97;&#x91CF;&#x306F;&#x901A;&#x5E38;&#x306E;RNN&#x3088;&#x308A;&#x3082;&#x591A;&#x304F;&#x306A;&#x308B;&#x4E0A;&#x3001;&#x672A;&#x6765;&#x306E;&#x60C5;&#x5831;&#x304C;
&#x5168;&#x3066;&#x6574;&#x3063;&#x305F;&#x72B6;&#x614B;&#x3067;&#x306A;&#x3044;&#x3068;&#x5B66;&#x7FD2;&#x304C;&#x3067;&#x304D;&#x306A;&#x3044;&#x3068;&#x3044;&#x3046;&#x5236;&#x9650;&#x304C;&#x3042;&#x308B;&#x3002;
&#x30AA;&#x30F3;&#x30E9;&#x30A4;&#x30F3;&#x5B66;&#x7FD2;&#x7684;&#x306A;&#x968F;&#x6642;&#x51E6;&#x7406;&#x306B;&#x306F;&#x4E0D;&#x5411;&#x304D;&#x3068;&#x611F;&#x3058;&#x305F;&#x3002;
</pre>
<h3 class="mume-header" id="5-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">5-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x554F;&#x984C;&#xFF1A;&#x53CC;&#x65B9;&#x5411;RNN&#x306B;&#x304A;&#x3051;&#x308B;&#x4E2D;&#x9593;&#x5C64;&#x51FA;&#x529B;&#x306E;&#x6271;&#x3044;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E5%8F%8C%E6%96%B9%E5%90%91RNN_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%881.png" alt="png"></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x6570;&#x5F0F;&#x8868;&#x73FE;&#xFF1A;</mtext><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>&#x3D5;</mi><mrow><mo fence="true">(</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mover accent="true"><msub><mi>H</mi><mi>t</mi></msub><mo stretchy="true">&#x2192;</mo></mover></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mover accent="true"><msub><mi>H</mi><mi>t</mi></msub><mo stretchy="true">&#x2190;</mo></mover></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><mi>W</mi><mo>+</mo><msub><mi>b</mi><mi>y</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">&#x6570;&#x5F0F;&#x8868;&#x73FE;&#xFF1A;y_t=\phi\begin{pmatrix}\begin{pmatrix}\overrightarrow{H_t} \\ \overleftarrow{H_t} \end{pmatrix}W+b_y\end{pmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">&#x6570;&#x5F0F;&#x8868;&#x73FE;&#xFF1A;</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1306600000000007em;vertical-align:-1.3153300000000003em;"></span><span class="mord mathnormal">&#x3D5;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8153300000000003em;"><span style="top:-3.8153300000000003em;"><span class="pstrut" style="height:3.8153300000000003em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.81533em;"><span style="top:-3.81533em;"><span class="pstrut" style="height:3.20533em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span style="top:-2.2499999999999996em;"><span class="pstrut" style="height:3.20533em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.20533em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833299999999998em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="height:0.522em;min-width:0.888em;"><svg width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMinYMin slice"><path d="M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.3153300000000006em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.3153300000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span></span></span></span></p>
<h3 class="mume-header" id="5-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">5-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x306A;&#x3057;
</pre>
<h2 class="mume-header" id="6section5seq2seq">6.Section5:Seq2Seq</h2>

<pre class="language-text">2&#x3064;&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;&#x30C9;&#x30C3;&#x30AD;&#x30F3;&#x30B0;&#x3057;&#x3066;&#x4F7F;&#x3046;&#x81EA;&#x7136;&#x8A00;&#x8A9E;&#x7528;&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x69CB;&#x6210;
&#x6A5F;&#x68B0;&#x7FFB;&#x8A33;&#x306B;&#x7528;&#x3044;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
Encoder-Decoder&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x4E00;&#x7A2E;&#x3002;
&#xFF08;&#x6642;&#x7CFB;&#x5217;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x5165;&#x529B;&#x306B;&#x3068;&#x3063;&#x3066;&#x3001;&#x6642;&#x7CFB;&#x5217;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x51FA;&#x529B;&#x3059;&#x308B;&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_seq2seq_%E5%AE%9A%E5%BC%8F.png" alt="png"></p>
<pre class="language-text">Encoder RNN
    Taking
        &#x6587;&#x7AE0;&#x3092;&#x5358;&#x8A9E;&#x7B49;&#x306E;&#x30C8;&#x30FC;&#x30AF;&#x30F3;&#x3054;&#x3068;&#x306B;&#x5206;&#x5272;&#x3057;&#x3001;&#x30C8;&#x30FC;&#x30AF;&#x30F3;&#x3054;&#x3068;&#x306E;ID&#x306B;&#x5206;&#x5272;&#x3059;&#x308B;&#x3002;
    Embededding
        ID&#x304B;&#x3089;&#x3001;&#x305D;&#x306E;&#x30C8;&#x30FC;&#x30AF;&#x30F3;&#x3092;&#x8868;&#x3059;&#x5206;&#x6563;&#x8868;&#x73FE;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306B;&#x5909;&#x63DB;&#x3002;
    Encoder RNN
        &#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3092;&#x9806;&#x756A;&#x306B;RNN&#x306B;&#x5165;&#x529B;&#x3057;&#x3066;&#x3044;&#x304F;
        1.vec1&#x3092;RNN&#x306B;&#x5165;&#x529B;&#x3057;&#x3001;hidden state&#x3092;&#x51FA;&#x529B;&#x3002;
        &#x3053;&#x306E;hidden state&#x3068;&#x6B21;&#x306E;&#x5165;&#x529B;vec2&#x3092;&#x307E;&#x305F;RNN&#x306B;&#x5165;&#x529B;&#x3057;&#x3066;&#x304D;&#x305F;
        hidden state&#x3092;&#x51FA;&#x529B;&#x3068;&#x3044;&#x3046;&#x6D41;&#x308C;&#x3092;&#x7E70;&#x308A;&#x8FD4;&#x3059;&#x3002;

        2.&#x6700;&#x5F8C;&#x306E;vec&#x3092;&#x5165;&#x308C;&#x305F;&#x3068;&#x304D;&#x306E;hidden state&#x3092;final state&#x3068;&#x3057;&#x3066;&#x3068;&#x3063;&#x3066;&#x304A;&#x304F;&#x3002;
        &#x3053;&#x306E;final state&#x304C;thought vector&#x3068;&#x547C;&#x3070;&#x308C;&#x3001;&#x5165;&#x529B;&#x3057;&#x305F;&#x5206;&#x306E;&#x610F;&#x5473;&#x3092;&#x8868;&#x3059;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3068;&#x306A;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_seq2seq_DecoderRNN.png" alt="png"></p>
<pre class="language-text">Decoder RNN
    &#x5165;&#x529B;&#x3068;&#x306A;&#x3063;&#x305F;&#x6587;&#x8108;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x8868;&#x73FE;&#x304B;&#x3089;&#x5BFE;&#x5FDC;&#x3059;&#x308B;
    &#x5358;&#x8A9E;&#x7B49;&#x306E;&#x30C8;&#x30FC;&#x30AF;&#x30F3;&#x3054;&#x3068;&#x306B;&#x751F;&#x6210;&#x3059;&#x308B;&#x69CB;&#x9020;
    1.Decorder RNN
        Encoder RNN&#x306E;final state(thought vector)&#x304B;&#x3089;&#x3001;
        &#x5404;token&#x306E;&#x751F;&#x6210;&#x78BA;&#x7387;&#x3092;&#x51FA;&#x529B;&#x3057;&#x3066;&#x3044;&#x304F;&#x3002;
        final state&#x3092;Decode RNN&#x306E;initial state&#x3068;&#x3057;&#x3066;&#x8A2D;&#x5B9A;&#x3057;&#x3001;Embedding&#x3092;&#x5165;&#x529B;&#x3002;
    2.Sampling  
        &#x751F;&#x6210;&#x78BA;&#x7387;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;token&#x3092;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x306B;&#x9078;&#x3076;
    3.Embedding
        2.&#x3067;&#x9078;&#x3070;&#x308C;&#x305F;token&#x3092;Embedding&#x8868;&#x73FE;&#x306B;&#x5909;&#x66F4;&#x3057;&#x3001;Decode RNN&#x306E;&#x6B21;&#x306E;&#x5165;&#x529B;&#x3068;&#x3059;&#x308B;&#x3002;
    4.Detokenize
        1-3&#x3092;&#x7E70;&#x308A;&#x8FD4;&#x3057;&#x3001;2&#x3067;&#x5F97;&#x3089;&#x308C;&#x305F;token&#x3092;&#x6587;&#x5B57;&#x5217;&#x306B;&#x76F4;&#x3057;&#x307E;&#x3059;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_seq2seq_EncoderRNN.png" alt="png"></p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x5358;&#x8A9E;</th>
<th style="text-align:center">ID</th>
<th style="text-align:center">&#x30D9;&#x30AF;&#x30C8;&#x30EB;(One-Hot)<br>10,000</th>
<th style="text-align:center">Embedding&#x8868;&#x73FE;<br>&#x6570;&#x767E;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x79C1;</td>
<td style="text-align:center">1</td>
<td style="text-align:center">[1,0,0,...0]</td>
<td style="text-align:center">[0.2,0.4,0.6...0.1]</td>
</tr>
<tr>
<td style="text-align:center">&#x306F;</td>
<td style="text-align:center">2</td>
<td style="text-align:center">[0,1,0,...0]</td>
<td style="text-align:center">[0.1,0.3,0.5...0.1]</td>
</tr>
<tr>
<td style="text-align:center">&#x6628;&#x65E5;</td>
<td style="text-align:center">3</td>
<td style="text-align:center">[0,0,1,...0]</td>
<td style="text-align:center">[0.6,0.4,0.3...0.1]</td>
</tr>
<tr>
<td style="text-align:center">&#x523A;&#x8EAB;</td>
<td style="text-align:center">4</td>
<td style="text-align:center">[0,0,0,1...0]</td>
<td style="text-align:center">[0.9,0.7,0.1...0.1]</td>
</tr>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">&#x3067;&#x3057;&#x305F;&#x3002;</td>
<td style="text-align:center">10,000</td>
<td style="text-align:center">[0,0,0,...1]</td>
<td style="text-align:center">[0.5,0.8,0.2...0.9]</td>
</tr>
</tbody>
</table>
<pre class="language-text">    &#x4F55;&#x3089;&#x304B;&#x306E;&#x8868;&#x73FE;&#x304B;&#x3089;Embedding&#x8868;&#x73FE;&#x3092;&#x5F97;&#x3066;&#x3001;&#x540C;&#x3058;&#x3088;&#x3046;&#x306A;&#x610F;&#x5473;&#x5408;&#x3044;&#x306E;
    &#x5358;&#x8A9E;&#x3092;&#x4F3C;&#x901A;&#x3063;&#x305F;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x8868;&#x73FE;&#x306B;&#x8FD1;&#x3065;&#x3051;&#x308B;&#x3053;&#x3068;&#x304C;&#x3001;&#x81EA;&#x7136;&#x8A00;&#x8A9E;&#x51E6;&#x7406;&#x306B;&#x304A;&#x3051;&#x308B;&#x91CD;&#x8981;&#x306A;&#x8AB2;&#x984C;&#x3067;&#x3042;&#x308B;&#x3002;
</pre>
<p>MLM-Masked Language Model<br>
&#x4E00;&#x90E8;&#x306E;&#x5358;&#x8A9E;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x8868;&#x73FE;&#x3092;&#x96A0;&#x3057;&#x3001;&#x4ED6;&#x306E;&#x96A0;&#x3055;&#x308C;&#x3066;&#x3044;&#x306A;&#x3044;&#x5358;&#x8A9E;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x8868;&#x73FE;&#x304B;&#x3089;<br>
&#x96A0;&#x3055;&#x308C;&#x305F;&#x5358;&#x8A9E;&#x306E;&#x610F;&#x5473;&#x5408;&#x3044;&#x3092;&#x4E88;&#x6E2C;&#x3059;&#x308B;&#x3053;&#x3068;&#x3092;&#x8A66;&#x307F;&#x308B;&#x3002;</p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x79C1;</th>
<th style="text-align:center">&#x306F;</th>
<th style="text-align:center">&#x6628;&#x65E5;</th>
<th style="text-align:center">&#x30E9;&#x30FC;&#x30E1;&#x30F3;</th>
<th style="text-align:center">&#x3092;</th>
<th style="text-align:center">&#x98DF;&#x3079;</th>
<th style="text-align:center">&#x307E;&#x3057;&#x305F;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x22EF;</mo></mrow><annotation encoding="application/x-tex">\cdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.31em;vertical-align:0em;"></span><span class="minner">&#x22EF;</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">&#xD7;</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<p>&#x203B;&#x300C;&#x6628;&#x65E5;&#x300D;&#x3068;&#x3044;&#x3046;&#x5358;&#x8A9E;&#x3092;&#x30DE;&#x30B9;&#x30AF;&#x3057;&#x3001;&#x4ED6;&#x306E;&#x5358;&#x8A9E;&#x304B;&#x3089;&#x300C;&#x6628;&#x65E5;&#x300D;&#x306E;&#x90E8;&#x5206;&#x306B;&#x6700;&#x9069;&#x306A;&#x5358;&#x8A9E;&#x3092;&#x4E88;&#x6E2C;&#x3059;&#x308B;</p>
<h3 class="mume-header" id="hred">HRED</h3>

<pre class="language-text">Seq2seq&#x306E;&#x8AB2;&#x984C;
    &#x4E00;&#x554F;&#x4E00;&#x7B54;&#x3057;&#x304B;&#x3067;&#x304D;&#x306A;&#x3044;&#x3002;
    &#xFF08;&#xFF11;&#x3064;&#x306E;&#x6587;&#x7AE0;&#x306B;&#x5BFE;&#x3057;&#x3066;&#xFF11;&#x3064;&#x306E;&#x7B54;&#x3048;&#x3057;&#x304B;&#x306A;&#x3044;&#xFF09;
    &#x554F;&#x3044;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x6587;&#x8108;&#x3082;&#x4F55;&#x3082;&#x306A;&#x304F;&#x3001;&#x305F;&#x3060;&#x5FDC;&#x7B54;&#x304C;&#x884C;&#x308F;&#x308C;&#x308B;&#x3065;&#x3051;&#x308B;&#x3002;&#x70B9;&#x3060;&#x3051;&#x3092;&#x3068;&#x3089;&#x3048;&#x3066;&#x3044;&#x308B;&#x3002;
    &#x2193;
    &#x904E;&#x53BB;&#x306E;&#x6587;&#x8108;&#x304B;&#x3089;&#x6349;&#x3048;&#x3089;&#x308C;&#x306A;&#x3044;&#x304B;&#xFF08;&#x70B9;&#x3067;&#x306F;&#x306A;&#x304F;&#x7DDA;&#xFF09;

HRED&#x3068;&#x3044;&#x3046;&#x6982;&#x5FF5;
    &#x904E;&#x53BB;n-1&#x500B;&#x306E;&#x767A;&#x8A71;&#x304B;&#x3089;&#x6B21;&#x306E;&#x767A;&#x8A71;&#x3092;&#x751F;&#x6210;&#x3059;&#x308B;&#x3002;
    Seq2seq&#x3067;&#x306F;&#x3001;&#x4F1A;&#x8A71;&#x306E;&#x6587;&#x8108;&#x3092;&#x7121;&#x8996;&#x3057;&#x3066;&#x5FDC;&#x7B54;&#x3057;&#x3066;&#x3044;&#x305F;&#x304C;&#x3001;
    &#x524D;&#x306E;&#x5358;&#x8A9E;&#x306E;&#x6D41;&#x308C;&#x306B;&#x5373;&#x3057;&#x3066;&#x5FDC;&#x7B54;&#x3055;&#x308C;&#x308B;&#x305F;&#x3081;&#x3001;
    &#x3088;&#x308A;&#x4EBA;&#x9593;&#x3089;&#x3057;&#x3044;&#x6587;&#x7AE0;&#x304C;&#x751F;&#x6210;&#x3055;&#x308C;&#x308B;&#x3002;

    &#x30B7;&#x30B9;&#x30C6;&#x30E0;&#xFF1A;&#x5B50;&#x72AC;&#x304B;&#x308F;&#x3044;&#x3044;&#x306D;
    &#x30E6;&#x30FC;&#x30B6;&#xFF1A;&#x3046;&#x3093;
    &#x30B7;&#x30B9;&#x30C6;&#x30E0;&#xFF1A;&#x5B50;&#x72AC;&#x304B;&#x308F;&#x3044;&#x3044;&#x306E;&#x308F;&#x304B;&#x308B;

        HRED&#x3068;&#x306F;Seq2seq + Context RNN

ContextRNN
    Encoder&#x306E;&#x307E;&#x3068;&#x3081;&#x305F;&#x5404;&#x6587;&#x7AE0;&#x306E;&#x7CFB;&#x5217;&#x306B;&#x307E;&#x3068;&#x3081;&#x3066;&#x3001;
    &#x3053;&#x308C;&#x307E;&#x3067;&#x306E;&#x4F1A;&#x8A71;&#x30B3;&#x30F3;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x5168;&#x4F53;&#x3092;&#x8868;&#x3059;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306B;&#x5909;&#x63DB;&#x3059;&#x308B;&#x69CB;&#x9020;&#x3002;
    &#x3053;&#x308C;&#x306B;&#x3088;&#x308A;&#x904E;&#x53BB;&#x306E;&#x767A;&#x8A71;&#x306E;&#x5C65;&#x6B74;&#x3092;&#x52A0;&#x5473;&#x3057;&#x305F;&#x8FD4;&#x7B54;&#x304C;&#x3067;&#x304D;&#x308B;&#x3002;

HRED&#x306E;&#x8AB2;&#x984C;
    &#x78BA;&#x7387;&#x7684;&#x306A;&#x591A;&#x69D8;&#x6027;&#x304C;&#x5B57;&#x9762;&#x306B;&#x3057;&#x304B;&#x306A;&#x304F;&#x3001;&#x4F1A;&#x8A71;&#x306E;&#x6D41;&#x308C;&#x306E;&#x3088;&#x3046;&#x306A;&#x591A;&#x69D8;&#x6027;&#x304C;&#x306A;&#x3044;&#x3002;
    &#x3064;&#x307E;&#x308A;&#x540C;&#x3058;&#x30B3;&#x30F3;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#xFF08;&#x767A;&#x8A71;&#x30EA;&#x30B9;&#x30C8;&#xFF09;&#x304C;&#x4E0E;&#x3048;&#x3089;&#x308C;&#x3066;&#x3082;
    &#x7B54;&#x3048;&#x306E;&#x5185;&#x5BB9;&#x304C;&#x6BCE;&#x56DE;&#x4F1A;&#x8A71;&#x306E;&#x6D41;&#x308C;&#x3068;&#x3057;&#x3066;&#x540C;&#x3058;&#x3082;&#x306E;&#x3057;&#x304B;&#x51FA;&#x305B;&#x306A;&#x3044;&#x3002;
    &#x60C5;&#x5831;&#x91CF;&#x304C;&#x4E4F;&#x3057;&#x304F;&#x5358;&#x8ABF;&#x3067;&#x77ED;&#x3044;&#x5FDC;&#x7B54;&#x306B;&#x306A;&#x308A;&#x304C;&#x3061;&#x3002;
    ex)&#x300C;&#x3046;&#x3093;&#x300D;&#x300C;&#x305D;&#x3046;&#x3060;&#x306D;&#x300D;&#x300C;&#x306A;&#x308B;&#x307B;&#x3069;&#x300D;&#x300C;&#x30FB;&#x30FB;&#x30FB;&#x300D;
</pre>
<h3 class="mume-header" id="vhred">VHRED</h3>

<pre class="language-text">VHRED&#x3068;&#x306F;&#x3001;VAE&#x306E;&#x6F5C;&#x5728;&#x5909;&#x6570;&#x306E;&#x6982;&#x5FF5;&#x3092;&#x8FFD;&#x52A0;&#x3057;&#x305F;&#x3082;&#x306E;
&#xFF08;HRED&#x306E;&#x8AB2;&#x984C;&#x3092;VAE&#x306E;&#x88FD;&#x5264;&#x5909;&#x6570;&#x306E;&#x6982;&#x5FF5;&#x3092;&#x8FFD;&#x52A0;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x89E3;&#x6C7A;&#x3057;&#x305F;&#x69CB;&#x9020;&#xFF09;
VAE&#x306E;AE&#x3068;&#x306F;AutoEncoder&#xFF08;&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#xFF09;
</pre>
<h3 class="mume-header" id="%E3%82%AA%E3%83%BC%E3%83%88%E3%82%A8%E3%83%B3%E3%82%B3%E3%83%BC%E3%83%80auto-encoder">&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#xFF08;Auto Encoder&#xFF09;</h3>

<pre class="language-text">&#x6559;&#x5E2B;&#x306A;&#x3057;&#x5B66;&#x7FD2;&#x306E;&#x4E00;&#x3064;
&#x305D;&#x306E;&#x305F;&#x3081;&#x5B66;&#x7FD2;&#x6642;&#x306E;&#x5165;&#x529B;&#x30C7;&#x30FC;&#x30BF;&#x306F;&#x8A13;&#x7DF4;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x307F;&#x3067;&#x6559;&#x5E2B;&#x30C7;&#x30FC;&#x30BF;&#x306F;&#x4F7F;&#x308F;&#x306A;&#x3044;&#x3002;
&#x81EA;&#x5DF1;&#x7B26;&#x53F7;&#x5316;&#x5668;&#x3068;&#x3082;&#x3044;&#x3046;&#x3002;

&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;&#x5177;&#x4F53;&#x4F8B;
    MMNIST&#x306E;&#x5834;&#x5408;&#x3001;28&#xD7;28&#x306E;&#x6570;&#x5B57;&#x306E;&#x753B;&#x50CF;&#x3092;&#x5165;&#x308C;&#x3066;&#x3001;
    &#x540C;&#x3058;&#x753B;&#x50CF;&#x3092;&#x51FA;&#x529B;&#x3059;&#x308B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;

&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#x306E;&#x6982;&#x8981;
    &#x5165;&#x529B;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x306B;&#x5909;&#x63DB;&#x3059;&#x308B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;Encoder&#x3001;
    &#x9006;&#x306B;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x3092;&#x30A4;&#x30F3;&#x30D7;&#x30C3;&#x30C8;&#x3068;&#x3057;&#x3066;&#x5143;&#x753B;&#x50CF;&#x3092;&#x5FA9;&#x5143;&#x3059;&#x308B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;Decoder&#x3068;&#x3044;&#x3046;&#x3002;

&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#x306E;&#x30E1;&#x30EA;&#x30C3;&#x30C8;
    &#x6B21;&#x5143;&#x524A;&#x9664;&#x304C;&#x884C;&#x3048;&#x308B;&#x3053;&#x3068;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AutoEncoder.png" alt="png"></p>
<h3 class="mume-header" id="vae">VAE</h3>

<pre class="language-text">&#x901A;&#x5E38;&#x306E;&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#x306E;&#x5834;&#x5408;&#x3001;
&#x4F55;&#x304B;&#x3057;&#x3089;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x306B;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x62BC;&#x3057;&#x8FBC;&#x3081;&#x3066;&#x3044;&#x308B;&#x3082;&#x306E;&#x306E;&#x3001;
&#x305D;&#x306E;&#x69CB;&#x9020;&#x304C;&#x3069;&#x306E;&#x3088;&#x3046;&#x306A;&#x72B6;&#x614B;&#x304B;&#x306F;&#x4E0D;&#x660E;&#x3002;
VAE&#x3067;&#x306F;&#x3053;&#x306E;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x306B;&#x78BA;&#x7387;&#x5206;&#x5E03;z~N(0,1&#xFF09;&#x3092;&#x4EEE;&#x5B9A;&#x3057;&#x305F;&#x3082;&#x306E;
&#xFF08;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x3092;&#x6C42;&#x3081;&#x308B;&#x969B;&#x306B;&#x6B63;&#x5247;&#x5316;&#x3059;&#x308B;&#x3002;&#xFF09;
VAE&#x306F;&#x3001;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x306E;&#x78BA;&#x7387;&#x5206;&#x5E03;&#x3068;&#x3044;&#x3046;&#x69CB;&#x9020;&#x306B;&#x62BC;&#x3057;&#x8FBC;&#x3081;&#x308B;&#x3053;&#x3068;&#x3092;&#x53EF;&#x80FD;&#x306B;&#x3059;&#x308B;&#x3002;

&#x901A;&#x5E38;&#x3001;&#x30C7;&#x30B3;&#x30FC;&#x30C0;&#x30FC;&#x3067;&#x5FA9;&#x5143;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306A;&#x60C5;&#x5831;&#x3092;&#x6F5C;&#x5728;&#x5909;&#x6570;&#x3068;&#x3057;&#x3066;&#x751F;&#x6210;&#x3059;&#x308B;&#x3002;
&#x4F8B;&#x3048;&#x3070;One-Hot-Vector&#x3067;&#x306F;MNIST&#x306B;&#x304A;&#x3051;&#x308B;&#x6570;&#x5B57;&#x540C;&#x58EB;&#x306E;&#x985E;&#x4F3C;&#x5EA6;&#x304C;&#x5206;&#x304B;&#x3089;&#x306A;&#x3044;&#x3002;
&#x5143;&#x306E;&#x6570;&#x5B57;&#x306E;&#x985E;&#x4F3C;&#x5EA6;&#x306B;&#x8FD1;&#x3057;&#x3044;&#x5024;&#x3067;&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x304C;&#x6C7A;&#x5B9A;&#x3055;&#x308C;&#x3066;&#x307B;&#x3057;&#x3044;&#x3002;

&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#x90E8;&#x5206;&#x3067;&#x30CE;&#x30A4;&#x30BA;&#x3092;&#x52A0;&#x3048;&#x308B;&#xFF08;&#x30C9;&#x30ED;&#x30C3;&#x30D7;&#x30A2;&#x30A6;&#x30C8;&#x306A;&#x3069;&#xFF09;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;
&#x6BCE;&#x56DE;&#x82E5;&#x5E72;&#x7570;&#x306A;&#x308B;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306B;&#x3057;&#x3001;&#x3088;&#x308A;&#x6C4E;&#x5316;&#x3057;&#x305F;&#x5206;&#x6563;&#x306B;&#x8FD1;&#x3044;&#x60C5;&#x5831;&#x3092;
&#x6F5C;&#x5728;&#x5909;&#x6570;z&#x3068;&#x3057;&#x3066;&#x843D;&#x3068;&#x3057;&#x8FBC;&#x3080;&#x3002;
</pre>
<h3 class="mume-header" id="6-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">6-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">seq2seq&#x306F;&#x8AAD;&#x3093;&#x3067;&#x5B57;&#x306E;&#x3054;&#x3068;&#x304F;&#x3042;&#x308B;RNN&#x304B;&#x3089;&#x751F;&#x6210;&#x3055;&#x308C;&#x305F;&#x7D50;&#x679C;&#x3092;
&#x5225;&#x306E;RNN&#x306E;&#x5165;&#x529B;&#x3068;&#x3057;&#x3066;&#x7528;&#x3044;&#x308B;&#x3001;&#x8907;&#x6570;&#x306E;&#x69CB;&#x6210;&#x304B;&#x3089;&#x306A;&#x308B;RNN&#x3067;&#x3042;&#x308B;&#x3002;
&#x524D;&#x8005;&#x306F;Encoder,&#x5F8C;&#x8005;&#x306F;Decoder&#x3068;&#x3057;&#x3066;&#x632F;&#x821E;&#x3046;&#x3002;
&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#x3068;&#x3057;&#x3066;&#x306F;&#x3001;&#x65E5;&#x82F1;&#x6A5F;&#x68B0;&#x7FFB;&#x8A33;&#x306E;&#x3088;&#x3046;&#x306B;&#x524D;&#x8005;&#x306E;Encoder&#x306B;&#x3066;
&#x65E5;&#x672C;&#x8A9E;&#x306E;&#x6587;&#x7AE0;&#x304B;&#x3089;&#x62BD;&#x51FA;&#x3057;&#x305F;&#x7279;&#x5FB4;&#x91CF;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3092;&#x751F;&#x307F;&#x51FA;&#x3057;&#x3001;
&#x5F8C;&#x8005;&#x306E;Decoder&#x306B;&#x3066;&#x305D;&#x306E;&#x7279;&#x5FB4;&#x91CF;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3092;&#x5165;&#x529B;&#x3057;&#x3066;&#x82F1;&#x8A9E;&#x306E;&#x6587;&#x7AE0;&#x306B;
&#x5909;&#x63DB;&#x3092;&#x304B;&#x3051;&#x3066;&#x3044;&#x304F;&#x3082;&#x306E;&#x3068;&#x306A;&#x308B;&#x3002;
&#x305F;&#x3060;&#x3057;&#x5358;&#x8A9E;&#x30D9;&#x30FC;&#x30B9;&#x3067;1&#x554F;1&#x7B54;&#x306E;&#x51FA;&#x529B;&#x3057;&#x304B;&#x5F97;&#x3089;&#x308C;&#x305A;&#x9AD8;&#x5EA6;&#x306A;&#x5FDC;&#x7528;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;&#x3002;
&#x305D;&#x3053;&#x3067;HRED&#x3084;VHRED&#x306E;&#x3088;&#x3046;&#x306B;&#x4F1A;&#x8A71;&#x306E;&#x6D41;&#x308C;&#x304B;&#x3089;&#x3088;&#x308A;&#x81EA;&#x7136;&#x306B;&#x8FD1;&#x3044;&#x9069;&#x5207;&#x306A;
&#x51FA;&#x529B;&#x3092;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3088;&#x3046;&#x306A;&#x30A2;&#x30D7;&#x30ED;&#x30FC;&#x30C1;&#x304C;&#x8003;&#x6848;&#x3055;&#x308C;&#x305F;&#x3002;
&#x7279;&#x306B;VHRED&#x3067;&#x5229;&#x7528;&#x3055;&#x308C;&#x308B;&#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;&#x306E;&#x6982;&#x5FF5;&#x306F;&#x975E;&#x5E38;&#x306B;&#x6C4E;&#x7528;&#x6027;&#x304C;&#x9AD8;&#x3044;&#x3002;
</pre>
<h3 class="mume-header" id="6-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">6-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x6F14;&#x7FD2;&#x554F;&#x984C;:one-hot&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306E;&#x5909;&#x63DB;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_seq2seq_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%882.png" alt="png"></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mi>s</mi><mo>:</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mn>1</mn><mi>v</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22F1;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mi>n</mi><mi>v</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>w</mi><mo>:</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>X</mi><mn>11</mn></msub><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>X</mi><mrow><mn>1</mn><mi>v</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">words:\begin{bmatrix}X_{11} &amp; \cdots &amp; X_{1v} \\ \vdots &amp; \ddots &amp; \vdots \\ X_{n1} &amp; \cdots &amp; X_{nv} \end{bmatrix},w:\begin{bmatrix}X_{11}, \\ \vdots \\ X_{1v}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal">d</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V616 H319z M319 0 H403 V616 H319z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span><span style="top:-3.1799999999999997em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22F1;</span></span></span><span style="top:-1.9799999999999995em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V616 H263z M263 0 H347 V616 H263z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V616 H319z M319 0 H403 V616 H319z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V616 H263z M263 0 H347 V616 H263z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>:</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mrow><mn>1</mn><mi>v</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22F1;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mrow><mi>e</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>E</mi><mrow><mi>e</mi><mi>v</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>e</mi><mo>=</mo><mi>E</mi><mo>&#x22C5;</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">E:\begin{bmatrix}E_{11} &amp; \cdots &amp; E_{1v} \\ \vdots &amp; \ddots &amp; \vdots \\ E_{e1} &amp; \cdots &amp; E_{ev} \end{bmatrix},e=E\cdot w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.260000000000001em;vertical-align:-1.8800000000000006em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V616 H319z M319 0 H403 V616 H319z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span><span style="top:-3.1799999999999997em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22F1;</span></span></span><span style="top:-1.9799999999999995em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.3800000000000003em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-2.1674999999999995em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.8800000000000006em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.350025em;"><span style="top:-1.9499950000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.096995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.6160100000000002em;width:0.667em;"><svg width="0.667em" height="0.6160100000000002em" style="width:0.667em" viewBox="0 0 667 616" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V616 H263z M263 0 H347 V616 H263z"/></svg></span></span><span style="top:-4.3500250000000005em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.850025em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></p>
<h3 class="mume-header" id="6-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">6-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#xFF1A;seq2seq&#x306B;&#x3064;&#x3044;&#x3066;&#x306E;&#x8AAC;&#x660E;
    &#x3010;&#x56DE;&#x7B54;&#x3011;&#xFF1A;2
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_seq2seq_%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%881.png" alt="png"></p>
<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    seq2seq&#x3068;HRED&#x3068;VHRED&#x306E;&#x9055;&#x3044;&#x3092;&#x7C21;&#x6F54;&#x306B;&#x8FF0;&#x3079;&#x3088;&#x3002;
        &#x3010;&#x56DE;&#x7B54;&#x3011;
        seq2seq&#x306F;&#xFF11;&#x6587;&#x306E;&#xFF11;&#x554F;&#xFF11;&#x7B54;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x51E6;&#x7406;&#x304C;&#x3067;&#x304D;&#x308B;&#x3001;
        &#x3042;&#x308B;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x5225;&#x306E;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x751F;&#x307F;&#x51FA;&#x3059;&#x6A5F;&#x69CB;&#x3002;

        HRED&#x306F;seq2seq&#x306E;&#x6A5F;&#x69CB;&#x306B;&#x305D;&#x308C;&#x307E;&#x3067;&#x306E;&#x6587;&#x8108;&#x306E;&#x610F;&#x5473;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3092;&#x89E3;&#x91C8;&#x306B;&#x52A0;&#x3048;&#x3089;&#x308C;&#x308B;&#x3088;&#x3046;&#x306B;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3001;
        &#x6587;&#x8108;&#x306E;&#x610F;&#x5473;&#x3092;&#x6C72;&#x307F;&#x53D6;&#x3063;&#x305F;&#x5206;&#x306E;&#x5909;&#x63DB;&#x30FB;&#x5909;&#x66F4;&#x304C;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x3057;&#x305F;&#x3082;&#x306E;&#x3002;

        VHRED&#x306F;HRED&#x304C;&#x5F53;&#x305F;&#x308A;&#x969C;&#x308A;&#x306E;&#x306A;&#x3044;&#x56DE;&#x7B54;&#x3057;&#x304B;&#x751F;&#x307F;&#x51FA;&#x305B;&#x306A;&#x304F;&#x3053;&#x3068;&#x306B;&#x5BFE;&#x3059;&#x308B;&#x89E3;&#x6C7A;&#x7B56;&#x3002;
        &#x30AA;&#x30FC;&#x30C8;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C0;(VAE)&#x306E;&#x8003;&#x3048;&#x65B9;&#x3092;&#x53D6;&#x308A;&#x5165;&#x308C;&#x3066;&#x3001;&#x3088;&#x308A;&#x81EA;&#x7136;&#x304B;&#x3064;&#x9069;&#x5207;&#x306A;
        &#x51FA;&#x529B;&#x3092;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3088;&#x3046;&#x306B;&#x6539;&#x826F;&#x3057;&#x305F;&#x3082;&#x306E;&#x3002;

&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    VAE&#x306B;&#x95A2;&#x3059;&#x308B;&#x4E0B;&#x8A18;&#x306E;&#x8AAC;&#x660E;&#x6587;&#x306E;&#x7A7A;&#x6B04;&#x306B;&#x5F53;&#x3066;&#x306F;&#x307E;&#x308B;&#x6587;&#x8A00;&#x3092;&#x7B54;&#x3048;&#x3088;&#x3002;
    &#x300C;&#x81EA;&#x5DF1;&#x7B26;&#x53F7;&#x5316;&#x5668;&#x306E;&#x6F5C;&#x5728;&#x5909;&#x6570;&#x306B;&#xFF3F;&#xFF3F;&#xFF3F;&#xFF3F;&#x3092;&#x5C0E;&#x5165;&#x3057;&#x305F;&#x3082;&#x306E;&#x300D;
    &#x3010;&#x56DE;&#x7B54;&#x3011;&#xFF1A;&#x78BA;&#x7387;&#x5206;&#x5E03;
</pre>
<h2 class="mume-header" id="7section6word2vec">7.Section6:word2vec</h2>

<pre class="language-text">&#x8AB2;&#x984C;
    RNN&#x3067;&#x306F;&#x3001;&#x5358;&#x8A9E;&#x306E;&#x3088;&#x3046;&#x306A;&#x53EF;&#x5909;&#x9577;&#x306E;&#x6587;&#x5B57;&#x5217;&#x3092;NN&#x306B;&#x4E0E;&#x3048;&#x308B;&#x3053;&#x3068;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;&#x3002;
    &#x3057;&#x305F;&#x304C;&#x3063;&#x3066;&#x56FA;&#x5B9A;&#x9577;&#x5F62;&#x5F0F;&#x3067;&#x5358;&#x8A9E;&#x3092;&#x8868;&#x3059;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x3063;&#x305F;&#x3002;

&#x5B66;&#x7FD2;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#x3092;&#x4F5C;&#x6210;
    &#x4F8B;&#x3048;&#x3070;7&#x8A9E;&#x306E;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#x3092;&#x4F5C;&#x6210;&#x3057;&#x305F;&#x5834;&#x5408;&#x3001;
    &#x672C;&#x6765;&#x306F;&#x8F9E;&#x66F8;&#x306E;&#x5358;&#x8A9E;&#x6570;&#x3060;&#x3051;&#x3067;&#x304D;&#x3042;&#x304C;&#x308B;&#x3002;

    Ex)I want to eat apples. I like apples.
    &#x2193;
    {apple,eat,I,like,to,want}
    &#x2193;
    Apples&#x3092;&#x5165;&#x529B;&#x3059;&#x308B;&#x5834;&#x5408;&#x306F;&#x3001;&#x5165;&#x529B;&#x5C64;&#x306B;&#x306F;&#x4EE5;&#x4E0B;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x304C;&#x542B;&#x307E;&#x308C;&#x308B;
    &#x203B;&#x672C;&#x6765;&#x306F;&#x8F9E;&#x66F8;&#x306E;&#x5358;&#x8A9E;&#x6570;&#x3060;&#x3051;one-hot&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x304C;&#x3067;&#x304D;&#x3042;&#x304C;&#x308B;
</pre>
<table>
<thead>
<tr>
<th style="text-align:left">&#x8F9E;&#x66F8;&#x8868;&#x73FE;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&#x22EF;</mo><mi>a</mi><mi>p</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">1\cdots apples</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ppl</span><span class="mord mathnormal">es</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&#x22EF;</mo><mi>e</mi><mi>a</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">0\cdots eat</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&#x22EF;</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">0\cdots I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&#x22EF;</mo><mi>l</mi><mi>i</mi><mi>k</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">0\cdots like</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03148em;">ik</span><span class="mord mathnormal">e</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&#x22EF;</mo><mi>t</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">0\cdots to</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mrow><annotation encoding="application/x-tex">\vdots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.03em;"></span><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span></td>
</tr>
</tbody>
</table>
<p>&#x2192;&#x6271;&#x3046;&#x5358;&#x8A9E;&#x306E;&#x6570;&#x3060;&#x3051;One-Hot&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306E;&#x8981;&#x7D20;&#x6570;&#x304C;&#x5897;&#x3048;&#x3066;&#x3057;&#x307E;&#x3046;&#xFF01;&#xFF01;</p>
<pre class="language-text">word2vec&#x306E;&#x30E1;&#x30EA;&#x30C3;&#x30C8;
    &#x5927;&#x898F;&#x6A21;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x5206;&#x6563;&#x8868;&#x73FE;&#x306E;&#x5B66;&#x7FD2;&#x304C;
    &#x73FE;&#x5B9F;&#x7684;&#x306A;&#x8A08;&#x7B97;&#x901F;&#x5EA6;&#x3068;&#x30E1;&#x30E2;&#x30EA;&#x91CF;&#x3067;&#x5B9F;&#x73FE;&#x53EF;&#x80FD;&#x3068;&#x3057;&#x305F;&#x3002;
    &#xD7;&#xFF1A;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#xD7;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#x3060;&#x3051;&#x306E;&#x91CD;&#x307F;&#x884C;&#x5217;&#x304C;&#x8A95;&#x751F;
    &#x3007;&#xFF1A;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#xD7;&#x4EFB;&#x610F;&#x306E;&#x5358;&#x8A9E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x6B21;&#x5143;&#x306E;&#x91CD;&#x307F;&#x884C;&#x5217;&#x304C;&#x8A95;&#x751F;

    One-Hot&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3067;&#x306F;&#x306A;&#x304F;Embedding&#x8868;&#x73FE;&#x306B;&#x5909;&#x63DB;&#x3057;&#x3066;&#x60C5;&#x5831;&#x91CF;&#x3092;&#x6E1B;&#x3089;&#x3059;&#x3002;
    &#x5909;&#x63DB;&#x8868;&#x3092;&#x4E0A;&#x624B;&#x306B;&#x6A5F;&#x68B0;&#x5B66;&#x7FD2;&#x306B;&#x3088;&#x3063;&#x3066;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x3001;
    &#x5358;&#x8A9E;&#x540C;&#x58EB;&#x306E;&#x610F;&#x5473;&#x306E;&#x3064;&#x306A;&#x304C;&#x308A;&#x3092;&#x4FDD;&#x3061;&#x306A;&#x304C;&#x3089;&#x3001;&#x3088;&#x308A;&#x5C11;&#x306A;&#x3044;&#x60C5;&#x5831;&#x3067;&#x8868;&#x3059;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;&#x3002;
</pre>
<table>
<thead>
<tr>
<th style="text-align:center">&#x6F5C;&#x5728;&#x5909;&#x6570;z</th>
<th style="text-align:center">&#x6570;&#x5F0F;&#x8868;&#x73FE;</th>
<th style="text-align:center">&#x7279;&#x5FB4;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#xD7;&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;<br>&#x3060;&#x3051;&#x306E;&#x91CD;&#x307F;&#x884C;&#x5217;</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mtext>&#x2009;</mtext><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1,0,0,0,0,0,\cdots,I]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">]</span></span></span></span></td>
<td style="text-align:center">&#x307B;&#x307C;&#x30BC;&#x30ED;&#x306E;&#x5024;&#x3067;&#x69CB;&#x6210;&#x3055;&#x308C;&#x7121;&#x99C4;&#x304C;&#x591A;&#x3044;</td>
</tr>
<tr>
<td style="text-align:center">&#x30DC;&#x30AD;&#x30E3;&#x30D6;&#x30E9;&#x30EA;&#xD7;&#x4EFB;&#x610F;&#x306E;&#x5358;&#x8A9E;<br>&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x6B21;&#x5143;&#x306E;&#x91CD;&#x307F;&#x884C;&#x5217;</td>
<td style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>w</mi><mn>11</mn><mrow><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>w</mi><mrow><mn>1</mn><mi>I</mi></mrow><mrow><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22F1;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">&#x22EE;</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>w</mi><mrow><mi>J</mi><mn>1</mn></mrow><mrow><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">&#x22EF;</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>w</mi><mrow><mi>J</mi><mi>I</mi></mrow><mrow><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>13</mn><mo separator="true">,</mo><mn>15</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}w_{11}^{(I)} &amp; \cdots &amp; w_{1I}^{(I)} \\ \vdots &amp; \ddots &amp; \vdots \\ w_{J1}^{(I)} &amp; \cdots &amp; w_{JI}^{(I)}  \end{bmatrix}=[1,13,15]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.80006em;vertical-align:-2.15003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65003em;"><span style="top:-1.7110100000000004em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-2.85801em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span style="height:1.2160200000000003em;width:0.667em;"><svg width="0.667em" height="1.2160200000000003em" style="width:0.667em" viewBox="0 0 667 1216" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V1216 H319z M319 0 H403 V1216 H319z"/></svg></span></span><span style="top:-4.71105em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5848em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.433692em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.26630799999999993em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.9626999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4064690000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.0848000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5848em;"><span style="top:-5.04em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span><span style="top:-3.1799999999999997em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22F1;</span></span></span><span style="top:-1.7751999999999997em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner">&#x22EF;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.0848000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5848em;"><span style="top:-5.2275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4064690000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.3674999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord">&#x22EE;</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.9626999999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4064690000000004em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.09618em;">J</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.29353099999999993em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.0848000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.65003em;"><span style="top:-1.7110100000000004em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-2.85801em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span style="height:1.2160200000000003em;width:0.667em;"><svg width="0.667em" height="1.2160200000000003em" style="width:0.667em" viewBox="0 0 667 1216" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V1216 H263z M263 0 H347 V1216 H263z"/></svg></span></span><span style="top:-4.71105em;"><span class="pstrut" style="height:3.2160200000000003em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.15003em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">13</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">15</span><span class="mclose">]</span></span></span></span></td>
<td style="text-align:center">&#x5358;&#x8A9E;&#x672C;&#x6765;&#x306E;&#x610F;&#x5473;&#x3092;&#x640D;&#x306A;&#x3046;&#x3053;&#x3068;&#x306A;&#x304F;<br>&#x6700;&#x4F4E;&#x9650;&#x306E;&#x60C5;&#x5831;&#x91CF;&#x3067;&#x8868;&#x73FE;&#x3067;&#x304D;&#x308B;&#x3002;</td>
</tr>
</tbody>
</table>
<h3 class="mume-header" id="7-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">7-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">word2vec&#x3067;&#x306F;&#x3001;&#x5358;&#x8A9E;&#x306E;&#x610F;&#x5473;&#x3092;&#x8868;&#x3059;&#x8868;&#x73FE;&#x3068;&#x3057;&#x3066;One-Hot&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306E;&#x3088;&#x3046;&#x306A;
&#x975E;&#x5E38;&#x306B;&#x7121;&#x99C4;&#x306E;&#x591A;&#x3044;&#x60C5;&#x5831;&#x3092;&#x542B;&#x3080;&#x3082;&#x306E;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;&#x3088;&#x308A;&#x6271;&#x3044;&#x3084;&#x3059;&#x3044;&#x5206;&#x6563;&#x8868;&#x73FE;&#x3092;
&#x53D6;&#x5F97;&#x3057;&#x3001;&#x60C5;&#x5831;&#x91CF;&#x3092;&#x6291;&#x5236;&#x3059;&#x308B;&#x3053;&#x3068;&#x3092;&#x5B9F;&#x73FE;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;
&#x610F;&#x5473;&#x5408;&#x3044;&#x306E;&#x8FD1;&#x3044;&#x5358;&#x8A9E;&#x540C;&#x58EB;&#x306F;&#x5206;&#x6563;&#x8868;&#x73FE;&#x306E;&#x5024;&#x3082;&#x8FD1;&#x3057;&#x304F;&#x306A;&#x308B;&#x3002;
&#x307E;&#x305F;&#x3001;&#x3053;&#x308C;&#x3092;Embedded&#x8868;&#x73FE;&#x3068;&#x3082;&#x8A00;&#x3044;&#x3001;&#x4E3B;&#x306B;&#x81EA;&#x7136;&#x8A00;&#x8A9E;&#x51E6;&#x7406;&#x3067;&#x5229;&#x7528;&#x3059;&#x308B;
RNN&#x306B;&#x304A;&#x3044;&#x3066;&#x5B9A;&#x756A;&#x306E;&#x624B;&#x6CD5;&#x3068;&#x3057;&#x3066;&#x6D3B;&#x7528;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
&#xFF08;&#x5F8C;&#x8FF0;&#x306E;Transformer&#x3067;&#x3082;&#x95A2;&#x9023;&#x3059;&#x308B;&#x8A18;&#x8FF0;&#x304C;&#x898B;&#x53D7;&#x3051;&#x3089;&#x308C;&#x308B;&#xFF09;
&#x306A;&#x304A;&#x3001;word2vec&#x306B;&#x304A;&#x3051;&#x308B;&#x5206;&#x6563;&#x8868;&#x73FE;&#x306E;&#x53D6;&#x5F97;&#x306F;&#x63A8;&#x8AD6;&#x30D9;&#x30FC;&#x30B9;&#x3067;&#x884C;&#x308F;&#x308C;&#x308B;&#x3002;
</pre>
<h3 class="mume-header" id="7-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">7-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x306A;&#x3057;
</pre>
<h3 class="mume-header" id="7-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">7-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x306A;&#x3057;
</pre>
<h2 class="mume-header" id="8section7attention-mechanism">8.Section7:Attention Mechanism</h2>

<pre class="language-text">seq2seq&#x306E;&#x8AB2;&#x984C;
    &#x9577;&#x3044;&#x6587;&#x7AE0;&#x3092;&#x53D6;&#x308A;&#x6271;&#x3046;&#x306E;&#x304C;&#x56F0;&#x96E3;
    2&#x5358;&#x8A9E;&#x3067;&#x3082;1000&#x5358;&#x8A9E;&#x3067;&#x3082;&#x3001;&#x56FA;&#x5B9A;&#x6B21;&#x5143;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306E;&#x4E2D;&#x3067;
    &#x8868;&#x73FE;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308A;&#x3001;&#x9577;&#x3044;&#x6587;&#x7AE0;&#x306B;&#x306A;&#x308C;&#x3070;&#x306A;&#x308B;&#x307B;&#x3069;
    &#x56FA;&#x5B9A;&#x6B21;&#x5143;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3067;&#x8868;&#x73FE;&#x3057;&#x304D;&#x308C;&#x306A;&#x3044;&#x6050;&#x308C;&#x304C;&#x3042;&#x308B;&#x3002;

&#x89E3;&#x6C7A;&#x7B56;
    &#x6587;&#x7AE0;&#x306E;&#x9577;&#x3055;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30B7;&#x30FC;&#x30B1;&#x30F3;&#x30B9;&#x306E;&#x5185;&#x90E8;&#x8868;&#x73FE;&#x306E;&#x6B21;&#x5143;&#x3082;&#x5927;&#x304D;&#x304F;&#x3059;&#x308B;&#x3001;
    &#x305D;&#x306E;&#x3088;&#x3046;&#x306A;&#x4ED5;&#x7D44;&#x307F;&#x304C;&#x5FC5;&#x8981;&#x3068;&#x306A;&#x308B;&#x3002;
    &#x3053;&#x306E;&#x4ED5;&#x7D44;&#x307F;&#x3092;Attntion Mechanism&#x3068;&#x3044;&#x3046;&#x3002;
    &#x5165;&#x529B;&#x3068;&#x51FA;&#x529B;&#x306E;&#x3069;&#x306E;&#x5358;&#x8A9E;&#x304C;&#x95A2;&#x9023;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;&#x3001;&#x306E;
    &#x95A2;&#x9023;&#x5EA6;&#x3092;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x4ED5;&#x7D44;&#x307F;&#x3068;&#x3044;&#x3048;&#x308B;&#x3002;
    &#x8FD1;&#x5E74;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x3067;&#x6027;&#x80FD;&#x306E;&#x9AD8;&#x3044;&#x3082;&#x306E;&#x306F;&#x3059;&#x3079;&#x3066;
    AttentionMechanism&#x3067;&#x3042;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AttentionMechanism.png" alt="png"></p>
<h3 class="mume-header" id="8-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">8-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">AttentionMechanism&#x306B;&#x3064;&#x3044;&#x3066;&#x306E;&#x8A73;&#x3057;&#x3044;&#x89E3;&#x8AAC;&#x306F;&#x3001;
&#x5F8C;&#x8FF0;&#x306E;Transformer&#x306E;&#x7BC0;&#x306B;&#x3066;&#x89E6;&#x308C;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x305D;&#x3061;&#x3089;&#x306B;&#x8B72;&#x308B;&#x304C;&#x3001;
&#x56FA;&#x5B9A;&#x6B21;&#x5143;&#x306E;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x3067;&#x5404;&#x5358;&#x8A9E;&#x306E;&#x72B6;&#x614B;&#x3092;&#x8868;&#x73FE;&#x3057;&#x3066;&#x3044;&#x3066;&#x306F;&#x3001;
&#x6587;&#x7AE0;&#x306E;&#x9577;&#x3055;&#x306B;&#x3088;&#x3063;&#x3066;&#x7CBE;&#x5EA6;&#x3092;&#x4E00;&#x5B9A;&#x306B;&#x4FDD;&#x3066;&#x306A;&#x3044;&#x3068;&#x3044;&#x3046;&#x8AB2;&#x984C;&#x304C;&#x3042;&#x308B;&#x3002;
&#x3053;&#x308C;&#x3092;&#x89E3;&#x6C7A;&#x3059;&#x308B;&#x305F;&#x3081;&#x306E;&#x624B;&#x6CD5;&#x3068;&#x3057;&#x3066;&#x3001;AttentionMechanism&#x306E;
&#x6982;&#x5FF5;&#x304C;&#x751F;&#x307F;&#x51FA;&#x3055;&#x308C;&#x305F;&#x3002;
&#x5143;&#x306E;&#x6587;&#x7AE0;&#x306E;&#x9577;&#x3055;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x6B21;&#x5143;&#x3092;&#x81EA;&#x7531;&#x306B;&#x5236;&#x5FA1;&#x3057;&#x3001;&#x306A;&#x304A;&#x304B;&#x3064;&#x5165;&#x51FA;&#x529B;
&#x9593;&#x3067;&#x5358;&#x8A9E;&#x306E;&#x95A2;&#x9023;&#x6027;&#x3092;&#x8F9E;&#x66F8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;&#x6A5F;&#x69CB;&#x306B;&#x3088;&#x308A;&#x8868;&#x73FE;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;
&#x3088;&#x308A;&#x81EA;&#x7136;&#x304B;&#x3064;&#x8AAC;&#x660E;&#x3057;&#x3084;&#x3059;&#x3044;&#x7D50;&#x679C;&#x3092;&#x5F97;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x306A;&#x308B;&#x3002;
</pre>
<h3 class="mume-header" id="8-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">8-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x306A;&#x3057;
</pre>
<h3 class="mume-header" id="8-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">8-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<pre class="language-text">&#x25A0;&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;
    RNN&#x3068;word2vec&#x3001;seq2seq&#x3068;AttentionMechanism&#x306E;&#x9055;&#x3044;&#x3092;&#x7C21;&#x6F54;&#x306B;&#x8FF0;&#x3079;&#x3088;&#x3002;

    &#x3010;&#x56DE;&#x7B54;&#x3011;
        RNN&#x3068;&#x306F;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x53D6;&#x308A;&#x6271;&#x3046;&#x306E;&#x306B;&#x9069;&#x3057;&#x305F;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x3042;&#x308B;&#x3002;

        word2vec&#x306F;&#x5358;&#x8A9E;&#x306E;&#x5206;&#x6563;&#x8868;&#x73FE;&#x3092;&#x5F97;&#x308B;&#x624B;&#x6CD5;&#x3067;&#x3042;&#x308B;&#x3002;

        seq2seq&#x306F;1&#x3064;&#x306E;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x5225;&#x306E;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x5F97;&#x308B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x3042;&#x308B;&#x3002;

        &#x6642;&#x7CFB;&#x5217;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x4E2D;&#x8EAB;&#x306E;&#x5165;&#x51FA;&#x529B;&#x9593;&#x306E;&#x95A2;&#x9023;&#x306B;&#x91CD;&#x307F;&#x3092;&#x4ED8;&#x3051;&#x308B;&#x624B;&#x6CD5;&#x3067;&#x3042;&#x308B;&#x3002;
</pre>
<h2 class="mume-header" id="9section1%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92">9.Section1:&#x5F37;&#x5316;&#x5B66;&#x7FD2;</h2>

<pre class="language-text">&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x3068;&#x306F;&#x3001;&#x9577;&#x671F;&#x7684;&#x306B;&#x5831;&#x916C;&#x3092;&#x6700;&#x5927;&#x5316;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;
&#x74B0;&#x5883;&#x306E;&#x4E2D;&#x3067;&#x884C;&#x52D5;&#x3092;&#x9078;&#x629E;&#x3067;&#x304D;&#x308B;&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x3092;&#x4F5C;&#x308B;&#x3053;&#x3068;&#x3092;
&#x76EE;&#x6A19;&#x3068;&#x3059;&#x308B;&#x5371;&#x5BB3;&#x5B66;&#x7FD2;&#x306E;&#x4E00;&#x5206;&#x91CE;&#x3067;&#x3042;&#x308B;&#x3002;

&#x884C;&#x52D5;&#x306E;&#x7D50;&#x679C;&#x3068;&#x3057;&#x3066;&#x4E0E;&#x3048;&#x3089;&#x308C;&#x308B;&#x5229;&#x76CA;(&#x5831;&#x916C;)&#x3092;&#x3082;&#x3068;&#x306B;
&#x884C;&#x52D5;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x539F;&#x7406;&#x3092;&#x6539;&#x5584;&#x3057;&#x3066;&#x3044;&#x304F;&#x4ED5;&#x7D44;&#x307F;&#x3067;&#x3059;&#x3002;

&#x30FB;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;/&#x6559;&#x5E2B;&#x306A;&#x3057;&#x5B66;&#x7FD2;
    &#x4EBA;&#x9593;&#x304C;&#x6210;&#x9577;&#x3068;&#x3068;&#x3082;&#x306B;&#x81EA;&#x7136;&#x3068;&#x5F97;&#x3066;&#x3044;&#x304F;&#x77E5;&#x80FD;&#x3001;&#x80FD;&#x529B;

&#x30FB;&#x5F37;&#x5316;&#x5B66;&#x7FD2;
    (&#x4ED5;&#x4E8B;&#x3092;)&#x81EA;&#x529B;&#x3067;&#x8A66;&#x884C;&#x932F;&#x8AA4;&#x3057;&#x306A;&#x304C;&#x3089;&#x899A;&#x3048;&#x3066;&#x3044;&#x304F;&#x30B9;&#x30AD;&#x30EB;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8.png" alt="png"></p>
<pre class="language-text">&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x304C;&#x3088;&#x308A;&#x591A;&#x304F;&#x306E;&#x5831;&#x916C;&#x3092;&#x5F97;&#x308B;&#x305F;&#x3081;&#x306B;&#x65B9;&#x7B56;&#x3092;&#x751F;&#x307F;&#x51FA;&#x3059;&#x3002;
&#x305D;&#x306E;&#x7D50;&#x679C;&#x74B0;&#x5883;&#x306E;&#x72B6;&#x614B;&#x304C;&#x5909;&#x5316;&#x3057;&#x305D;&#x308C;&#x3092;&#x89B3;&#x6E2C;&#x3059;&#x308B;&#x3002;
&#x74B0;&#x5883;&#x306E;&#x72B6;&#x614B;&#x5909;&#x5316;&#x306B;&#x3088;&#x308A;&#x76F8;&#x5FDC;&#x306E;&#x5831;&#x916C;&#x3092;&#x74B0;&#x5883;&#x304B;&#x3089;&#x5F97;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;&#x3002;

&#x30FB;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306E;&#x5FDC;&#x7528;&#x4F8B;
    &#x30DE;&#x30FC;&#x30B1;&#x30C6;&#x30A3;&#x30F3;&#x30B0;&#x306E;&#x5834;&#x5408;
    &#x74B0;&#x5883;&#xFF1A;&#x4F1A;&#x793E;&#x306E;&#x8CA9;&#x58F2;&#x4FC3;&#x9032;&#x90E8;

    &#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#xFF1A;&#x30D7;&#x30ED;&#x30D5;&#x30A3;&#x30FC;&#x30EB;&#x3068;&#x8CFC;&#x5165;&#x5C65;&#x6B74;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;&#x3001;
    &#x30AD;&#x30E3;&#x30F3;&#x30DA;&#x30FC;&#x30F3;&#x30E1;&#x30FC;&#x30EB;&#x3092;&#x9001;&#x308B;&#x9867;&#x5BA2;&#x3092;&#x6C7A;&#x3081;&#x308B;&#x30BD;&#x30D5;&#x30C8;&#x30A6;&#x30A7;&#x30A2;&#x3002;

    &#x884C;&#x52D5;&#xFF1A;&#x9867;&#x5BA2;&#x3054;&#x3068;&#x306B;&#x9001;&#x4FE1;&#x3001;&#x975E;&#x9001;&#x4FE1;&#x306E;&#x4E8C;&#x3064;&#x306E;&#x884C;&#x52D5;&#x3092;&#x9078;&#x3076;&#x3053;&#x3068;&#x306B;&#x306A;&#x308B;&#x3002;

    &#x5831;&#x916C;&#xFF1A;&#x30AD;&#x30E3;&#x30F3;&#x30DA;&#x30FC;&#x30F3;&#x306E;&#x30B3;&#x30B9;&#x30C8;&#x3068;&#x3044;&#x3046;&#x8CA0;&#x306E;&#x5831;&#x916C;&#x3068;
    &#x30AD;&#x30E3;&#x30F3;&#x30DA;&#x30FC;&#x30F3;&#x3067;&#x751F;&#x307F;&#x51FA;&#x3055;&#x308C;&#x308B;&#x3068;&#x63A8;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x58F2;&#x4E0A;&#x3068;&#x3044;&#x3046;&#x6B63;&#x306E;&#x5831;&#x916C;
        &#x2192;&#x6B63;&#x306E;&#x5831;&#x916C;&#x306E;&#x6700;&#x5927;&#x5316;&#xFF06;&#x8CA0;&#x306E;&#x5831;&#x916C;&#x306E;&#x6700;&#x5C0F;&#x5316;

    &#x5831;&#x916C;&#x3092;&#x6700;&#x9069;&#x5316;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x3001;&#x3088;&#x308A;&#x3088;&#x308A;&#x65B9;&#x7B56;&#x3092;&#x751F;&#x307F;&#x51FA;&#x3059;&#x3053;&#x3068;&#x3092;&#x76EE;&#x7684;&#x3068;&#x3059;&#x308B;&#x3002;


&#x30FB;&#x63A2;&#x7D22;&#x3068;&#x5229;&#x7528;&#x306E;&#x30C8;&#x30EC;&#x30FC;&#x30C9;&#x30AA;&#x30D5;
    &#x74B0;&#x5883;&#x306B;&#x3064;&#x3044;&#x3066;&#x4E8B;&#x524D;&#x306B;&#x77E5;&#x8B58;&#x304C;&#x3042;&#x308C;&#x3070;&#x3001;
    &#x6700;&#x9069;&#x306A;&#x884C;&#x52D5;&#x3092;&#x4E88;&#x6E2C;&#x3057;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3053;&#x3068;&#x306F;&#x53EF;&#x80FD;&#x3002;
        &#x3069;&#x306E;&#x3088;&#x3046;&#x306A;&#x9867;&#x5BA2;&#x306B;&#x30AD;&#x30E3;&#x30F3;&#x30DA;&#x30FC;&#x30F3;&#x30E1;&#x30FC;&#x30EB;&#x3092;&#x9001;&#x4FE1;&#x3059;&#x308B;&#x3068;&#x3001;
        &#x3069;&#x306E;&#x3088;&#x3046;&#x306A;&#x884C;&#x52D5;&#x3092;&#x884C;&#x3046;&#x306E;&#x304B;&#x304C;&#x65E2;&#x77E5;&#x3067;&#x3042;&#x308B;&#x3002;
        &#x2193;&#x2193;&#x2193;
        &#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306E;&#x5834;&#x5408;&#x3001;&#x4E0A;&#x8A18;&#x4EEE;&#x5B9A;&#x306F;&#x6210;&#x308A;&#x7ACB;&#x305F;&#x306A;&#x3044;&#x3068;&#x3059;&#x308B;&#x3002;
        &#x4E0D;&#x5B8C;&#x5168;&#x306A;&#x77E5;&#x8B58;&#x3092;&#x3082;&#x3068;&#x306B;&#x884C;&#x52D5;&#x3057;&#x306A;&#x304C;&#x3089;&#x3001;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x53CE;&#x96C6;&#x3002;
        &#x6700;&#x9069;&#x306A;&#x884C;&#x52D5;&#x3092;&#x898B;&#x3064;&#x3051;&#x3066;&#x3044;&#x304F;&#x3002;

    &#x904E;&#x53BB;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3067;&#x3001;&#x30D9;&#x30B9;&#x30C8;&#x3068;&#x3055;&#x308C;&#x308B;&#x884C;&#x52D5;&#x306E;&#x307F;&#x3092;&#x5E38;&#x306B;&#x53D6;&#x308A;&#x7D9A;&#x3051;&#x308C;&#x3070;
    &#x4ED6;&#x306B;&#x3082;&#x3063;&#x3068;&#x30D9;&#x30B9;&#x30C8;&#x306A;&#x884C;&#x52D5;&#x3092;&#x898B;&#x3064;&#x3051;&#x308B;&#x3053;&#x3068;&#x306F;&#x3067;&#x304D;&#x306A;&#x3044;&#x3002;
        &#xFF08;&#x63A2;&#x7D22;&#x304C;&#x8DB3;&#x308A;&#x306A;&#x3044;&#x72B6;&#x614B;&#xFF09;
            &#x2191;&#x2191;&#x2191;
        &#x30C8;&#x30EC;&#x30FC;&#x30C9;&#x30AA;&#x30D5;&#x306E;&#x95A2;&#x4FC2;
            &#x2193;&#x2193;&#x2193;
    &#x672A;&#x77E5;&#x306E;&#x884C;&#x52D5;&#x306E;&#x307F;&#x3092;&#x5E38;&#x306B;&#x53D6;&#x308A;&#x7D9A;&#x3051;&#x308C;&#x3070;&#x3001;&#x904E;&#x53BB;&#x306E;&#x7D4C;&#x9A13;&#x304C;&#x6D3B;&#x304B;&#x305B;&#x306A;&#x3044;&#x3002;
        &#xFF08;&#x5229;&#x7528;&#x304C;&#x8DB3;&#x308A;&#x306A;&#x3044;&#x72B6;&#x614B;&#xFF09;
</pre>
<p>&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306E;&#x6570;&#x5B66;&#x7684;&#x8868;&#x73FE;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x65B9;&#x7B56;&#x95A2;&#x6570;&#xFF1A;</mtext><mi>&#x3C0;</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">&#x65B9;&#x7B56;&#x95A2;&#x6570;&#xFF1A;\pi(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x95A2;&#x6570;&#xFF1A;</span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#xFF1A;</mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#xFF1A;Q(s,a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#xFF1A;</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></p>
<pre class="language-text">&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x3068;&#x300C;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;&#x30FB;&#x6559;&#x5E2B;&#x306A;&#x3057;&#x5B66;&#x7FD2;&#x300D;&#x306E;&#x9055;&#x3044;
&#x7D50;&#x8AD6;&#xFF1A;&#x76EE;&#x6A19;&#x304C;&#x9055;&#x3046;
    &#x30FB;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;&#x3001;&#x6559;&#x5E2B;&#x306A;&#x3057;&#x5B66;&#x7FD2;&#x3067;&#x306F;&#x3001;&#x30C7;&#x30FC;&#x30BF;&#x306B;&#x542B;&#x307E;&#x308C;&#x308B;&#x30D1;&#x30BF;&#x30FC;&#x30F3;&#x3092;&#x898B;&#x3064;&#x3051;&#x51FA;&#x3059;&#x3002;
    &#x3000;&#x304A;&#x3088;&#x3073;&#x305D;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x4E88;&#x6E2C;&#x3059;&#x308B;&#x3053;&#x3068;&#x304C;&#x76EE;&#x6A19;
    &#x30FB;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x3067;&#x306F;&#x3001;&#x512A;&#x308C;&#x305F;&#x65B9;&#x7B56;&#x3092;&#x898B;&#x3064;&#x3051;&#x308B;&#x3053;&#x3068;&#x304C;&#x76EE;&#x6A19;

&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306B;&#x3064;&#x3044;&#x3066;
&#x30FB;&#x51AC;&#x306E;&#x6642;&#x4EE3;&#x304C;&#x3042;&#x3063;&#x305F;&#x304C;&#x3001;&#x8A08;&#x7B97;&#x901F;&#x5EA6;&#x306E;&#x9032;&#x5C55;&#x306B;&#x3088;&#x308A;&#x5927;&#x898F;&#x6A21;&#x306A;&#x72B6;&#x614B;&#x3092;&#x3082;&#x3064;&#x5834;&#x5408;&#x306E;
&#x3000;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x3092;&#x53EF;&#x80FD;&#x3068;&#x3057;&#x3064;&#x3064;&#x3042;&#x308B;&#x3002;
&#x30FB;&#x95A2;&#x6570;&#x8FD1;&#x4F3C;&#x6CD5;&#x3068;&#x3001;Q&#x5B66;&#x7FD2;&#x3092;&#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x308B;&#x624B;&#x6CD5;&#x306E;&#x767B;&#x5834;

Q&#x5B66;&#x7FD2;
&#x30FB;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3092;&#x3001;&#x884C;&#x52D5;&#x3059;&#x308B;&#x3054;&#x3068;&#x306B;&#x66F4;&#x65B0;&#x3059;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x5B66;&#x7FD2;&#x3092;&#x9032;&#x3081;&#x308B;&#x65B9;&#x6CD5;

&#x95A2;&#x6570;&#x8FD1;&#x4F3C;&#x6CD5;
&#x30FB;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3084;&#x65B9;&#x7B56;&#x95A2;&#x6570;&#x3092;&#x95A2;&#x6570;&#x8FD1;&#x4F3C;&#x3059;&#x308B;&#x624B;&#x6CD5;&#x306E;&#x3053;&#x3068;

&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3068;&#x306F;
&#x30FB;&#x4FA1;&#x5024;&#x3092;&#x8868;&#x3059;&#x95A2;&#x6570;&#x3068;&#x3057;&#x3066;&#x306F;&#x3001;&#x72B6;&#x614B;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3068;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x306E;2&#x7A2E;&#x985E;&#x304C;&#x3042;&#x308B;&#x3002;
    &#x3042;&#x308B;&#x72B6;&#x614B;&#x306E;&#x4FA1;&#x5024;&#x306B;&#x6CE8;&#x76EE;&#x3059;&#x308B;&#x5834;&#x5408;&#x306F;&#x3001;&#x72B6;&#x614B;&#x4FA1;&#x5024;&#x95A2;&#x6570;
    &#x72B6;&#x614B;&#x3068;&#x4FA1;&#x5024;&#x3092;&#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x305F;&#x4FA1;&#x5024;&#x306B;&#x6CE8;&#x76EE;&#x3059;&#x308B;&#x5834;&#x5408;&#x306F;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;
    Q&#x5B66;&#x7FD2;&#x3067;&#x306F;&#x5F8C;&#x8005;&#x306E;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3092;&#x7528;&#x3044;&#x308B;&#x3002;

&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3068;&#x72B6;&#x614B;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x306E;&#x9055;&#x3044;
    &#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306F;&#x4F55;&#x3092;&#x76EE;&#x6A19;&#x306B;&#x9811;&#x5F35;&#x308B;&#x306E;&#x304B;&#xFF1F;
    &#x72B6;&#x614B;&#x4FA1;&#x5024;&#x95A2;&#x6570;or&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;

    &#x72B6;&#x614B;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#xFF1A;&#x74B0;&#x5883;&#x306E;&#x72B6;&#x614B;&#x3060;&#x3051;&#x304C;&#x4FA1;&#x5024;&#x3092;&#x6C7A;&#x3081;&#x308B;&#x5BFE;&#x8C61;&#x3002;&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306E;&#x65B9;&#x7B56;&#x306F;&#x7121;&#x95A2;&#x4FC2;
    &#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#xFF1A;&#x72B6;&#x614B;&#x3068;&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306E;&#x884C;&#x52D5;&#x306E;&#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x304C;&#x4FA1;&#x5024;&#x3092;&#x6C7A;&#x3081;&#x308B;&#x5BFE;&#x8C61;

&#x65B9;&#x7B56;&#x95A2;&#x6570;(&#x3C0;(s,a))
    &#x65B9;&#x7B56;&#x30D9;&#x30FC;&#x30B9;&#x306E;&#x4ECA;&#x65E5;&#x304C;&#x5B66;&#x7FD2;&#x624B;&#x6CD5;&#x306B;&#x304A;&#x3044;&#x3066;&#x3001;
    &#x3042;&#x308B;&#x72B6;&#x614B;&#x3067;&#x3069;&#x306E;&#x3088;&#x3046;&#x306A;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x306E;&#x304B;&#x306E;&#x78BA;&#x7387;&#x3092;&#x4E0E;&#x3048;&#x308B;&#x95A2;&#x6570;
    &#x4FA1;&#x5024;&#x95A2;&#x6570;&#x304C;&#x51FA;&#x3057;&#x3066;&#x304F;&#x308B;&#x4FA1;&#x5024;&#x3092;&#x6700;&#x5927;&#x5316;&#x3059;&#x308B;&#x65B9;&#x7B56;&#x3092;&#x751F;&#x307F;&#x51FA;&#x3059;&#x3002;
</pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x65B9;&#x7B56;&#x95A2;&#x6570;</mtext><mo>:</mo><mi>&#x3C0;</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">&#x65B9;&#x7B56;&#x95A2;&#x6570;:\pi(s)=a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x95A2;&#x6570;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x95A2;&#x6570;&#x306E;&#x95A2;&#x4FC2;</mtext></mrow><annotation encoding="application/x-tex">&#x95A2;&#x6570;&#x306E;&#x95A2;&#x4FC2;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x95A2;&#x6570;&#x306E;&#x95A2;&#x4FC2;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mtext>&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306F;&#x65B9;&#x7B56;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;&#x884C;&#x52D5;&#x3059;&#x308B;</mtext></mrow><annotation encoding="application/x-tex">\quad&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306F;&#x65B9;&#x7B56;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;&#x884C;&#x52D5;&#x3059;&#x308B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord cjk_fallback">&#x30A8;&#x30FC;&#x30B8;&#x30A7;&#x30F3;&#x30C8;&#x306F;&#x65B9;&#x7B56;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;&#x884C;&#x52D5;&#x3059;&#x308B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>&#x3C0;</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>&#x72B6;&#x614B;&#x95A2;&#x6570;</mtext><mi>V</mi><mtext>&#x3084;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;</mtext><mi>Q</mi><mtext>&#x3092;&#x57FA;&#x306B;&#x3069;&#x3046;&#x3044;&#x3046;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x304B;</mtext></mrow><annotation encoding="application/x-tex">\pi(s,a):&#x72B6;&#x614B;&#x95A2;&#x6570;V&#x3084;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;Q&#x3092;&#x57FA;&#x306B;&#x3069;&#x3046;&#x3044;&#x3046;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x304B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">&#x72B6;&#x614B;&#x95A2;&#x6570;</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord cjk_fallback">&#x3084;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;</span><span class="mord mathnormal">Q</span><span class="mord cjk_fallback">&#x3092;&#x57FA;&#x306B;&#x3069;&#x3046;&#x3044;&#x3046;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x304B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x2192;</mo><mtext>&#x7D4C;&#x9A13;&#x3092;&#x6D3B;&#x304B;&#x3059;</mtext><mi>o</mi><mi>r</mi><mtext>&#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#x3059;&#x308B;&#x306A;&#x3069;</mtext></mrow><annotation encoding="application/x-tex">\qquad \rightarrow &#x7D4C;&#x9A13;&#x3092;&#x6D3B;&#x304B;&#x3059; or &#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#x3059;&#x308B; &#x306A;&#x3069;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x7D4C;&#x9A13;&#x3092;&#x6D3B;&#x304B;&#x3059;</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord cjk_fallback">&#x30C1;&#x30E3;&#x30EC;&#x30F3;&#x30B8;&#x3059;&#x308B;&#x306A;&#x3069;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x2192;</mo><mtext>&#x305D;&#x306E;&#x77AC;&#x9593;&#x3001;&#x305D;&#x306E;&#x77AC;&#x9593;&#x306E;&#x884C;&#x52D5;&#x3092;&#x3069;&#x3046;&#x3059;&#x308B;&#x304B;</mtext></mrow><annotation encoding="application/x-tex">\qquad \rightarrow &#x305D;&#x306E;&#x77AC;&#x9593;&#x3001;&#x305D;&#x306E;&#x77AC;&#x9593;&#x306E;&#x884C;&#x52D5;&#x3092;&#x3069;&#x3046;&#x3059;&#x308B;&#x304B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x305D;&#x306E;&#x77AC;&#x9593;&#x3001;&#x305D;&#x306E;&#x77AC;&#x9593;&#x306E;&#x884C;&#x52D5;&#x3092;&#x3069;&#x3046;&#x3059;&#x308B;&#x304B;</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>V</mi><mi>&#x3C0;</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>&#x72B6;&#x614B;&#x95A2;&#x6570;</mtext></mrow><annotation encoding="application/x-tex">V^{\pi}(s):&#x72B6;&#x614B;&#x95A2;&#x6570;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x72B6;&#x614B;&#x95A2;&#x6570;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Q</mi><mi>&#x3C0;</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>:</mo><mtext>&#x72B6;&#x614B;</mtext><mo>+</mo><mtext>&#x884C;&#x52D5;&#x95A2;&#x6570;</mtext></mrow><annotation encoding="application/x-tex">Q^{\pi}(s,a):&#x72B6;&#x614B;+&#x884C;&#x52D5;&#x95A2;&#x6570;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">&#x72B6;&#x614B;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x884C;&#x52D5;&#x95A2;&#x6570;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x2192;</mo><mtext>&#x30B4;&#x30FC;&#x30EB;&#x307E;&#x3067;&#x4ECA;&#x306E;&#x65B9;&#x7B56;&#x3092;&#x7D9A;&#x3051;&#x305F;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;&#x306E;&#x4E88;&#x6E2C;&#x5024;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;</mtext></mrow><annotation encoding="application/x-tex">\qquad \rightarrow &#x30B4;&#x30FC;&#x30EB;&#x307E;&#x3067;&#x4ECA;&#x306E;&#x65B9;&#x7B56;&#x3092;&#x7D9A;&#x3051;&#x305F;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;&#x306E;&#x4E88;&#x6E2C;&#x5024;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x30B4;&#x30FC;&#x30EB;&#x307E;&#x3067;&#x4ECA;&#x306E;&#x65B9;&#x7B56;&#x3092;&#x7D9A;&#x3051;&#x305F;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;&#x306E;&#x4E88;&#x6E2C;&#x5024;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x2192;</mo><mtext>&#x3084;&#x308A;&#x7D9A;&#x3051;&#x305F;&#x3089;&#x6700;&#x7D42;&#x7684;&#x306B;&#x3069;&#x3046;&#x306A;&#x308B;&#x304B;</mtext></mrow><annotation encoding="application/x-tex">\qquad \rightarrow &#x3084;&#x308A;&#x7D9A;&#x3051;&#x305F;&#x3089;&#x6700;&#x7D42;&#x7684;&#x306B;&#x3069;&#x3046;&#x306A;&#x308B;&#x304B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x3084;&#x308A;&#x7D9A;&#x3051;&#x305F;&#x3089;&#x6700;&#x7D42;&#x7684;&#x306B;&#x3069;&#x3046;&#x306A;&#x308B;&#x304B;</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x65B9;&#x7B56;&#x53CD;&#x5FA9;&#x6CD5;</mtext></mrow><annotation encoding="application/x-tex">&#x65B9;&#x7B56;&#x53CD;&#x5FA9;&#x6CD5;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x53CD;&#x5FA9;&#x6CD5;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mtext>&#x65B9;&#x7B56;&#x3092;&#x30E2;&#x30C7;&#x30EB;&#x5316;&#x3057;&#x3066;&#x6700;&#x9069;&#x5316;&#x3059;&#x308B;&#x624B;&#x6CD5;</mtext></mrow><annotation encoding="application/x-tex">\qquad &#x65B9;&#x7B56;&#x3092;&#x30E2;&#x30C7;&#x30EB;&#x5316;&#x3057;&#x3066;&#x6700;&#x9069;&#x5316;&#x3059;&#x308B;&#x624B;&#x6CD5;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x3092;&#x30E2;&#x30C7;&#x30EB;&#x5316;&#x3057;&#x3066;&#x6700;&#x9069;&#x5316;&#x3059;&#x308B;&#x624B;&#x6CD5;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x6CD5;</mtext><mspace width="1em"></mspace><mi>&#x3C0;</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mi mathvariant="normal">&#x2223;</mi><mi>&#x3B8;</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x6CD5; \quad \pi(s,a|\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x6CD5;</span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mord">&#x2223;</span><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><msup><mi>&#x3B8;</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>&#x3B8;</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>&#x3F5;</mi><mi mathvariant="normal">&#x2207;</mi><mi>J</mi><mo stretchy="false">(</mo><mi>&#x3B8;</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad \theta^{(t+1)}=\theta^{(t)}+\epsilon \nabla J(\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9713299999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">t</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">&#x3F5;</span><span class="mord">&#x2207;</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mtext>&#x5831;&#x916C;&#x306E;&#x6700;&#x5927;&#x5316;&#x3092;&#x76EE;&#x6307;&#x3059;&#x305F;&#x3081;&#x3001;&#x30D7;&#x30E9;&#x30B9;&#x3067;&#x52A0;&#x7B97;&#x3057;&#x3066;&#x3044;&#x308B;</mtext></mrow><annotation encoding="application/x-tex">\qquad &#x5831;&#x916C;&#x306E;&#x6700;&#x5927;&#x5316;&#x3092;&#x76EE;&#x6307;&#x3059;&#x305F;&#x3081;&#x3001;&#x30D7;&#x30E9;&#x30B9;&#x3067;&#x52A0;&#x7B97;&#x3057;&#x3066;&#x3044;&#x308B;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord cjk_fallback">&#x5831;&#x916C;&#x306E;&#x6700;&#x5927;&#x5316;&#x3092;&#x76EE;&#x6307;&#x3059;&#x305F;&#x3081;&#x3001;&#x30D7;&#x30E9;&#x30B9;&#x3067;&#x52A0;&#x7B97;&#x3057;&#x3066;&#x3044;&#x308B;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mi>J</mi><mo>=</mo><mtext>&#x65B9;&#x7B56;&#x306E;&#x826F;&#x3055;</mtext><mo stretchy="false">(</mo><mi>N</mi><mi>N</mi><mtext>&#x3067;&#x306F;&#x8AA4;&#x5DEE;&#x95A2;&#x6570;&#x3001;&#x3053;&#x3053;&#x3067;&#x306F;&#x671F;&#x5F85;&#x53CE;&#x76CA;</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\qquad J=&#x65B9;&#x7B56;&#x306E;&#x826F;&#x3055;(NN&#x3067;&#x306F;&#x8AA4;&#x5DEE;&#x95A2;&#x6570;&#x3001;&#x3053;&#x3053;&#x3067;&#x306F;&#x671F;&#x5F85;&#x53CE;&#x76CA;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x65B9;&#x7B56;&#x306E;&#x826F;&#x3055;</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">NN</span><span class="mord cjk_fallback">&#x3067;&#x306F;&#x8AA4;&#x5DEE;&#x95A2;&#x6570;&#x3001;&#x3053;&#x3053;&#x3067;&#x306F;&#x671F;&#x5F85;&#x53CE;&#x76CA;</span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x2192;</mo><mtext>&#x5B9A;&#x7FA9;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;&#x306A;&#x3089;&#x306A;&#x3044;</mtext></mrow><annotation encoding="application/x-tex">\qquad \rightarrow &#x5B9A;&#x7FA9;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;&#x306A;&#x3089;&#x306A;&#x3044;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x5B9A;&#x7FA9;&#x3057;&#x306A;&#x3051;&#x308C;&#x3070;&#x306A;&#x3089;&#x306A;&#x3044;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x5B9A;&#x7FA9;&#x65B9;&#x6CD5;</mtext></mrow><annotation encoding="application/x-tex">&#x5B9A;&#x7FA9;&#x65B9;&#x6CD5;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x5B9A;&#x7FA9;&#x65B9;&#x6CD5;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x22C5;</mo><mtext>&#x5E73;&#x5747;&#x5831;&#x916C;&#x548C;</mtext></mrow><annotation encoding="application/x-tex">\qquad \cdot &#x5E73;&#x5747;&#x5831;&#x916C;&#x548C;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord">&#x22C5;</span><span class="mord cjk_fallback">&#x5E73;&#x5747;&#x5831;&#x916C;&#x548C;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mo>&#x22C5;</mo><mtext>&#x5272;&#x5F15;&#x5831;&#x916C;&#x548C;</mtext></mrow><annotation encoding="application/x-tex">\qquad \cdot &#x5272;&#x5F15;&#x5831;&#x916C;&#x548C;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord">&#x22C5;</span><span class="mord cjk_fallback">&#x5272;&#x5F15;&#x5831;&#x916C;&#x548C;</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x4E0A;&#x8A18;&#x306E;&#x5B9A;&#x7FA9;&#x306B;&#x5BFE;&#x5FDC;&#x3057;&#x3066;&#x3001;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;</mtext><mo>:</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo><mtext>&#x306E;&#x5B9A;&#x7FA9;&#x3092;&#x884C;&#x3044;&#x3001;&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x5B9A;&#x7406;&#x304C;&#x6210;&#x308A;&#x7ACB;&#x3064;</mtext></mrow><annotation encoding="application/x-tex">&#x4E0A;&#x8A18;&#x306E;&#x5B9A;&#x7FA9;&#x306B;&#x5BFE;&#x5FDC;&#x3057;&#x3066;&#x3001;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;:Q(s,a)&#x306E;&#x5B9A;&#x7FA9;&#x3092;&#x884C;&#x3044;&#x3001;&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x5B9A;&#x7406;&#x304C;&#x6210;&#x308A;&#x7ACB;&#x3064;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x4E0A;&#x8A18;&#x306E;&#x5B9A;&#x7FA9;&#x306B;&#x5BFE;&#x5FDC;&#x3057;&#x3066;&#x3001;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord cjk_fallback">&#x306E;&#x5B9A;&#x7FA9;&#x3092;&#x884C;&#x3044;&#x3001;&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x5B9A;&#x7406;&#x304C;&#x6210;&#x308A;&#x7ACB;&#x3064;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">&#x2207;</mi><mi>&#x3B8;</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>&#x3B8;</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>&#x3C0;</mi><mi>&#x3B8;</mi></mrow></msub><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi mathvariant="normal">&#x2207;</mi><mi>&#x3B8;</mi></msub><mi>log</mi><mo>&#x2061;</mo><munder accentunder="true"><mrow><msub><mi>&#x3C0;</mi><mi>&#x3B8;</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">&#x2223;</mi><mi>s</mi><mo stretchy="false">)</mo><msup><mi>Q</mi><mi>&#x3C0;</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">&#x203E;</mo></munder><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\nabla_{\theta}J(\theta)=\mathbb E_{\pi \theta}[(\nabla_{\theta}\log \underline{\pi_{\theta}(a|s)Q^{\pi}(s,a)})]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">&#x2207;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2000000000000002em;vertical-align:-0.45000000000000007em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">&#x3C0;</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">[(</span><span class="mord"><span class="mord">&#x2207;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7499999999999999em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">&#x2223;</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.45000000000000007em;"><span></span></span></span></span></span><span class="mclose">)]</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mspace" style="margin-right:1em;"></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x5143;&#x306E;&#x5F0F;&#xFF1A;</mtext><msub><mi mathvariant="normal">&#x2207;</mi><mi>&#x3B8;</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>&#x3B8;</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="normal">&#x2207;</mi><mi>&#x3B8;</mi></msub><mstyle scriptlevel="0" displaystyle="true"><munder><mo>&#x2211;</mo><mrow><mi>a</mi><mo>&#x2208;</mo><mi>A</mi></mrow></munder><munder accentunder="true"><mrow><msub><mi>&#x3C0;</mi><mi>&#x3B8;</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">&#x2223;</mi><mi>s</mi><mo stretchy="false">)</mo><msup><mi>Q</mi><mi>&#x3C0;</mi></msup><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><mo stretchy="true">&#x203E;</mo></munder></mstyle></mrow><annotation encoding="application/x-tex">&#x5143;&#x306E;&#x5F0F;&#xFF1A;\nabla_{\theta}J(\theta)=\nabla_{\theta} \displaystyle \sum_{a \isin A} \underline{\pi_{\theta}(a|s)Q^{\pi}(s,a)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x5143;&#x306E;&#x5F0F;&#xFF1A;</span><span class="mord"><span class="mord">&#x2207;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">&#x3B8;</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3717110000000003em;vertical-align:-1.321706em;"></span><span class="mord"><span class="mord">&#x2207;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mrel mtight">&#x2208;</span><span class="mord mathnormal mtight">A</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.321706em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7499999999999999em;"><span style="top:-2.59em;"><span class="pstrut" style="height:3em;"></span><span class="underline-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C0;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">&#x3B8;</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">&#x2223;</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.45000000000000007em;"><span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mo>&#x2193;</mo><mtext>&#x3042;&#x308B;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;</mtext></mrow><annotation encoding="application/x-tex">\qquad \qquad \qquad \qquad \qquad \qquad \qquad \downarrow &#x3042;&#x308B;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mrel">&#x2193;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x3042;&#x308B;&#x884C;&#x52D5;&#x3092;&#x3068;&#x308B;&#x3068;&#x304D;&#x306E;&#x5831;&#x916C;</span></span></span></span></p>
<h3 class="mume-header" id="9-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">9-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306F;&#x3053;&#x308C;&#x307E;&#x3067;&#x5B66;&#x7FD2;&#x3057;&#x3066;&#x304D;&#x305F;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;&#x3001;&#x6559;&#x5E2B;&#x306A;&#x3057;&#x5B66;&#x7FD2;&#x3068;&#x7570;&#x306A;&#x308A;&#x3001;
&#x5B66;&#x7FD2;&#x30C7;&#x30FC;&#x30BF;&#x306B;&#x6B63;&#x89E3;&#x3092;&#x6C42;&#x3081;&#x308B;&#x306E;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;&#x76EE;&#x7684;&#x3068;&#x3057;&#x3066;&#x8A2D;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x5831;&#x916C;&#x306E;
&#x6700;&#x5927;&#x5316;&#x3092;&#x3059;&#x308B;&#x305F;&#x3081;&#x306E;&#x884C;&#x52D5;&#x3092;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x624B;&#x6CD5;&#x3067;&#x3042;&#x308B;&#x3002;
&#x56F2;&#x7881;&#x30FB;&#x5C06;&#x68CB;&#x3068;&#x3044;&#x3063;&#x305F;&#x76E4;&#x9762;&#x3092;&#x7528;&#x3044;&#x308B;&#x30B2;&#x30FC;&#x30E0;&#x306E;&#x52DD;&#x3061;&#x624B;&#x3084;&#x81EA;&#x52D5;&#x904B;&#x8EE2;&#x306B;&#x304A;&#x3051;&#x308B;
&#x72B6;&#x6CC1;&#x5224;&#x65AD;&#x306E;&#x5B66;&#x7FD2;&#x306B;&#x7528;&#x3044;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
&#x6570;&#x5B66;&#x7684;&#x8868;&#x73FE;&#x3068;&#x3057;&#x3066;&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3001;&#x65B9;&#x7B56;&#x95A2;&#x6570;&#x304C;&#x3042;&#x308A;&#x3001;&#x524D;&#x8005;&#x306F;&#x72B6;&#x614B;&#x3068;&#x884C;&#x52D5;&#x306E;
&#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x3067;&#x4FA1;&#x5024;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3082;&#x306E;&#x3067;&#x3001;&#x5F8C;&#x8005;&#x306F;&#x305D;&#x306E;&#x4FA1;&#x5024;&#x3092;&#x6700;&#x5927;&#x5316;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;
&#x6700;&#x9069;&#x306A;&#x884C;&#x52D5;&#xFF08;&#x65B9;&#x7B56;&#xFF09;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x3002;
&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x6CD5;&#x3092;&#x7528;&#x3044;&#x3066;&#x6700;&#x9069;&#x5024;&#x3092;&#x6C42;&#x3081;&#x308B;&#x304C;&#x3001;&#x901A;&#x5E38;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x540C;&#x69D8;
&#x52FE;&#x914D;&#x3092;&#x6C42;&#x3081;&#x3066;&#x6700;&#x9069;&#x89E3;&#x3092;&#x76EE;&#x6307;&#x3059;&#x65B9;&#x6CD5;&#x8AD6;&#x306F;&#x540C;&#x4E00;&#x3002;    
&#x305F;&#x3060;&#x3057;&#x3001;&#x5831;&#x916C;&#x306E;&#x6700;&#x5927;&#x5316;&#x3092;&#x76EE;&#x6307;&#x3059;&#x305F;&#x3081;&#x52A0;&#x7B97;&#x3059;&#x308B;&#x3002;
</pre>
<h3 class="mume-header" id="9-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">9-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<h3 class="mume-header" id="9-3%E7%A2%BA%E8%AA%8D%E3%83%86%E3%82%B9%E3%83%88%E8%80%83%E5%AF%9F%E7%B5%90%E6%9E%9C">9-3.&#x78BA;&#x8A8D;&#x30C6;&#x30B9;&#x30C8;&#x8003;&#x5BDF;&#x7D50;&#x679C;</h3>

<h2 class="mume-header" id="10section2alpha-go">10.Section2:Alpha Go</h2>

<pre class="language-text">Alpha Go&#x306B;&#x306F;&#x4EE5;&#x4E0B;&#x306E;2&#x7A2E;&#x985E;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;
    &#xFF11;&#xFF0E;Alpha Go Lee
    &#xFF12;&#xFF0E;Alpha Go Zero

&#x307E;&#x305A;&#x3001;Alpha Go Lee&#x306B;&#x3064;&#x3044;&#x3066;&#x306E;&#x8AAC;&#x660E;
</pre>
<h3 class="mume-header" id="policynet%E6%96%B9%E7%AD%96%E9%96%A2%E6%95%B0%E3%81%AE%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF">PolicyNet(&#x65B9;&#x7B56;&#x95A2;&#x6570;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;)</h3>

<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoLee_PolicyNet.png" alt="png"></p>
<h3 class="mume-header" id="48%E3%83%81%E3%83%A3%E3%83%B3%E3%83%8D%E3%83%AB%E3%81%AE%E5%86%85%E8%A8%B3">48&#x30C1;&#x30E3;&#x30F3;&#x30CD;&#x30EB;&#x306E;&#x5185;&#x8A33;</h3>

<table>
<thead>
<tr>
<th style="text-align:left">&#x7279;&#x5FB4;</th>
<th style="text-align:center">&#x30C1;&#x30E3;&#x30F3;&#x30CD;&#x30EB;&#x6570;</th>
<th style="text-align:center">&#x8AAC;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&#x77F3;</td>
<td style="text-align:center">3</td>
<td style="text-align:center">&#x81EA;&#x77F3;&#x3001;&#x6575;&#x77F3;&#x3001;&#x7A7A;&#x767D;&#x306E;3&#x30C1;&#x30E3;&#x30F3;&#x30CD;&#x30EB;</td>
</tr>
<tr>
<td style="text-align:left">ALL1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x5168;&#x9762;1</td>
</tr>
<tr>
<td style="text-align:left">&#x7740;&#x624B;&#x5C65;&#x6B74;</td>
<td style="text-align:center">8</td>
<td style="text-align:center">8&#x624B;&#x524D;&#x307E;&#x3067;&#x306B;&#x77F3;&#x304C;&#x6253;&#x305F;&#x308C;&#x305F;&#x5834;&#x6240;</td>
</tr>
<tr>
<td style="text-align:left">&#x547C;&#x5438;&#x70B9;</td>
<td style="text-align:center">8</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x304C;&#x3042;&#x308B;&#x5834;&#x5408;&#x3001;<br>&#x305D;&#x306E;&#x77F3;&#x3092;&#x542B;&#x3080;&#x9023;&#x306E;&#x547C;&#x5438;&#x70B9;&#x306E;&#x6570;</td>
</tr>
<tr>
<td style="text-align:left">&#x53D6;&#x308C;&#x308B;&#x77F3;&#x306E;&#x6570;</td>
<td style="text-align:center">8</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x3092;&#x6253;&#x3063;&#x305F;&#x5834;&#x5408;&#x3001;<br>&#x53D6;&#x308C;&#x308B;&#x77F3;&#x306E;&#x6570;</td>
</tr>
<tr>
<td style="text-align:left">&#x53D6;&#x3089;&#x308C;&#x308B;&#x77F3;&#x306E;&#x6570;</td>
<td style="text-align:center">8</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x3092;&#x6253;&#x305F;&#x308C;&#x305F;&#x5834;&#x5408;&#x3001;<br>&#x53D6;&#x3089;&#x308C;&#x308B;&#x77F3;&#x306E;&#x6570;</td>
</tr>
<tr>
<td style="text-align:left">&#x7740;&#x624B;&#x5F8C;&#x306E;&#x547C;&#x5438;&#x70B9;&#x306E;&#x6570;</td>
<td style="text-align:center">8</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x3092;&#x6253;&#x3063;&#x305F;&#x5834;&#x5408;&#x3001;<br>&#x305D;&#x306E;&#x77F3;&#x3092;&#x542B;&#x3080;&#x9023;&#x306E;&#x547C;&#x5438;&#x70B9;&#x306E;&#x6570;</td>
</tr>
<tr>
<td style="text-align:left">&#x7740;&#x624B;&#x5F8C;&#x306B;&#x30B7;&#x30C1;&#x30E7;&#x30A6;<br>&#x3067;&#x53D6;&#x308C;&#x308B;&#x304B;</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x3092;&#x6253;&#x3063;&#x305F;&#x5834;&#x5408;&#x3001;<br>&#x30B7;&#x30C1;&#x30E7;&#x30A6;&#x3067;&#x96A3;&#x63A5;&#x70B9;&#x3092;&#x53D6;&#x308C;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;</td>
</tr>
<tr>
<td style="text-align:left">&#x7740;&#x624B;&#x5F8C;&#x306B;&#x30B7;&#x30C1;&#x30E7;&#x30A6;<br>&#x3067;&#x53D6;&#x3089;&#x308C;&#x308B;&#x304B;</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x8A72;&#x5F53;&#x306E;&#x4F4D;&#x7F6E;&#x306B;&#x77F3;&#x3092;&#x6253;&#x305F;&#x308C;&#x305F;&#x5834;&#x5408;&#x3001;<br>&#x30B7;&#x30C1;&#x30E7;&#x30A6;&#x3067;&#x96A3;&#x63A5;&#x70B9;&#x3092;&#x53D6;&#x308C;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;</td>
</tr>
<tr>
<td style="text-align:left">&#x5408;&#x6CD5;&#x624B;</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x5408;&#x6CD5;&#x624B;&#x3067;&#x3042;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;</td>
</tr>
<tr>
<td style="text-align:left">ALL0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x5168;&#x9762;0</td>
</tr>
<tr>
<td style="text-align:left">&#x624B;&#x756A;</td>
<td style="text-align:center">1</td>
<td style="text-align:center">&#x73FE;&#x5728;&#x306E;&#x624B;&#x756A;&#x304C;&#x9ED2;&#x756A;&#x3067;&#x3042;&#x308B;&#x304B;&#xFF1F;<br>(PolicyNet&#x306B;&#x306F;&#x306A;&#x304F;ValueNet&#x306E;&#x307F;)</td>
</tr>
</tbody>
</table>
<h3 class="mume-header" id="valuenet%E8%A1%8C%E5%8B%95%E4%BE%A1%E5%80%A4%E9%96%A2%E6%95%B0%E3%81%AE%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF">ValueNet(&#x884C;&#x52D5;&#x4FA1;&#x5024;&#x95A2;&#x6570;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;)</h3>

<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoLee_ValueNet.png" alt="png"></p>
<h3 class="mume-header" id="rolloutpolicy%E6%95%99%E5%B8%AB%E3%81%82%E3%82%8A%E5%AD%A6%E7%BF%92">RollOutPolicy(&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;)</h3>

<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoLee_RollOutPolicy.png" alt="png"></p>
<pre class="language-text">&#xFF11;&#xFF0E;PolicyNet&#x306E;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;
    KGS Go Server(&#x30CD;&#x30C3;&#x30C8;&#x56F2;&#x7881;&#x5BFE;&#x5C40;&#x30B5;&#x30A4;&#x30C8;)&#x306E;&#x68CB;&#x8B5C;&#x30C7;&#x30FC;&#x30BF;&#x304B;&#x3089;3000&#x4E07;&#x5C40;&#x9762;&#x5206;&#x306E;&#x6559;&#x5E2B;&#x3092;&#x7528;&#x610F;&#x3057;&#x3001;
    &#x6559;&#x5E2B;&#x3068;&#x540C;&#x3058;&#x7740;&#x624B;&#x3092;&#x4E88;&#x6E2C;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x3063;&#x305F;&#x3002;

    &#x5177;&#x4F53;&#x7684;&#x306B;&#x306F;&#x3001;&#x6559;&#x5E2B;&#x304C;&#x7740;&#x624B;&#x3057;&#x305F;&#x624B;&#x3092;1&#x3068;&#x3057;&#x6B8B;&#x308A;&#x3092;0&#x3068;&#x3057;&#x305F;19&#xD7;19&#x6B21;&#x5143;&#x306E;&#x914D;&#x5217;&#x3092;
    &#x6559;&#x5E2B;&#x3068;&#x3057;&#x3001;&#x305D;&#x308C;&#x3092;&#x5206;&#x985E;&#x554F;&#x984C;&#x3068;&#x3057;&#x3066;&#x5B66;&#x7FD2;&#x3057;&#x305F;&#x3002;

    &#x3053;&#x306E;&#x5B66;&#x7FD2;&#x3067;&#x4F5C;&#x6210;&#x3057;&#x305F;PolicyNet&#x306F;57%&#x7A0B;&#x5EA6;&#x306E;&#x7CBE;&#x5EA6;&#x3067;&#x3042;&#x308B;&#x3002;

&#xFF12;&#xFF0E;RollOutPolicy&#x306E;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;
    24%&#x7A0B;&#x5EA6;&#x306E;&#x7CBE;&#x5EA6;   

&#xFF13;&#xFF0E;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306B;&#x3088;&#x308B;PolicyNet&#x306E;&#x5B66;&#x7FD2;
    &#x73FE;&#x72B6;&#x306E;PolicyNet&#x3068;PolicyPool&#x304B;&#x3089;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x306B;&#x9078;&#x629E;&#x3055;&#x308C;&#x305F;PolicyNet&#x3068;
    &#x5BFE;&#x5C40;&#x30B7;&#x30DF;&#x30E5;&#x30EC;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x884C;&#x3044;&#x3001;&#x305D;&#x306E;&#x7D50;&#x679C;&#x3092;&#x7528;&#x3044;&#x3066;&#x65B9;&#x7B56;&#x52FE;&#x914D;&#x6CD5;&#x3067;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x3063;&#x305F;&#x3002;

    PolicyPool&#x3068;&#x306F;&#x3001;PolicyNet&#x306E;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306E;&#x904E;&#x7A0B;&#x3092;500Iteration&#x3054;&#x3068;&#x306B;
    &#x8A18;&#x9332;&#x3057;&#x3001;&#x4FDD;&#x5B58;&#x3057;&#x305F;&#x3082;&#x306E;&#x3067;&#x3042;&#x308B;&#x3002;

    &#x73FE;&#x72B6;&#x306E;PolicyNet&#x540C;&#x58EB;&#x306E;&#x5BFE;&#x5C40;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;PolicyPool&#x306B;&#x4FDD;&#x5B58;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3082;&#x306E;&#x3068;&#x306E;
    &#x5BFE;&#x5C40;&#x3092;&#x4F7F;&#x7528;&#x3059;&#x308B;&#x7406;&#x7531;&#x306F;&#x3001;&#x5BFE;&#x5C40;&#x306B;&#x5E45;&#x3092;&#x6301;&#x305F;&#x305B;&#x3066;&#x904E;&#x5B66;&#x7FD2;&#x3092;&#x9632;&#x3054;&#x3046;&#x3068;&#x3044;&#x3046;&#x306E;&#x304C;&#x4E3B;&#x3067;&#x3042;&#x308B;&#x3002;

    &#x3053;&#x306E;&#x5B66;&#x7FD2;&#x3092;mini batch size 128&#x3067;1&#x4E07;&#x56DE;&#x884C;&#x3063;&#x305F;&#x3002;

&#xFF14;&#xFF0E;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306B;&#x3088;&#x308B;ValueNet&#x306E;&#x5B66;&#x7FD2;

    PolicyNet&#x3092;&#x4F7F;&#x7528;&#x3057;&#x3066;&#x5BFE;&#x5C40;&#x30B7;&#x30DF;&#x30E5;&#x30EC;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x884C;&#x3044;&#x3001;&#x305D;&#x306E;&#x7D50;&#x679C;&#x306E;&#x52DD;&#x6557;&#x3092;
    &#x6559;&#x5E2B;&#x3068;&#x3057;&#x3066;&#x5B66;&#x7FD2;&#x3057;&#x305F;&#x3002;
    &#x6559;&#x5E2B;&#x30C7;&#x30FC;&#x30BF;&#x4F5C;&#x6210;&#x306E;&#x624B;&#x9806;&#x306F;

    &#xFF11;&#xFF0E;&#x307E;&#x305A;SL PolicyNet(&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;&#x3067;&#x4F5C;&#x6210;&#x3057;&#x305F;PolicyNet)&#x3067;N&#x624B;&#x307E;&#x3067;&#x6253;&#x3064;&#x3002;
    &#xFF12;&#xFF0E;N+1&#x624B;&#x76EE;&#x306E;&#x624B;&#x3092;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x306B;&#x9078;&#x629E;&#x3057;&#x3001;&#x305D;&#x306E;&#x624B;&#x3067;&#x9032;&#x3081;&#x305F;&#x5C40;&#x9762;&#x3092;S(N+1)&#x3068;&#x3059;&#x308B;&#x3002;
    &#xFF13;&#xFF0E;S(N+1)&#x304B;&#x3089;RL PolicyNet(&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x3067;&#x4F5C;&#x6210;&#x3057;&#x305F;PolicyNet)&#x3067;&#x7D42;&#x5C40;&#x307E;&#x3067;&#x6253;&#x3061;&#x3001;
    &#x3000;&#x3000;&#x305D;&#x306E;&#x52DD;&#x6557;&#x5831;&#x916C;&#x3092;R&#x3068;&#x3059;&#x308B;&#x3002;

    S(N+1)&#x3068;R&#x3092;&#x6559;&#x5E2B;&#x30C7;&#x30FC;&#x30BF;&#x5BFE;&#x3068;&#x3057;&#x3001;&#x640D;&#x5931;&#x95A2;&#x6570;&#x3092;&#x5E73;&#x5747;&#x4E8C;&#x4E57;&#x8AA4;&#x5DEE;&#x3068;&#x3057;&#x3001;&#x56DE;&#x5E30;&#x554F;&#x984C;&#x3068;&#x3057;&#x3066;&#x5B66;&#x7FD2;&#x3057;&#x305F;&#x3002;

    &#x3053;&#x306E;&#x5B66;&#x7FD2;&#x3092;mini batch size 32&#x3067;5000&#x4E07;&#x56DE;&#x304A;&#x3063;&#x3053;&#x306A;&#x3063;&#x305F;&#x3002;

    N&#x624B;&#x307E;&#x3067;&#x3068;N+1&#x624B;&#x304B;&#x3089;&#x306E;PolicyNet&#x3092;&#x5225;&#x3005;&#x306B;&#x3057;&#x3066;&#x3042;&#x308B;&#x7406;&#x7531;&#x306F;&#x3001;&#x904E;&#x5B66;&#x7FD2;&#x3092;&#x9632;&#x3050;&#x305F;&#x3081;&#x3067;&#x3042;&#x308B;&#x3068;&#x8AD6;&#x6587;&#x3067;&#x306F;&#x8AAC;&#x660E;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;

&#x30E2;&#x30F3;&#x30C6;&#x30AB;&#x30EB;&#x30ED;&#x6728;&#x63A2;&#x7D22;
    &#x56F2;&#x7881;&#x30BD;&#x30D5;&#x30C8;&#x3067;&#x306F;&#x73FE;&#x5728;&#x6700;&#x3082;&#x6709;&#x52B9;&#x3068;&#x3055;&#x308C;&#x308B;&#x63A2;&#x7D22;&#x6CD5;&#x3002;
    &#x4FA1;&#x5024;&#x95A2;&#x6570;&#x3092;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;&#x3068;&#x304D;&#x306B;&#x3069;&#x306E;&#x3088;&#x3046;&#x306B;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;&#x304B;&#x3092;&#x6C7A;&#x3081;&#x308B;&#x624B;&#x6CD5;

Alpha Go Lee&#x3068;Alpha Go Zero&#x306E;&#x9055;&#x3044;
    &#xFF11;&#xFF0E;&#x6559;&#x5E2B;&#x3042;&#x308A;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x308F;&#x305A;&#x3001;&#x5F37;&#x5316;&#x5B66;&#x7FD2;&#x306E;&#x307F;&#x3067;&#x4F5C;&#x6210;
    &#xFF12;&#xFF0E;&#x7279;&#x5FB4;&#x5165;&#x529B;&#x304B;&#x3089;&#x30D2;&#x30E5;&#x30FC;&#x30EA;&#x30B9;&#x30C6;&#x30A3;&#x30C3;&#x30AF;&#x306A;&#x8981;&#x7D20;&#x3092;&#x6392;&#x9664;&#x3057;&#x3001;&#x77F3;&#x306E;&#x914D;&#x7F6E;&#x306E;&#x307F;&#x306B;&#x3057;&#x305F;
    &#xFF13;&#xFF0E;PolicyNet&#x3068;ValueNet&#x3092;&#xFF11;&#x3064;&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306B;&#x7D71;&#x5408;&#x3057;&#x305F;
    &#xFF14;&#xFF0E;Residual Net(&#x5F8C;&#x8FF0;)&#x3092;&#x5C0E;&#x5165;&#x3057;&#x305F;
    &#xFF15;&#xFF0E;&#x30E2;&#x30F3;&#x30C6;&#x30AB;&#x30EB;&#x30ED;&#x6728;&#x63A2;&#x7D22;&#x304B;&#x3089;RollOut&#x30B7;&#x30DF;&#x30E5;&#x30EC;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x3092;&#x306A;&#x304F;&#x3057;&#x305F;
</pre>
<h3 class="mume-header" id="alpha-go-zero%E3%81%AEpolicyvaluenet">ALpha Go Zero&#x306E;PolicyValueNet</h3>

<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoZero_PolicyValueNet.png" alt="png"></p>
<pre class="language-text">Residual Network&#x3068;&#x306F;
    &#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306B;&#x30B7;&#x30E7;&#x30FC;&#x30C8;&#x30AB;&#x30C3;&#x30C8;&#x69CB;&#x9020;&#x3092;&#x8FFD;&#x52A0;&#x3057;&#x3066;&#x3001;
    &#x52FE;&#x914D;&#x306E;&#x7206;&#x767A;&#x30FB;&#x6D88;&#x5931;&#x3092;&#x6291;&#x3048;&#x308B;&#x52B9;&#x679C;&#x3092;&#x72D9;&#x3063;&#x305F;&#x3082;&#x306E;
    &#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x6DF1;&#x3055;&#x3092;&#x6291;&#x3048;&#x308B;&#x30EB;&#x30FC;&#x30C8;&#x304C;&#x3067;&#x304D;&#x308B;&#x306E;&#x3067;
    &#x52FE;&#x914D;&#x7206;&#x767A;&#x30FB;&#x6D88;&#x5931;&#x304C;&#x8D77;&#x304D;&#x306B;&#x304F;&#x304F;&#x306A;&#x308B;

    Residual Network&#x3092;&#x4F7F;&#x3046;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x3001;
    100&#x5C64;&#x3092;&#x8D85;&#x3048;&#x308B;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x306E;&#x5B89;&#x5B9A;&#x3057;&#x305F;&#x5B66;&#x7FD2;&#x304C;&#x53EF;&#x80FD;&#x3068;&#x306A;&#x3063;&#x305F;&#x3002;

    &#x57FA;&#x672C;&#x69CB;&#x9020;&#x306F;
    &#x300C;Convolution&#x300D;&#x2192;&#x300C;BatchNorm&#x300D;&#x2192;&#x300C;ReLU&#x300D;&#x2192;&#x300C;Convolution&#x300D;&#x2192;&#x300C;BatchNorm&#x300D;
    &#x2192;&#x300C;Add&#x300D;&#x2192;&#x300C;ReLU&#x300D;&#x306E;Block&#x3092;1&#x5358;&#x4F4D;&#x306B;&#x3057;&#x3066;&#x7A4D;&#x307F;&#x91CD;&#x306D;&#x308B;&#x5F62;&#x3068;&#x306A;&#x308B;

    &#x307E;&#x305F;&#x3001;Resisual&#x3000;Network&#x3092;&#x4F7F;&#x3046;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x5C64;&#x6570;&#x306E;&#x9055;&#x3046;Network&#x306E;
    &#x30A2;&#x30F3;&#x30B5;&#x30F3;&#x30D6;&#x30EB;&#x52B9;&#x679C;&#x304C;&#x5F97;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3068;&#x3044;&#x3046;&#x8AAC;&#x3082;&#x3042;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoZero_ResidualNetwork.png" alt="png"></p>
<pre class="language-text">ResidualBlock&#x306E;&#x5DE5;&#x592B;
    Bottleneck
        1&#xD7;1Kernel&#x306E;Convolution&#x3092;&#x5229;&#x7528;&#x3057;&#x3001;1&#x5C64;&#x76EE;&#x3067;&#x6B21;&#x5143;&#x524A;&#x9664;&#x3092;&#x884C;&#x3063;&#x3066;
        3&#x5C64;&#x76EE;&#x3067;&#x6B21;&#x5143;&#x3092;&#x5FA9;&#x5143;&#x3059;&#x308B;3&#x5C64;&#x69CB;&#x9020;&#x306B;&#x3057;&#x3001;2&#x5C64;&#x306E;&#x3082;&#x306E;&#x3068;&#x6BD4;&#x3079;&#x3066;
        &#x8A08;&#x7B97;&#x91CF;&#x306F;&#x307B;&#x307C;&#x540C;&#x3058;&#x3060;&#x304C;1&#x5C64;&#x5897;&#x3084;&#x305B;&#x308B;&#x30E1;&#x30EA;&#x30C3;&#x30C8;&#x304C;&#x3042;&#x308B;&#x3001;&#x3068;&#x3057;&#x305F;&#x3082;&#x306E;
    PreActivation
        ResidualBlock&#x306E;&#x4E26;&#x3073;&#x3092;BatchNorm&#x2192;ReLU&#x2192;
        Convolution&#x2192;BatchNorm&#x2192;Relu&#x2192;Convolution&#x2192;Add
        &#x3068;&#x3059;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x6027;&#x80FD;&#x304C;&#x4E0A;&#x6607;&#x3057;&#x305F;&#x3082;&#x306E;&#x3068;&#x3059;&#x308B;

Network&#x69CB;&#x9020;&#x306E;&#x5DE5;&#x592B;
    WideResNet 
        Fonvolution&#x306E;Filter&#x6570;&#x3092;k&#x500D;&#x306B;&#x3057;&#x305F;ResNet&#x3002;
        1&#x500D;&#x2192;k&#x500D;x&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x2192;2*k&#x500D;y&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x3068;&#x6BB5;&#x968E;&#x7684;&#x306B;
        &#x5E45;&#x3092;&#x5897;&#x3084;&#x3057;&#x3066;&#x3044;&#x304F;&#x306E;&#x304C;&#x4E00;&#x822C;&#x7684;&#x3002;
        Filter&#x6570;&#x3092;&#x5897;&#x3084;&#x3059;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x3001;&#x6D45;&#x3044;&#x5C64;&#x3067;&#x3082;&#x6DF1;&#x3044;&#x5C64;&#x6570;&#x3068;
        &#x540C;&#x7B49;&#x4EE5;&#x4E0A;&#x306E;&#x7CBE;&#x5EA6;&#x3068;&#x306A;&#x308A;&#x3001;&#x307E;&#x305F;GPU&#x3092;&#x3088;&#x308A;&#x52B9;&#x7387;&#x7684;&#x306B;
        &#x4F7F;&#x7528;&#x3067;&#x304D;&#x308B;&#x305F;&#x3081;&#x5B66;&#x7FD2;&#x3082;&#x65E9;&#x3044;&#x3002;
    PyramidNet
        WideResNet&#x3067;&#x5E45;&#x304C;&#x5E83;&#x304C;&#x3063;&#x305F;&#x76F4;&#x5F8C;&#x306E;&#x5C64;&#x306B;&#x904E;&#x5EA6;&#x306E;&#x8CA0;&#x62C5;&#x304C;&#x304B;&#x304B;&#x308A;
        &#x7CBE;&#x5EA6;&#x3092;&#x843D;&#x3068;&#x3059;&#x539F;&#x56E0;&#x3068;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3068;&#x3057;&#x3001;
        &#x6BB5;&#x968E;&#x7684;&#x306B;&#x3067;&#x306F;&#x306A;&#x304F;&#x5404;&#x5C64;&#x3067;Filter&#x6570;&#x3092;&#x5897;&#x3084;&#x3057;&#x3066;&#x3044;&#x304F;ResNet&#x3002;

Residual Network&#x306E;&#x6027;&#x80FD;
    &#x4E0B;&#x8A18;&#x8868;&#x306F;ResidualNetwork&#x3092;ImageNet&#x306E;&#x753B;&#x50CF;&#x5206;&#x985E;&#x306B;&#x4F7F;&#x3063;&#x305F;&#x6642;&#x306E;
    &#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x69CB;&#x9020;&#x3001;&#x304A;&#x3088;&#x3073;&#x30A8;&#x30E9;&#x30FC;&#x30EC;&#x30FC;&#x30C8;&#x3067;&#x3042;&#x308B;&#x3002;
    18&#x3001;34Layer&#x306E;&#x3082;&#x306E;&#x306F;&#x57FA;&#x672C;&#x5F62;&#x3001;50&#x3001;101&#x3001;152Layer&#x306E;&#x3082;&#x306E;&#x306F;Bottleneck&#x69CB;&#x9020;&#x3067;&#x3042;&#x308B;&#x3002;
        &#x6027;&#x80FD;&#x306F;&#x5F93;&#x6765;&#x306E;VGG-16&#x3068;&#x6BD4;&#x8F03;&#x3057;&#x3066;Top5&#x3067;4%&#x7A0B;&#x5EA6;&#x3082;&#x30A8;&#x30E9;&#x30FC;&#x7387;&#x306E;&#x4F4E;&#x6E1B;&#x306B;&#x6210;&#x529F;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoZero_ResidualNetwork2.png" alt="png"><br>
<img src="./img/%E6%B7%B1%E5%B1%A4day3_AlphaGoZero_ResidualNetwork3.png" alt="png"></p>
<h3 class="mume-header" id="10-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">10-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">Alpha Go&#x306B;&#x3064;&#x3044;&#x3066;&#x306F;AI&#x754C;&#x9688;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30B9;&#x3067;&#x77E5;&#x3063;&#x3066;&#x3044;&#x305F;&#x7A0B;&#x5EA6;&#x3067;&#x3042;&#x308A;&#x3001;
&#x8A73;&#x3057;&#x3044;&#x5185;&#x5BB9;&#x306F;&#x4ECA;&#x56DE;&#x306E;&#x5B66;&#x7FD2;&#x306B;&#x3088;&#x308A;&#x8A73;&#x3057;&#x304F;&#x77E5;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x305F;&#x3002;
&#x56F2;&#x7881;&#x306E;&#x76E4;&#x9762;&#x3092;&#x4E8C;&#x6B21;&#x5143;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3068;&#x3057;&#x3066;&#x6349;&#x3048;&#x3001;CNN&#x306B;&#x3088;&#x308A;&#x7573;&#x307F;&#x3053;&#x3093;&#x3067;
&#x30D0;&#x30C3;&#x30C1;&#x6B63;&#x898F;&#x5316;&#x3001;ReLU&#x3092;&#x4ECB;&#x3059;&#x69D8;&#x306F;&#x3053;&#x308C;&#x307E;&#x3067;&#x5B66;&#x3093;&#x3060;&#x5185;&#x5BB9;&#x304B;&#x3089;&#x5916;&#x308C;&#x308B;&#x3082;&#x306E;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;
&#x753B;&#x50CF;&#x8A8D;&#x8B58;&#x3067;&#x5229;&#x7528;&#x3055;&#x308C;&#x308B;CNN&#x3092;&#x5FDC;&#x7528;&#x3057;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x304C;&#x4F3A;&#x3048;&#x305F;&#x3002;
&#x307E;&#x305F;&#x3001;Alpha Go Lee&#x3067;&#x7528;&#x3044;&#x3089;&#x308C;&#x305F;&#x30D2;&#x30E5;&#x30FC;&#x30EA;&#x30B9;&#x30C6;&#x30A3;&#x30C3;&#x30AF;&#x306A;&#x60C5;&#x5831;&#x3092;&#x6392;&#x3057;&#x305F;
Alpha Go Zero&#x3067;&#x7CBE;&#x5EA6;&#x304C;&#x3080;&#x3057;&#x308D;&#x5411;&#x4E0A;&#x3057;&#x305F;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x3001;
&#x4EBA;&#x9593;&#x304C;&#x5FC5;&#x8981;&#x3068;&#x5224;&#x65AD;&#x3057;&#x3066;&#x4ED8;&#x52A0;&#x3057;&#x305F;&#x60C5;&#x5831;&#x306F;&#x307B;&#x3068;&#x3093;&#x3069;&#x5BC4;&#x4E0E;&#x3057;&#x3066;&#x3044;&#x306A;&#x3044;&#x3053;&#x3068;&#x304C;
&#x975E;&#x5E38;&#x306B;&#x610F;&#x5916;&#x3060;&#x3063;&#x305F;&#x3002;
</pre>
<h2 class="mume-header" id="11section3%E8%BB%BD%E9%87%8F%E5%8C%96%E9%AB%98%E9%80%9F%E5%8C%96%E6%8A%80%E8%A1%93">11.Section3:&#x8EFD;&#x91CF;&#x5316;&#x30FB;&#x9AD8;&#x901F;&#x5316;&#x6280;&#x8853;</h2>

<pre class="language-text">&#x5206;&#x6563;&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x3068;&#x306F;
    &#x30FB;&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x306F;&#x591A;&#x304F;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x4F7F;&#x7528;&#x3057;&#x305F;&#x308A;&#x3001;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x8ABF;&#x6574;&#x306E;&#x305F;&#x3081;&#x306B;
    &#x3000;&#x591A;&#x304F;&#x306E;&#x6642;&#x9593;&#x3092;&#x4F7F;&#x7528;&#x3057;&#x305F;&#x308A;&#x3059;&#x308B;&#x305F;&#x3081;&#x3001;&#x9AD8;&#x901F;&#x306A;&#x8A08;&#x7B97;&#x304C;&#x6C42;&#x3081;&#x3089;&#x308C;&#x308B;&#x3002;
    &#x30FB;&#x8907;&#x6570;&#x306E;&#x8A08;&#x7B97;&#x8CC7;&#x6E90;(&#x30EF;&#x30FC;&#x30AB;&#x30FC;)&#x3092;&#x4F7F;&#x7528;&#x3057;&#x3001;&#x4E26;&#x5217;&#x7684;&#x306B;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3092;
    &#x3000;&#x69CB;&#x6210;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x3001;&#x52B9;&#x7387;&#x306E;&#x826F;&#x3044;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x3044;&#x305F;&#x3044;&#x3002;
    &#x30FB;&#x30C7;&#x30FC;&#x30BF;&#x4E26;&#x5217;&#x5316;&#x3001;&#x30E2;&#x30C7;&#x30EB;&#x4E26;&#x5217;&#x5316;&#x3001;GPU&#x306B;&#x3088;&#x308B;&#x9AD8;&#x901F;&#x6280;&#x8853;&#x306F;&#x4E0D;&#x53EF;&#x6B20;&#x3067;&#x3042;&#x308B;&#x3002;
    &#x30FB;&#x30B3;&#x30F3;&#x30D4;&#x30E5;&#x30FC;&#x30BF;&#x306E;&#x9032;&#x5316;&#x3088;&#x308A;&#x3082;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x8907;&#x96D1;&#x5316;&#x306E;&#x901F;&#x5EA6;&#x304C;&#x901F;&#x3044;&#x3002;
        &#x30B3;&#x30F3;&#x30D4;&#x30E5;&#x30FC;&#x30BF;&#xFF1A;24&#x30F6;&#x6708;&#x3067;2&#x500D;    
        &#x30E2;&#x30C7;&#x30EB;&#xFF1A;12&#x30F6;&#x6708;&#x3067;10&#x500D;

    &#xFF13;&#xFF0D;&#xFF11;&#xFF0E;&#x30C7;&#x30FC;&#x30BF;&#x4E26;&#x5217;
        &#x30FB;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x8907;&#x6570;&#x306E;&#x30B3;&#x30F3;&#x30D4;&#x30E5;&#x30FC;&#x30BF;&#x3092;&#x6E96;&#x5099;&#x3057;&#x3001;
        &#x3000;&#x89AA;&#x3068;&#x306A;&#x308B;&#x30B3;&#x30F3;&#x30D4;&#x30E5;&#x30FC;&#x30BF;&#x304B;&#x3089;&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x306B;&#x5BFE;&#x3057;&#x3066;
        &#x3000;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x30B3;&#x30D4;&#x30FC;&#x3057;&#x3001;&#x6F14;&#x7B97;&#x5BFE;&#x8C61;&#x306E;&#x5206;&#x5272;&#x3055;&#x308C;&#x305F;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x6E21;&#x3059;&#x3002;
        &#x3000;&#xFF08;&#x5B9A;&#x578B;&#x4F5C;&#x696D;&#x3092;&#x4EBA;&#x6D77;&#x6226;&#x8853;&#x3067;&#x884C;&#x3046;&#x30A4;&#x30E1;&#x30FC;&#x30B8;&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E9%AB%98%E9%80%9F%E5%8C%96_%E3%83%87%E3%83%BC%E3%82%BF%E4%B8%A6%E5%88%97%E5%8C%96.png" alt="png"></p>
<pre class="language-text">        &#x30FB;&#x540C;&#x671F;&#x578B;
            &#x5404;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x306E;&#x8A08;&#x7B97;&#x304C;&#x3059;&#x3079;&#x3066;&#x5B8C;&#x4E86;&#x3059;&#x308B;&#x306E;&#x3092;&#x5F85;&#x3064;&#x3002;
            &#x305D;&#x308C;&#x305E;&#x308C;&#x8A08;&#x7B97;&#x3055;&#x308C;&#x305F;&#x52FE;&#x914D;&#x304B;&#x3089;&#x5E73;&#x5747;&#x3092;&#x8A08;&#x7B97;&#x3057;&#x3001;&#x89AA;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3092;&#x66F4;&#x65B0;&#x3059;&#x308B;&#x3002;
            &#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x66F4;&#x65B0;&#x5F8C;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x306B;&#x518D;&#x5EA6;&#x914D;&#x5E03;&#x3059;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E9%AB%98%E9%80%9F%E5%8C%96_%E3%83%87%E3%83%BC%E3%82%BF%E4%B8%A6%E5%88%97%E5%8C%96_%E5%90%8C%E6%9C%9F%E5%9E%8B.png" alt="png"></p>
<pre class="language-text">        &#x30FB;&#x975E;&#x540C;&#x671F;&#x578B;
            &#x5404;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x306E;&#x8A08;&#x7B97;&#x3092;&#x5F85;&#x305F;&#x305A;&#x306B;&#x3001;&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;&#x5B50;&#x30E2;&#x30C7;&#x30EB;&#x3054;&#x3068;&#x306B;&#x66F4;&#x65B0;&#x3092;&#x884C;&#x3046;&#x3002;
            &#x5B66;&#x7FD2;&#x304C;&#x7D42;&#x308F;&#x3063;&#x305F;&#x5B50;&#x30E2;&#x30C7;&#x30EB;&#x306F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x30B5;&#x30FC;&#x30D0;&#x306B;Push&#x3055;&#x308C;&#x308B;&#x3002;
            &#x65B0;&#x305F;&#x306B;&#x5B66;&#x7FD2;&#x3092;&#x59CB;&#x3081;&#x308B;&#x3068;&#x304D;&#x306F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x30B5;&#x30FC;&#x30D0;&#x304B;&#x3089;Pop&#x3057;&#x305F;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x5B66;&#x7FD2;&#x3057;&#x3066;&#x3044;&#x304F;&#x3002;
            &#x5F85;&#x3061;&#x6642;&#x9593;&#x304C;&#x306A;&#x3044;&#x306E;&#x3067;&#x65E9;&#x3044;&#x304C;&#x3001;&#x6700;&#x65B0;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3092;&#x5229;&#x7528;&#x3067;&#x304D;&#x308B;&#x3068;&#x306F;&#x9650;&#x3089;&#x306A;&#x3044;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E9%AB%98%E9%80%9F%E5%8C%96_%E3%83%87%E3%83%BC%E3%82%BF%E4%B8%A6%E5%88%97%E5%8C%96_%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%9E%8B.png" alt="png"></p>
<pre class="language-text">        &#x540C;&#x671F;&#x578B;&#x3068;&#x975E;&#x540C;&#x671F;&#x578B;&#x306E;&#x6BD4;&#x8F03;
            &#x30FB;&#x51E6;&#x7406;&#x306E;&#x30B9;&#x30D4;&#x30FC;&#x30C9;&#x306F;&#x3001;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x9593;&#x3067;&#x8A08;&#x7B97;&#x3092;&#x5F85;&#x305F;&#x306A;&#x3044;&#x975E;&#x540C;&#x671F;&#x578B;&#x306E;&#x65B9;&#x304C;&#x65E9;&#x3044;&#x3002;
            &#x30FB;&#x975E;&#x540C;&#x671F;&#x578B;&#x306F;&#x6700;&#x65B0;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3092;&#x5229;&#x7528;&#x3067;&#x304D;&#x306A;&#x3044;&#x306E;&#x3067;&#x3001;&#x5B66;&#x7FD2;&#x304C;&#x4E0D;&#x5B89;&#x5B9A;&#x306B;&#x306A;&#x308A;&#x3084;&#x3059;&#x3044;&#x3002;
                -&gt;Stale Gradient Problem
            &#x30FB;&#x73FE;&#x5728;&#x306F;&#x540C;&#x671F;&#x578B;&#x306E;&#x65B9;&#x304C;&#x7CBE;&#x5EA6;&#x304C;&#x826F;&#x3044;&#x3053;&#x3068;&#x304C;&#x591A;&#x3044;&#x306E;&#x3067;&#x3001;&#x4E3B;&#x6D41;&#x3068;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;

    &#xFF13;&#xFF0D;&#xFF12;&#xFF0E;&#x30E2;&#x30C7;&#x30EB;&#x4E26;&#x5217;
        &#x30FB;&#x89AA;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x5404;&#x30EF;&#x30FC;&#x30AB;&#x306B;&#x5206;&#x5272;&#x3057;&#x3001;&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;&#x3002;
        &#x30FB;&#x7E26;&#x65B9;&#x5411;&#x3001;&#x6A2A;&#x65B9;&#x5411;&#x3069;&#x3061;&#x3089;&#x306E;&#x5206;&#x5272;&#x3082;&#x3042;&#x308A;&#x5F97;&#x308B;&#x304C;&#x3001;
        &#x3000;&#x73FE;&#x5728;&#x306F;&#x6A2A;&#x65B9;&#x5411;&#xFF08;&#x5206;&#x5C90;&#x3055;&#x308C;&#x305F;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3054;&#x3068;&#xFF09;&#x306B;
        &#x3000;&#x4E26;&#x5217;&#x5316;&#x3059;&#x308B;&#x65B9;&#x6CD5;&#x304C;&#x4E3B;&#x6D41;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E9%AB%98%E9%80%9F%E5%8C%96_%E3%83%A2%E3%83%87%E3%83%AB%E4%B8%A6%E5%88%97%E5%8C%961.png" alt="png"></p>
<pre class="language-text">    &#xFF13;&#xFF0D;&#xFF13;&#xFF0E;GPU
        &#x30FB;GPGPU(General-purpose on GPU)
            &#x5143;&#x3005;&#x306E;&#x4F7F;&#x7528;&#x76EE;&#x7684;&#x3067;&#x3042;&#x308B;&#x30B0;&#x30E9;&#x30D5;&#x30A3;&#x30C3;&#x30AF;&#x4EE5;&#x5916;&#x306E;&#x7528;&#x9014;&#x3067;&#x4F7F;&#x7528;&#x3055;&#x308C;&#x308B;GPU&#x306E;&#x7DCF;&#x79F0;
            &#x30FB;CUDA&#xFF08;NVIDIA&#x793E;&#x304C;&#x958B;&#x767A;&#xFF09;
                DeepLearing&#x7528;&#x306B;&#x63D0;&#x4F9B;&#x3055;&#x308C;&#x3066;&#x304A;&#x308A;&#x4F7F;&#x3044;&#x3084;&#x3059;&#x3044;&#x3002;
                DeepLearning&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;(Tensorflow,Pytorch)&#x5185;&#x3067;&#x5B9F;&#x88C5;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x306E;&#x3067;&#x3001;
                &#x4F7F;&#x7528;&#x3059;&#x308B;&#x969B;&#x306F;&#x6307;&#x5B9A;&#x3059;&#x308C;&#x3070;&#x3088;&#x3044;&#x3002;

        &#x30FB;CPU
            &#x9AD8;&#x6027;&#x80FD;&#x306A;&#x30B3;&#x30A2;&#x304C;&#x5C11;&#x6570;
            &#x8907;&#x96D1;&#x3067;&#x9023;&#x7D9A;&#x7684;&#x306A;&#x51E6;&#x7406;&#x304C;&#x5F97;&#x610F;
            &#xFF08;&#x5C11;&#x6570;&#x7CBE;&#x92ED;&#x4E3B;&#x7FA9;&#xFF1A;12&#xFF5E;24&#x30F6;&#x6708;&#x9032;&#x5316;&#x306B;&#x304B;&#x304B;&#x308B;&#xFF09;
        &#x30FB;GPU
            &#x6BD4;&#x8F03;&#x7684;&#x4F4E;&#x6027;&#x80FD;&#x306A;&#x30B3;&#x30A2;&#x304C;&#x591A;&#x6570;
            &#x7C21;&#x5358;&#x306A;&#x4E26;&#x5217;&#x51E6;&#x7406;&#x304C;&#x5F97;
            &#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x306E;&#x5B66;&#x7FD2;&#x306B;&#x306F;&#x5358;&#x7D14;&#x306A;&#x884C;&#x5217;&#x8A08;&#x7B97;&#x304C;&#x591A;&#x3044;&#x306E;&#x3067;&#x3001;&#x9AD8;&#x901F;&#x304C;&#x53EF;&#x80FD;&#x3002;
            &#xFF08;&#x51E1;&#x5EB8;&#x306A;&#x4E00;&#x822C;&#x52B4;&#x50CD;&#x8005;&#x3060;&#x304C;&#x3001;&#x52B4;&#x50CD;&#x96C6;&#x7D04;&#x53EF;&#x80FD;&#xFF09;

    &#xFF13;&#xFF0D;&#xFF14;&#xFF0E;&#x91CF;&#x5B50;&#x5316;(Quantization)
        &#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x304C;&#x5927;&#x304D;&#x304F;&#x306A;&#x308B;&#x3068;&#x5927;&#x91CF;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x304C;&#x5FC5;&#x8981;&#x3068;&#x306A;&#x308A;
        &#x5B66;&#x7FD2;&#x3084;&#x63A8;&#x8AD6;&#x306B;&#x591A;&#x304F;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x3068;&#x6F14;&#x7B97;&#x51E6;&#x7406;&#x304C;&#x5FC5;&#x8981;

        &#x901A;&#x5E38;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;64bit&#x6D6E;&#x52D5;&#x5C0F;&#x6570;&#x70B9;&#x3092;32bit&#x306A;&#x3069;
        &#x4E0B;&#x4F4D;&#x306E;&#x7CBE;&#x5EA6;&#x306B;&#x843D;&#x3068;&#x3059;&#x3053;&#x3068;&#x3067;&#x30E1;&#x30E2;&#x30EA;&#x3068;&#x6F14;&#x7B97;&#x51E6;&#x7406;&#x306E;&#x524A;&#x6E1B;&#x3092;&#x884C;&#x3046;&#x3002;
        &#xFF08;&#x30E1;&#x30E2;&#x30EA;&#x3092;&#x591A;&#x304F;&#x4F7F;&#x3046;&#x7406;&#x7531;&#x306F;&#x91CD;&#x307F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x6570;&#x3002;VGG-16&#x3084;BERT)
            &#x4F8B;)0.1563&#x3068;&#x3044;&#x3046;&#x6570;&#x5B57;&#x3092;&#x8868;&#x3059;&#x306E;&#x306B;...
                64bit(&#x500D;&#x7CBE;&#x5EA6;)&#x2192;8byte
                32bit(&#x5358;&#x7CBE;&#x5EA6;)&#x2192;4byte
                16bit(&#x534A;&#x7CBE;&#x5EA6;)&#x2192;2byte
                    &#x2192;&#x534A;&#x5206;&#x306B;&#x306A;&#x308B;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E9%87%8F%E5%AD%90%E5%8C%961.png" alt="png"></p>
<pre class="language-text">        &#x91CF;&#x5B50;&#x5316;&#x306E;&#x5229;&#x70B9;&#x3068;&#x6B20;&#x70B9;
            &#x5229;&#x70B9;
                &#x8A08;&#x7B97;&#x306E;&#x9AD8;&#x901F;&#x5316;
                &#x7701;&#x30E1;&#x30E2;&#x30EA;&#x5316;
            &#x6B20;&#x70B9;
                &#x5C0F;&#x6570;&#x306E;&#x7CBE;&#x5EA6;&#x306E;&#x4F4E;&#x4E0B;

        &#x7CBE;&#x5EA6;&#x306E;&#x4F4E;&#x4E0B;
            16bit(&#x534A;&#x7CBE;&#x5EA6;)&#x3067;&#x5341;&#x5206;&#x306A;&#x3053;&#x3068;&#x304C;&#x591A;&#x3044;

    &#xFF13;&#xFF0D;&#xFF15;&#xFF0E;&#x84B8;&#x7559;
        &#x7CBE;&#x5EA6;&#x306E;&#x9AD8;&#x3044;&#x30E2;&#x30C7;&#x30EB;&#x306F;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306E;&#x898F;&#x6A21;&#x304C;&#x5927;&#x304D;&#x306A;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;
        &#x305D;&#x306E;&#x305F;&#x3081;&#x3001;&#x63A8;&#x8AD6;&#x306B;&#x591A;&#x304F;&#x306E;&#x30E1;&#x30E2;&#x30EA;&#x3068;&#x6F14;&#x7B97;&#x51E6;&#x7406;&#x304C;&#x5FC5;&#x8981;
        &#x2193;
        &#x898F;&#x6A21;&#x306E;&#x5927;&#x304D;&#x306A;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x77E5;&#x8B58;&#x3092;&#x4F7F;&#x3044;&#x8EFD;&#x91CF;&#x306A;
        &#x30E2;&#x30C7;&#x30EB;&#x306E;&#x4F5C;&#x6210;&#x3092;&#x884C;&#x3046;&#x3002;

        &#x30E2;&#x30C7;&#x30EB;&#x306E;&#x7C21;&#x7D04;&#x5316;
            &#x5B66;&#x7FD2;&#x6E08;&#x307F;&#x306E;&#x7CBE;&#x5EA6;&#x306E;&#x9AD8;&#x3044;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x77E5;&#x8B58;&#x3092;&#x8EFD;&#x91CF;&#x306A;&#x30E2;&#x30C7;&#x30EB;&#x3078;&#x7D99;&#x627F;&#x3055;&#x305B;&#x308B;&#x3002;

            &#x77E5;&#x8B58;&#x306E;&#x7D99;&#x627F;&#x306B;&#x3088;&#x308A;&#x3001;&#x8EFD;&#x91CF;&#x3067;&#x3042;&#x308A;&#x306A;&#x304C;&#x3089;&#x8907;&#x96D1;&#x306A;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x5339;&#x6575;&#x3059;&#x308B;
            &#x7CBE;&#x5EA6;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x5F97;&#x308B;&#x3053;&#x3068;&#x304C;&#x671F;&#x5F85;&#x3067;&#x304D;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E8%92%B8%E7%95%991.png" alt="png"></p>
<pre class="language-text">&#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;&#x3068;&#x751F;&#x5F92;&#x30E2;&#x30C7;&#x30EB;
    &#x84B8;&#x7559;&#x306F;&#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;&#x3068;&#x751F;&#x5F92;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#xFF12;&#x3064;&#x3067;&#x69CB;&#x6210;&#x3055;&#x308C;&#x308B;
        &#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;
            &#x4E88;&#x6E2C;&#x7CBE;&#x5EA6;&#x306E;&#x9AD8;&#x3044;&#x3001;&#x8907;&#x96D1;&#x306A;&#x30E2;&#x30C7;&#x30EB;&#x3084;&#x30A2;&#x30F3;&#x30B5;&#x30F3;&#x30D6;&#x30EB;&#x3055;&#x308C;&#x305F;&#x30E2;&#x30C7;&#x30EB;

        &#x751F;&#x5F92;&#x30E2;&#x30C7;&#x30EB;
            &#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x57FA;&#x306B;&#x4F5C;&#x3089;&#x308C;&#x308B;&#x8EFD;&#x91CF;&#x306A;&#x30E2;&#x30C7;&#x30EB;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E8%92%B8%E7%95%992.png" alt="png"></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E8%92%B8%E7%95%993.png" alt="png"></p>
<pre class="language-text">    &#xFF13;&#xFF0D;&#xFF16;&#xFF0E;&#x30D7;&#x30EB;&#x30FC;&#x30CB;&#x30F3;&#x30B0;
        &#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x304C;&#x5927;&#x304D;&#x304F;&#x306A;&#x308B;&#x3068;&#x5927;&#x91CF;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3068;&#x306A;&#x308B;&#x304C;
        &#x5168;&#x3066;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306E;&#x8A08;&#x7B97;&#x304C;&#x5236;&#x5EA6;&#x306B;&#x5BC4;&#x4E0E;&#x3057;&#x3066;&#x3044;&#x308B;&#x308F;&#x3051;&#x3067;&#x306F;&#x306A;&#x3044;&#x3002;
        &#x2193;
        &#x30E2;&#x30C7;&#x30EB;&#x306E;&#x7CBE;&#x5EA6;&#x306B;&#x5BC4;&#x4E0E;&#x304C;&#x5C11;&#x306A;&#x3044;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x3092;&#x524A;&#x6E1B;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;
        &#x30E2;&#x30C7;&#x30EB;&#x306E;&#x8EFD;&#x91CF;&#x5316;&#x30FB;&#x9AD8;&#x901F;&#x5316;&#x304C;&#x898B;&#x8FBC;&#x307E;&#x308C;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E3%83%97%E3%83%AB%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B01.png" alt="png"></p>
<pre class="language-text">        &#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306E;&#x524A;&#x6E1B;
            &#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306E;&#x524A;&#x6E1B;&#x306E;&#x624B;&#x6CD5;&#x306F;&#x91CD;&#x307F;&#x304C;&#x95BE;&#x5024;&#x4EE5;&#x4E0B;&#x306E;&#x5834;&#x5408;
            &#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x3092;&#x524A;&#x6E1B;&#x3057;&#x518D;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x3046;&#x3002;
            &#x4E0B;&#x8A18;&#x306E;&#x4F8B;&#x306F;&#x91CD;&#x307F;&#x304C;0.1&#x4EE5;&#x4E0B;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x3092;&#x524A;&#x6E1B;&#x3057;&#x305F;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E3%83%97%E3%83%AB%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B02.png" alt="png"></p>
<pre class="language-text">        &#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x6570;&#x3068;&#x7CBE;&#x5EA6;
            &#x4E0B;&#x8A18;&#x306E;&#x8868;&#x306F;Oxford 102 category ower dataset&#x3092;
            CafeNet&#x3067;&#x5B66;&#x7FD2;&#x3057;&#x305F;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x30D7;&#x30EB;&#x30FC;&#x30CB;&#x30F3;&#x30B0;&#x306E;&#x95BE;&#x5024;&#x306B;&#x3088;&#x308B;
            &#x5404;&#x5C64;&#x3068;&#x5168;&#x4F53;&#x306E;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306E;&#x524A;&#x6E1B;&#x7387;&#x3068;&#x7CBE;&#x5EA6;&#x3092;&#x307E;&#x3068;&#x3081;&#x305F;
            &#x3082;&#x306E;&#x306B;&#x306A;&#x308B;&#x3002;
            &#x3B1;&#x306F;&#x95BE;&#x5024;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x3001;&#x95BE;&#x5024;&#x306F;&#x5404;&#x5C64;&#x306E;&#x6A19;&#x6E96;&#x504F;&#x5DEE;&#x3C3;&#x3068;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x7A4D;
            &#x95BE;&#x5024;&#x3092;&#x9AD8;&#x304F;&#x3059;&#x308B;&#x3068;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x306F;&#x5927;&#x304D;&#x304F;&#x524A;&#x6E1B;&#x3067;&#x304D;&#x308B;&#x304C;&#x7CBE;&#x5EA6;&#x3082;&#x6E1B;&#x5C11;&#x3059;&#x308B;
            &#xFF08;&#x305F;&#x3060;&#x3057;&#x3001;&#x305D;&#x3053;&#x307E;&#x3067;&#x81F4;&#x547D;&#x7684;&#x306A;&#x7CBE;&#x5EA6;&#x306E;&#x6E1B;&#x5C11;&#x3067;&#x306F;&#x306A;&#x3044;&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day3_%E8%BB%BD%E9%87%8F%E5%8C%96_%E3%83%97%E3%83%AB%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B03.png" alt="png"></p>
<pre class="language-text">&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x8EFD;&#x91CF;&#x5316;&#x306E;&#x307E;&#x3068;&#x3081;
    &#x91CF;&#x5B50;&#x5316;&#xFF1A;&#x91CD;&#x307F;&#x306E;&#x7CBE;&#x5EA6;&#x3092;&#x4E0B;&#x3052;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;&#x8A08;&#x7B97;&#x306E;&#x9AD8;&#x901F;&#x5316;&#x3068;&#x7701;&#x30E1;&#x30E2;&#x30EA;&#x5316;&#x3092;&#x884C;&#x3046;&#x6280;&#x8853;

    &#x84B8;&#x7559;&#xFF1A;&#x8907;&#x96D1;&#x3067;&#x7CBE;&#x5EA6;&#x306E;&#x826F;&#x3044;&#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;&#x304B;&#x3089;&#x8EFD;&#x91CF;&#x306A;&#x751F;&#x5F92;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x52B9;&#x7387;&#x3088;&#x304F;&#x5B66;&#x7FD2;&#x3092;&#x884C;&#x3046;&#x6280;&#x8853;

    &#x30D7;&#x30EB;&#x30FC;&#x30CB;&#x30F3;&#x30B0;&#xFF1A;&#x5BC4;&#x4E0E;&#x306E;&#x5C11;&#x306A;&#x3044;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x3092;&#x30E2;&#x30C7;&#x30EB;&#x304B;&#x3089;&#x524A;&#x9664;&#x3057;&#x8A08;&#x7B97;&#x306E;&#x9AD8;&#x901F;&#x5316;&#x3068;&#x7701;&#x30E1;&#x30E2;&#x30EA;&#x5316;&#x3092;&#x884C;&#x3046;&#x6280;&#x8853;
</pre>
<h3 class="mume-header" id="11-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">11-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x5B66;&#x7FD2;&#x30FB;&#x63A8;&#x8AD6;&#x306B;&#x3088;&#x308A;&#x6D3B;&#x7528;&#x3057;&#x3066;&#x3044;&#x304F;&#x3046;&#x3048;&#x3067;
&#x5B9F;&#x7528;&#x4E0A;&#x907F;&#x3051;&#x3066;&#x901A;&#x308C;&#x306A;&#x3044;&#x554F;&#x984C;&#x304C;&#x51E6;&#x7406;&#x901F;&#x5EA6;&#x3067;&#x3042;&#x308B;&#x304C;&#x3001;
&#x65E2;&#x306B;&#x8EFD;&#x91CF;&#x5316;&#x30FB;&#x9AD8;&#x901F;&#x5316;&#x306E;&#x624B;&#x6CD5;&#x304C;&#x78BA;&#x7ACB;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
&#x5206;&#x6563;&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x306A;&#x3069;&#x306F;&#x8907;&#x6570;&#x306E;&#x30EF;&#x30FC;&#x30AB;&#x30FC;&#x3067;&#x30E2;&#x30C7;&#x30EB;&#x3084;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x5206;&#x5272;&#x3057;&#x3066;
&#x4E26;&#x5217;&#x3067;&#x9032;&#x3081;&#x308B;&#x624B;&#x6CD5;&#x3067;&#x3042;&#x308A;&#x3001;Apache Spark&#x306A;&#x3069;&#x3067;&#x5B9F;&#x73FE;&#x53EF;&#x80FD;&#x3067;&#x3042;&#x308B;&#x3002;
&#x307E;&#x305F;&#x3001;GPU&#x3092;&#x6D3B;&#x7528;&#x3059;&#x308B;&#x3053;&#x3068;&#x306B;&#x3088;&#x308A;CPU&#x4EE5;&#x4E0A;&#x306E;&#x9AD8;&#x901F;&#x5316;&#x3082;&#x56F3;&#x308C;&#x308B;&#x3002;
&#x91CF;&#x5B50;&#x5316;&#x306F;&#x91CD;&#x307F;&#x306E;&#x7CBE;&#x5EA6;&#x3092;&#x8A31;&#x5BB9;&#x7BC4;&#x56F2;&#x5185;&#x307E;&#x3067;&#x843D;&#x3068;&#x3057;&#x3066;&#x91CD;&#x307F;&#x306E;&#x8A18;&#x61B6;&#x91CF;&#x3092;&#x6291;&#x3048;&#x308B;&#x3053;&#x3068;
&#x306B;&#x3088;&#x308A;&#x7701;&#x30E1;&#x30E2;&#x30EA;&#x5316;&#x304A;&#x3088;&#x3073;&#x8A08;&#x7B97;&#x306E;&#x9AD8;&#x901F;&#x5316;&#x304C;&#x671F;&#x5F85;&#x3067;&#x304D;&#x308B;&#x3002;
&#x84B8;&#x7559;&#x306F;&#x512A;&#x308C;&#x305F;&#x6559;&#x5E2B;&#x30E2;&#x30C7;&#x30EB;&#x304B;&#x3089;&#x3088;&#x308A;&#x8EFD;&#x91CF;&#x5316;&#x3055;&#x308C;&#x305F;&#x751F;&#x5F92;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x69CB;&#x7BC9;&#x3057;&#x3001;
&#x52B9;&#x7387;&#x3088;&#x304F;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;&#x65B9;&#x6CD5;&#x3067;&#x3001;
&#x4ED6;&#x306B;&#x3082;&#x30D7;&#x30EB;&#x30FC;&#x30CB;&#x30F3;&#x30B0;&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x5BC4;&#x4E0E;&#x7387;&#x306E;&#x5C11;&#x306A;&#x3044;&#x30CB;&#x30E5;&#x30FC;&#x30ED;&#x30F3;&#x3092;&#x30E2;&#x30C7;&#x30EB;&#x304B;&#x3089;
&#x524A;&#x9664;&#x3059;&#x308B;&#x306E;&#x3082;&#x52B9;&#x679C;&#x304C;&#x9AD8;&#x3044;&#x3002;
&#x30D7;&#x30EB;&#x30FC;&#x30CB;&#x30F3;&#x30B0;&#x306F;&#x6B21;&#x5143;&#x524A;&#x9664;&#x306E;&#x30A2;&#x30D7;&#x30ED;&#x30FC;&#x30C1;&#x306B;&#x8FD1;&#x3044;&#x3068;&#x8003;&#x3048;&#x3089;&#x308C;&#x308B;&#x3002;
</pre>
<h2 class="mume-header" id="12section4%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB">12.Section4:&#x5FDC;&#x7528;&#x30E2;&#x30C7;&#x30EB;</h2>

<pre class="language-text">&#x30FB;MobileNets&#xFF1A;Efficient Convolutional Neural Networks for Mobile Vision Applications
    &#x753B;&#x50CF;&#x8A8D;&#x8B58;&#x30E2;&#x30C7;&#x30EB;&#x306F;2017&#x5E74;&#x3054;&#x308D;&#x306B;&#x5B8C;&#x6210;
    &#x30C7;&#x30A3;&#x30FC;&#x30D7;&#x30E9;&#x30FC;&#x30CB;&#x30F3;&#x30B0;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x8EFD;&#x91CF;&#x5316;&#x30FB;&#x9AD8;&#x901F;&#x5316;&#x30FB;&#x9AD8;&#x7CBE;&#x5EA6;&#x5316;&#x3092;&#x5B9F;&#x73FE;
    Depthwise Convolution&#x3068;Pointwise COnvolution&#x306E;
    &#x7D44;&#x307F;&#x5408;&#x308F;&#x305B;&#x3067;&#x8EFD;&#x91CF;&#x5316;&#x3092;&#x5B9F;&#x73FE;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_MobileNet1.png" alt="png"><br>
<img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_MobileNet2.png" alt="png"></p>
<pre class="language-text">Depthwise Convolution
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_MobileNet3.png" alt="png"></p>
<pre class="language-text">Pointwise COnvolution
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_MobileNet4.png" alt="png"></p>
<pre class="language-text">    MobileNet&#x306E;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;
        Depthwise Separatable Convolution &#x3068;&#x3044;&#x3046;&#x624B;&#x6CD5;&#x3092;&#x7528;&#x3044;&#x3066;&#x8A08;&#x7B97;&#x91CF;&#x3092;&#x524A;&#x6E1B;&#x3057;&#x3066;&#x3044;&#x308B;&#x3002;
        &#x901A;&#x5E38;&#x306E;&#x7573;&#x307F;&#x8FBC;&#x307F;&#x304C;&#x7A7A;&#x9593;&#x65B9;&#x5411;&#x3068;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x65B9;&#x5411;&#x306E;&#x8A08;&#x7B97;&#x3092;&#x540C;&#x6642;&#x306B;&#x884C;&#x3046;&#x306E;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x3001;
        Depthwise Separatable Convolution&#x3067;&#x306F;&#x305D;&#x308C;&#x3089;&#x3092;Depthwise Convolution&#x3068;
        Pointwise Convolution&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x6F14;&#x7B97;&#x306B;&#x3088;&#x3063;&#x3066;&#x500B;&#x5225;&#x306B;&#x884C;&#x3046;&#x3002; 

        Depthwise Convolution&#x306F;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6BCE;&#x306B;&#x7A7A;&#x9593;&#x65B9;&#x5411;&#x3078;&#x7573;&#x307F;&#x3053;&#x3080;&#x3002;&#x3059;&#x306A;&#x308F;&#x3061;&#x3001;
        &#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6BCE;&#x306B;D_k&#xD7;D_k&#xD7;1&#x306E;&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x30D5;&#x30A3;&#x30EB;&#x30BF;&#x30FC;&#x3092;&#x305D;&#x308C;&#x305E;&#x308C;&#x7528;&#x3044;&#x3066;&#x8A08;&#x7B97;&#x3092;&#x884C;&#x3046;&#x305F;&#x3081;&#x3001;
        &#x305D;&#x306E;&#x8A08;&#x7B97;&#x91CF;&#x306F;&#xFF08;H&#xD7;W&#xD7;K&#xD7;K&#xD7;C&#xD7;1&#xFF09;&#x3068;&#x306A;&#x308B;&#x3002;
        &#x203B;&#x30D5;&#x30A3;&#x30EB;&#x30BF;&#x30FC;&#x6570;M&#x306F;1

        &#x6B21;&#x306B;Depthwise Convolution&#x306E;&#x51FA;&#x529B;&#x3092;Pointwise Convolution&#x306B;&#x3088;&#x3063;&#x3066;
        &#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x65B9;&#x5411;&#x306B;&#x7573;&#x307F;&#x3053;&#x3080;&#x3002;
        &#x3059;&#x306A;&#x308F;&#x3061;&#x3001;&#x51FA;&#x529B;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6BCE;&#x306B;1&#xD7;1&#xD7;M&#x30B5;&#x30A4;&#x30BA;&#x306E;&#x30D5;&#x30A3;&#x30EB;&#x30BF;&#x30FC;&#x3092;&#x305D;&#x308C;&#x305E;&#x308C;&#x7528;&#x3044;&#x3066;
        &#x8A08;&#x7B97;&#x3092;&#x884C;&#x3046;&#x305F;&#x3081;&#x3001;&#x305D;&#x306E;&#x8A08;&#x7B97;&#x91CF;&#x306F;&#xFF08;H&#xD7;W&#xD7;1&#xD7;1&#xD7;C&#xD7;M&#xFF09;
        &#x203B;&#x30AB;&#x30FC;&#x30CD;&#x30EB;&#x306E;&#x30B5;&#x30A4;&#x30BA;K&#x306F;1
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_MobileNet5.png" alt="png"></p>
<pre class="language-text">&#x30FB;DenseNet(&#x753B;&#x50CF;&#x8A8D;&#x8B58;&#x30E2;&#x30C7;&#x30EB;)
    Dense Convolution Network(&#x4EE5;&#x4E0B;DenseNet)&#x306F;&#x7573;&#x307F;&#x8FBC;&#x307F;
    &#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#xFF08;&#x4EE5;&#x4E0B;&#x3001;CNN&#xFF09;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x306E;&#x4E00;&#x7A2E;&#x3067;&#x3042;&#x308B;&#x3002;
    &#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3067;&#x306F;&#x5C64;&#x304C;&#x6DF1;&#x304F;&#x306A;&#x308B;&#x306B;&#x9023;&#x308C;&#x3066;&#x3001;&#x5B66;&#x7FD2;&#x304C;
    &#x96E3;&#x3057;&#x304F;&#x306A;&#x308B;&#x3068;&#x3044;&#x3046;&#x554F;&#x984C;&#x304C;&#x3042;&#x3063;&#x305F;&#x304C;&#x3001;Residual Network&#xFF08;&#x4EE5;&#x4E0B;&#x3001;ResNet&#xFF09;
    &#x306A;&#x3069;&#x306E;CNN&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x3067;&#x306F;&#x524D;&#x65B9;&#x306E;&#x5C64;&#x304B;&#x3089;&#x5F8C;&#x65B9;&#x306E;&#x5C64;&#x3078;&#x30A2;&#x30A4;&#x30C7;&#x30F3;&#x30C6;&#x30A3;&#x30C6;&#x30A3;
    &#x63A5;&#x7D9A;&#x3092;&#x4ECB;&#x3057;&#x3066;&#x30D1;&#x30B9;&#x3092;&#x4F5C;&#x308B;&#x3053;&#x3068;&#x3067;&#x554F;&#x984C;&#x3092;&#x5BFE;&#x51E6;&#x3057;&#x305F;&#x3002;
    DenseBlock&#x3068;&#x3088;&#x3070;&#x308C;&#x308B;&#x30E2;&#x30B8;&#x30E5;&#x30FC;&#x30EB;&#x3092;&#x7528;&#x3044;&#x305F;&#x3001;DenseNet&#x3082;
    &#x305D;&#x306E;&#x3088;&#x3046;&#x306A;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x306E;&#xFF11;&#x3064;&#x3067;&#x3042;&#x308B;&#x3002;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_DenseNet1.png" alt="png"></p>
<pre class="language-text">DenseBlock&#x306E;&#x4E2D;&#x3067;&#x306F;&#x5C11;&#x3057;&#x305A;&#x3064;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x304C;&#x5897;&#x52A0;&#x3059;&#x308B;&#x3002;
&#x30EC;&#x30A4;&#x30E4;&#x30FC;&#x3092;1&#x3064;&#x305A;&#x3064;&#x901A;&#x904E;&#x3059;&#x308B;&#x3054;&#x3068;&#x306B;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x304C;&#x8FFD;&#x52A0;&#x3055;&#x308C;&#x308B;&#x3002;
&#xFF08;Skip Connection&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_DenseNet2.png" alt="png"></p>
<pre class="language-text">&#x524D;&#x30B9;&#x30E9;&#x30A4;&#x30C9;&#x3067;&#x8A08;&#x7B97;&#x3057;&#x305F;&#x51FA;&#x529B;&#x306B;&#x5165;&#x529B;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x3092;&#x4ED8;&#x3051;&#x52A0;&#x3048;&#x308B;&#x3002;
&#x5165;&#x529B;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x306E;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6570;&#x304C;l&#xD7;k&#x306E;&#x5834;&#x5408;&#x3001;&#x51FA;&#x529B;&#x306F;(l+1)&#xD7;k&#x3068;&#x306A;&#x308B;&#x3002;
</pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x7B2C;</mtext><mi>l</mi><mtext>&#x5C64;&#x306E;&#x51FA;&#x529B;&#x3092;</mtext><msub><mi>x</mi><mi>l</mi></msub><mtext>&#x3068;&#x3059;&#x308B;&#x3068;</mtext><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">&#x7B2C;l&#x5C64;&#x306E;&#x51FA;&#x529B;&#x3092;x_l&#x3068;&#x3059;&#x308B;&#x3068;...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">&#x7B2C;</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord cjk_fallback">&#x5C64;&#x306E;&#x51FA;&#x529B;&#x3092;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">&#x3068;&#x3059;&#x308B;&#x3068;</span><span class="mord">...</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>l</mi></msub><mo>=</mo><msub><mi>H</mi><mi>l</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x22EF;</mo><mtext>&#x2009;</mtext><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>l</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_l=H_l([x_0,x_1,\cdots,x_{l-1}])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">&#x22EF;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">])</span></span></span></span></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_DenseNet3.png" alt="png"></p>
<pre class="language-text">k&#x3092;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;growth rate&#x3068;&#x547C;&#x3076;
    k&#x304C;&#x5927;&#x304D;&#x304F;&#x306A;&#x308B;&#x307B;&#x3069;&#x3001;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x304C;&#x5927;&#x304D;&#x304F;&#x306A;&#x308B;&#x305F;&#x3081;&#x3001;
    &#x5C0F;&#x3055;&#x306A;&#x6574;&#x6570;&#x306B;&#x8A2D;&#x5B9A;&#x3059;&#x308B;&#x306E;&#x304C;&#x3088;&#x3044;
</pre>
<table>
<thead>
<tr>
<th style="text-align:left">&#x5165;&#x529B;</th>
<th style="text-align:left">&#x51FA;&#x529B;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">k_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k_0+k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><mn>2</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">k_0+2k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><mn>3</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">k_0+3k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
</tr>
<tr>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>0</mn></msub><mo>+</mo><mn>4</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">k_0+4k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span></td>
</tr>
</tbody>
</table>
<pre class="language-text">Transition Layer
    &#x30FB;CNN&#x3067;&#x306F;&#x4E2D;&#x9593;&#x5C64;&#x3067;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x30B5;&#x30A4;&#x30BA;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x3002;
    &#x30FB;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x306E;&#x30B5;&#x30A4;&#x30BA;&#x3092;&#x5909;&#x66F4;&#x3057;&#x3001;&#x30C0;&#x30A6;&#x30F3;&#x30B5;&#x30F3;&#x30D7;&#x30EA;&#x30F3;&#x30B0;&#x3092;&#x884C;&#x3046;&#x305F;&#x3081;&#x3001;
    &#x3000;Transition Layer&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x5C64;&#x3067;Dense Block&#x3092;&#x3064;&#x306A;&#x3050;&#x3002;
    &#x3000;&#x3053;&#x308C;&#x306B;&#x3088;&#x308A;&#x5404;&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x3067;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x306E;&#x30B5;&#x30A4;&#x30BA;&#x306F;&#x540C;&#x4E00;&#x3068;&#x306A;&#x308B;&#x3002;

DenseNet&#x3068;ResNet&#x306E;&#x9055;&#x3044;
    DenseNet&#x306F;&#x524D;&#x65B9;&#x306E;&#x5404;&#x5C64;&#x304B;&#x3089;&#x306E;&#x51FA;&#x529B;&#x5168;&#x3066;&#x304C;&#x5F8C;&#x65B9;&#x306E;&#x5C64;&#x3078;&#x306E;&#x5165;&#x529B;&#x3068;&#x3057;&#x3066;&#x7528;&#x3044;&#x3089;&#x308C;&#x308B;&#x3002;
    ResNet&#x306F;&#x76F4;&#x524D;&#x306E;&#x5C64;&#x306E;&#x5165;&#x529B;&#x306E;&#x307F;&#x5F8C;&#x65B9;&#x306E;&#x5C64;&#x3078;&#x5165;&#x529B;

    DenseBlock&#x306B;&#x306F;&#x6210;&#x9577;&#x7387;(Growth Rate)&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x30CF;&#x30A4;&#x30D1;&#x30FC;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x3002;
    DenseBlock&#x5185;&#x306E;&#x5404;&#x30D6;&#x30ED;&#x30C3;&#x30AF;&#x3054;&#x3068;&#x306B;k&#x500B;&#x305A;&#x3064;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x306E;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6570;&#x304C;
    &#x5897;&#x52A0;&#x3057;&#x3066;&#x3044;&#x304F;&#x3068;&#x304D;&#x3001;k&#x3092;&#x6210;&#x9577;&#x7387;&#x3068;&#x547C;&#x3076;&#x3002;


BatchNorm(&#x30D0;&#x30C3;&#x30C1;&#x6B63;&#x898F;&#x5316;)
    &#x30FB;&#x30EC;&#x30A4;&#x30E4;&#x30FC;&#x9593;&#x3092;&#x6D41;&#x308C;&#x308B;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x5206;&#x5E03;&#x3092;&#x3001;&#x30DF;&#x30CB;&#x30D0;&#x30C3;&#x30C1;&#x5358;&#x4F4D;&#x3067;
    &#x3000;&#x5E73;&#x5747;&#x304C;&#xFF10;&#x3001;&#x5206;&#x6563;&#x304C;&#xFF11;&#x3068;&#x306A;&#x308B;&#x3088;&#x3046;&#x306B;&#x6B63;&#x898F;&#x5316;
    &#x30FB;Batch Normalization&#x306F;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306B;&#x304A;&#x3044;&#x3066;
    &#x3000;&#x5B66;&#x7FD2;&#x6642;&#x9593;&#x306E;&#x77ED;&#x7E2E;&#x3084;&#x521D;&#x671F;&#x5024;&#x3078;&#x306E;&#x4F9D;&#x5B58;&#x4F4E;&#x6E1B;&#x3001;&#x904E;&#x5B66;&#x7FD2;&#x306E;&#x6291;&#x5236;&#x306A;&#x3069;&#x306E;&#x52B9;&#x679C;&#x304C;&#x3042;&#x308B;&#x3002;
    &#x30FB;Batch Size&#x304C;&#x5C0F;&#x3055;&#x3044;&#x6761;&#x4EF6;&#x4E0B;&#x3067;&#x306F;&#x3001;&#x5B66;&#x7FD2;&#x304C;&#x53CE;&#x675F;&#x3057;&#x306A;&#x3044;&#x3053;&#x3068;&#x304C;&#x3042;&#x308A;&#x3001;
    &#x3000;&#x4EE3;&#x308F;&#x308A;&#x306B;Layer Normalization&#x306A;&#x3069;&#x306E;&#x6B63;&#x898F;&#x5316;&#x624B;&#x6CD5;&#x304C;&#x4F7F;&#x308F;&#x308C;&#x308B;
    &#x3000;&#x3053;&#x3068;&#x304C;&#x591A;&#x3044;
        (CPU&#x3001;GPU&#x306A;&#x3069;&#x74B0;&#x5883;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30B5;&#x30A4;&#x30BA;&#x3092;&#x5909;&#x66F4;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;)
    &#x30FB;H&#xD7;W&#xD7;C&#x306E;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x304C;N&#x500B;&#x3042;&#x3063;&#x305F;&#x5834;&#x5408;&#x306B;&#x3001;N&#x500B;&#x306E;&#x540C;&#x4E00;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x304C;&#x6B63;&#x898F;&#x5316;&#x306E;&#x5358;&#x4F4D;
    &#x3000;RGB&#x306E;3&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x306E;sample&#x304C;N&#x500B;&#x306E;&#x5834;&#x5408;&#x306F;&#x3001;&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x306E;&#x5E73;&#x5747;&#x3068;&#x5206;&#x6563;&#x3092;
    &#x3000;&#x6C42;&#x3081;&#x6B63;&#x898F;&#x5316;&#x3092;&#x5B9F;&#x65BD;&#x3002;
    &#x3000;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x3054;&#x3068;&#x306B;&#x6B63;&#x898F;&#x5316;&#x3055;&#x308C;&#x305F;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x3092;&#x51FA;&#x529B;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_BatchNorm1.png" alt="png"></p>
<pre class="language-text">Layer Norm
    &#x30FB;&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;sample&#x306E;&#x3059;&#x3079;&#x3066;&#x306E;pixels&#x304C;&#x540C;&#x4E00;&#x5206;&#x5E03;&#x306B;&#x5F93;&#x3046;&#x3088;&#x3046;&#x6B63;&#x898F;&#x5316;
    &#x30FB;N&#x500B;&#x306E;sample&#x306E;&#x3046;&#x3061;&#xFF11;&#x3064;&#x306B;&#x6CE8;&#x76EE;&#x3002;H&#xD7;W&#xD7;C&#x306E;&#x5168;&#x3066;&#x306E;pixel&#x304C;&#x6B63;&#x898F;&#x5316;&#x306E;&#x5358;&#x4F4D; (&#x30C1;&#x30E3;&#x30F3;&#x30CD;&#x30EB;&#x306E;&#x9055;&#x3044;&#x306F;&#x7121;&#x8996;)
    &#x30FB;RGB&#x306E;3&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x306E;sample&#x304C;N&#x500B;&#x306E;&#x5834;&#x5408;&#x306F;&#x3001;&#x3042;&#x308B;sample&#x3092;&#x53D6;&#x308A;&#x51FA;&#x3057;&#x3066;
    &#x3000;&#x5168;&#x3066;&#x306E;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x306E;&#x5E73;&#x5747;&#x3068;&#x5206;&#x6563;&#x3092;&#x6C42;&#x3081;&#x6B63;&#x898F;&#x5316;&#x3092;&#x5B9F;&#x65BD;&#x3002;
    &#x3000;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x6BCE;&#x306B;&#x6B63;&#x898F;&#x5316;&#x3055;&#x308C;&#x305F;&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x3092;&#x51FA;&#x529B;&#x3002;
    &#x30FB;&#x30DF;&#x30CB;&#x30D0;&#x30C3;&#x30C1;&#x306E;&#x6570;&#x306B;&#x4F9D;&#x5B58;&#x3057;&#x306A;&#x3044;&#x306E;&#x3067;&#x3001;&#x4E0A;&#x8A18;&#x306E;&#x554F;&#x984C;&#x3092;&#x89E3;&#x6D88;&#x3067;&#x304D;&#x3066;&#x3044;&#x308B;&#x3068;&#x8003;&#x3048;&#x3089;&#x308C;&#x308B;&#x3002;
    &#x30FB;&#x5165;&#x529B;&#x30C7;&#x30FC;&#x30BF;&#x3084;&#x91CD;&#x307F;&#x884C;&#x5217;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x3001;&#x4EE5;&#x4E0B;&#x306E;&#x64CD;&#x4F5C;&#x3092;&#x65BD;&#x3057;&#x3066;&#x3082;&#x3001;
    &#x3000;&#x51FA;&#x529B;&#x304C;&#x5909;&#x308F;&#x3089;&#x306A;&#x3044;&#x3053;&#x3068;&#x304C;&#x77E5;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
    &#x3000;&#x30FB;&#x5165;&#x529B;&#x30C7;&#x30FC;&#x30BF;&#x306E;&#x30B9;&#x30B1;&#x30FC;&#x30EB;&#x306B;&#x95A2;&#x3057;&#x3066;Robust&#xFF08;&#x5805;&#x7262;&#xFF09;
    &#x3000;&#x30FB;&#x91CD;&#x307F;&#x884C;&#x5217;&#x306E;&#x30B9;&#x30B1;&#x30FC;&#x30EB;&#x3084;&#x30B7;&#x30D5;&#x30C8;&#x306B;&#x95A2;&#x3057;&#x3066;Robust&#xFF08;&#x5805;&#x7262;&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_LayerNorm1.png" alt="png"></p>
<pre class="language-text">InstanceNorm
    &#x30FB;&#x5404;sample&#x306E;&#x5404;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x3054;&#x3068;&#x306B;&#x6B63;&#x898F;&#x5316;
        &#x2192;BatchNormalization&#x306E;&#x30D0;&#x30C3;&#x30C1;&#x30B5;&#x30A4;&#x30BA;&#x304C;1&#x306E;&#x5834;&#x5408;&#x3068;&#x7B49;&#x4FA1;
    &#x30FB;&#x30B3;&#x30F3;&#x30C8;&#x30E9;&#x30B9;&#x30C8;&#x306E;&#x6B63;&#x898F;&#x5316;&#x306B;&#x5BC4;&#x4E0E;&#x30FB;&#x753B;&#x50CF;&#x306E;&#x30B9;&#x30BF;&#x30A4;&#x30EB;&#x8EE2;&#x9001;&#x3084;&#x30C6;&#x30AF;&#x30B9;&#x30C1;&#x30E3;&#x5408;&#x6210;&#x30BF;&#x30B9;&#x30AF;&#x306A;&#x3069;&#x3067;&#x5229;&#x7528;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_InstanceNorm1.png" alt="png"></p>
<pre class="language-text">WaveNet&#xFF08;&#x97F3;&#x58F0;&#x751F;&#x6210;&#x30E2;&#x30C7;&#x30EB;&#xFF09;
    &#x30FB;&#x751F;&#x306E;&#x97F3;&#x58F0;&#x6CE2;&#x5F62;&#x3092;&#x751F;&#x6210;&#x3059;&#x308B;&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x30E2;&#x30C7;&#x30EB;
    &#x30FB;Pixel CNN&#x3092;&#x97F3;&#x58F0;&#x306B;&#x5FDC;&#x7528;&#x3057;&#x305F;&#x3082;&#x306E;
    &#x30FB;&#x6642;&#x7CFB;&#x5217;&#x30C7;&#x30FC;&#x30BF;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x7573;&#x307F;&#x8FBC;&#x307F;&#xFF08;Dilated Convolution&#xFF09;&#x3092;&#x9069;&#x7528;&#x3059;&#x308B;&#x3002;&#x3000;
    Dilated Convolution
    &#x3000;&#x30FB;&#x5C64;&#x304C;&#x6DF1;&#x304F;&#x306A;&#x308B;&#x306B;&#x3064;&#x308C;&#x3066;&#x7573;&#x307F;&#x3053;&#x3080;&#x30EA;&#x30F3;&#x30AF;&#x3092;&#x96E2;&#x3059;&#xFF08;&#x30B9;&#x30AD;&#x30C3;&#x30D7;&#xFF09;
    &#x3000;&#x30FB;&#x53D7;&#x5BB9;&#x91CE;&#x3092;&#x7C21;&#x5358;&#x306B;&#x5897;&#x3084;&#x3059;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;&#x3068;&#x3044;&#x3046;&#x5229;&#x70B9;&#x304C;&#x3042;&#x308B;&#x3002;
    &#x3000;&#x3000;&#xFF08;Dilated=1,2,4,8&#xFF09;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E5%BF%9C%E7%94%A8%E3%83%A2%E3%83%87%E3%83%AB_WaveNet1.png" alt="png"></p>
<pre class="language-text">&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x3092;&#x7528;&#x3044;&#x3066;&#x7D50;&#x5408;&#x78BA;&#x7387;&#x3092;&#x5B66;&#x7FD2;&#x3059;&#x308B;&#x969B;&#x306B;&#x3001;&#x52B9;&#x7387;&#x7684;&#x306B;&#x5B66;&#x7FD2;&#x304C;&#x884C;&#x3048;&#x308B;
&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x3092;&#x63D0;&#x6848;&#x3057;&#x305F;&#x3053;&#x3068;&#x304C;WaveNet&#x306E;&#x5927;&#x304D;&#x306A;&#x8CA2;&#x732E;&#x306E;&#xFF11;&#x3064;&#x3067;&#x3042;&#x308B;&#x3002;
&#x63D0;&#x6848;&#x3055;&#x308C;&#x305F;&#x65B0;&#x3057;&#x3044;Convolution&#x578B;&#x30A2;&#x30FC;&#x30AD;&#x30C6;&#x30AF;&#x30C1;&#x30E3;&#x306F;&#x3001;
&#x300C;Dilated causal convolution&#x300D;&#x3068;&#x547C;&#x3070;&#x308C;&#x3001;
&#x7D50;&#x5408;&#x78BA;&#x7387;&#x3092;&#x52B9;&#x7387;&#x7684;&#x306B;&#x5B66;&#x7FD2;&#x3067;&#x304D;&#x308B;&#x3088;&#x3046;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;

Dilated causal convolution&#x3092;&#x7528;&#x3044;&#x305F;&#x969B;&#x306E;&#x5927;&#x304D;&#x306A;&#x5229;&#x70B9;&#x306F;&#x3001;
&#x5358;&#x7D14;&#x306A;Convolution Layer&#x3068;&#x6BD4;&#x3079;&#x3066;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x6570;&#x306B;&#x5BFE;&#x3059;&#x308B;
&#x53D7;&#x5BB9;&#x91CE;&#x304C;&#x5E83;&#x3044;&#x3053;&#x3068;&#x3067;&#x3042;&#x308B;&#x3002;
&#xFF08;&#x9577;&#x3044;&#x7BC4;&#x56F2;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x3092;&#x3046;&#x307E;&#x304F;&#x4F7F;&#x3044;&#x305F;&#x3044;&#xFF09;
</pre>
<h3 class="mume-header" id="12-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">12-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">&#x6DF1;&#x5C64;&#x5B66;&#x7FD2;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x5FDC;&#x7528;&#x65B9;&#x6CD5;&#x306B;&#x3064;&#x3044;&#x3066;&#x5927;&#x304D;&#x304F;&#xFF14;&#x3064;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x30D9;&#x30FC;&#x30B9;&#x306B;&#x5B66;&#x7FD2;&#x3092;&#x9032;&#x3081;&#x305F;&#x3002;
&#x307E;&#x305A;&#x306F;Mobile Net&#x3002;2017&#x5E74;&#x3054;&#x308D;&#x306B;&#x753B;&#x50CF;&#x8A8D;&#x8B58;&#x30E2;&#x30C7;&#x30EB;&#x306F;&#x307B;&#x307C;&#x5B8C;&#x6210;&#x5F62;&#x306B;
&#x5230;&#x9054;&#x3057;&#x3066;&#x3044;&#x308B;&#x305F;&#x3081;&#x3001;&#x4ECA;&#x5EA6;&#x306F;&#x305D;&#x308C;&#x3092;&#x3088;&#x308A;&#x9AD8;&#x901F;&#x306B;&#x30FB;&#x8EFD;&#x304F;&#x30FB;&#x9AD8;&#x7CBE;&#x5EA6;&#x306B;
&#x5229;&#x7528;&#x3059;&#x308B;&#x624B;&#x6CD5;&#x3092;&#x7DE8;&#x307F;&#x51FA;&#x3055;&#x308C;&#x305F;&#x3002;
&#x3053;&#x308C;&#x306F;Depthwise separatable Convolution&#x3068;Pointwise Convolution&#x3068;
&#x547C;&#x3070;&#x308C;&#x308B;&#xFF12;&#x3064;&#x306E;&#x8A66;&#x307F;&#x306B;&#x3088;&#x308A;&#x3001;&#x7573;&#x307F;&#x8FBC;&#x307F;&#x6642;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x91CF;&#x3092;&#x4F4E;&#x6E1B;&#x3057;&#x3064;&#x3064;
&#x7CBE;&#x5EA6;&#x3092;&#x640D;&#x306A;&#x308F;&#x306A;&#x3044;&#x51FA;&#x529B;&#x3092;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3002;
&#x7247;&#x3084;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x3092;1&#x679A;&#x306B;&#x9650;&#x5B9A;&#x3059;&#x308B;&#x65B9;&#x6CD5;&#x3001;&#x7247;&#x3084;&#x30AB;&#x30FC;&#x30CD;&#x30EB;&#x306E;&#x30B5;&#x30A4;&#x30BA;&#x3092;1&#xD7;1&#x306B;&#x9650;&#x5B9A;&#x3059;&#x308B;&#x65B9;&#x6CD5;&#x3067;
&#x30C7;&#x30FC;&#x30BF;&#x91CF;&#x306E;&#x4F4E;&#x6E1B;&#x52B9;&#x679C;&#x306F;&#x7406;&#x89E3;&#x3067;&#x304D;&#x308B;&#x3082;&#x306E;&#x306E;&#x7CBE;&#x5EA6;&#x304C;&#x60AA;&#x5316;&#x3057;&#x306A;&#x3044;&#x7406;&#x7531;&#x306B;&#x3064;&#x3044;&#x3066;&#x306F;
&#x4E0D;&#x660E;&#x3060;&#x304C;&#x3001;&#x5B9F;&#x8A3C;&#x7D50;&#x679C;&#x304C;&#x52B9;&#x679C;&#x306E;&#x671F;&#x5F85;&#x3067;&#x304D;&#x308B;&#x3082;&#x306E;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x306F;&#x78BA;&#x304B;&#x3002;
DenseNet&#x3082;DenseBlock&#x5185;&#x3067;&#x5B66;&#x7FD2;&#x306E;&#x7CBE;&#x5EA6;&#x3092;&#x5411;&#x4E0A;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x524D;&#x5C64;&#x307E;&#x3067;&#x306E;&#x51FA;&#x529B;&#x3092;
&#x7121;&#x99C4;&#x306A;&#x304F;&#x5229;&#x7528;&#x3057;&#x3001;Pooling&#x51E6;&#x7406;&#x306B;&#x3066;&#x81A8;&#x3089;&#x3093;&#x3060;&#x60C5;&#x5831;&#x3092;&#x5143;&#x306E;&#x30C1;&#x30E3;&#x30CD;&#x30EB;&#x6570;&#x306B;&#x623B;&#x3059;&#x3068;&#x3044;&#x3046;
&#x624B;&#x6CD5;&#x3092;&#x53D6;&#x3063;&#x3066;&#x3044;&#x308B;&#x304C;&#x3001;&#x9006;&#x306B;&#x8A00;&#x3048;&#x3070;&#x305D;&#x308C;&#x3060;&#x3051;&#x5BC4;&#x4E0E;&#x7387;&#x306E;&#x4E4F;&#x3057;&#x3044;&#x60C5;&#x5831;&#x304C;&#x591A;&#x3044;&#x3068;&#x3044;&#x3046;&#x3053;&#x3068;&#x304C;&#x8A00;&#x3048;&#x308B;&#x3002;
&#x30D0;&#x30C3;&#x30C1;&#x6B63;&#x898F;&#x5316;&#x306B;&#x3064;&#x3044;&#x3066;&#x3082;&#x4E07;&#x80FD;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;&#x74B0;&#x5883;&#x8981;&#x56E0;&#x306A;&#x3069;&#x306B;&#x3088;&#x308A;&#x52B9;&#x679C;&#x304C;&#x4E4F;&#x3057;&#x3044;&#x3053;&#x3068;&#x3082;&#x3042;&#x308A;
&#x30D0;&#x30C3;&#x30C1;&#x30B5;&#x30A4;&#x30BA;&#x306B;&#x5DE6;&#x53F3;&#x3055;&#x308C;&#x306A;&#x3044;&#x6B63;&#x898F;&#x5316;&#x306E;&#x624B;&#x6CD5;&#x3068;&#x3057;&#x3066;LayerNorm&#x3084;InstanceNorm&#x304C;&#x8003;&#x6848;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
</pre>
<h2 class="mume-header" id="13section5transformer">13.Section5:Transformer</h2>

<pre class="language-text">Transformer&#x3068;&#x306F;Encoder-Decoder&#x30E2;&#x30C7;&#x30EB;&#x306B;
Attention&#x306E;&#x6982;&#x5FF5;&#x3092;&#x7D44;&#x307F;&#x8FBC;&#x3093;&#x3060;&#x3082;&#x306E;&#x3067;&#x3042;&#x308B;&#x3002;

&#x304A;&#x3055;&#x3089;&#x3044;
    Encoder RNN:&#x7FFB;&#x8A33;&#x5143;&#x306E;&#x5206;&#x3092;&#x8AAD;&#x307F;&#x8FBC;&#x307F;&#x3001;&#x5B9F;&#x6570;&#x5024;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306B;&#x5909;&#x63DB;
    Decoder RNN:&#x5B9F;&#x6570;&#x5024;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x304B;&#x3089;&#x3001;&#x7FFB;&#x8A33;&#x5148;&#x306E;&#x8A00;&#x8A9E;&#x306E;&#x6587;&#x3092;&#x751F;&#x6210;
</pre>
<p>&#x9577;&#x3044;&#x6587;&#x7AE0;&#x306B;&#x306A;&#x308B;&#x307B;&#x3069;&#x3001;&#x56FA;&#x5B9A;&#x9577;&#x30D9;&#x30AF;&#x30C8;&#x30EB;&#x306B;&#x96C6;&#x7D04;&#x3057;&#x305F;&#x969B;&#x306B;<br>
&#x6B20;&#x843D;&#x3059;&#x308B;&#x60C5;&#x5831;&#x91CF;&#x304C;&#x591A;&#x304F;&#x306A;&#x308B;&#x305F;&#x3081;&#x4E0D;&#x5229;&#x306B;&#x306A;&#x308B;&#x3002;<br>
<img src="./img/%E6%B7%B1%E5%B1%A4day4_Transfomer_BLEU.png" alt="png"></p>
<pre class="language-text">Attention(&#x6CE8;&#x610F;&#x6A5F;&#x69CB;)
    &#x7FFB;&#x8A33;&#x5148;&#x306E;&#x5404;&#x5358;&#x8A9E;&#x3092;&#x9078;&#x629E;&#x3059;&#x308B;&#x969B;&#x306B;&#x3001;&#x7FFB;&#x8A33;&#x5143;&#x306E;&#x6587;&#x4E2D;&#x306E;&#x5404;&#x5358;&#x8A9E;&#x306E;&#x96A0;&#x308C;&#x72B6;&#x614B;&#x3092;&#x5229;&#x7528;
</pre>
<p>&#x7FFB;&#x8A33;&#x5143;&#x306E;&#x5404;&#x5358;&#x8A9E;&#x306E;&#x96A0;&#x308C;&#x72B6;&#x614B;&#x306E;&#x52A0;&#x91CD;&#x5E73;&#x5747;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>&#x2211;</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>x</mi></msub></munderover><msub><mi>&#x3B1;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><mo>&#x22C5;</mo></mstyle></mrow><annotation encoding="application/x-tex">c_i=\displaystyle \sum_{j=1}^{T_x} \alpha_{ij}h_j\cdot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2532130000000006em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394360000000005em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.311105em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">&#x22C5;</span></span></span></span></p>
<p>&#x91CD;&#x307F;(&#x5168;&#x3066;&#x8DB3;&#x3059;&#x3068;1) &#x91CD;&#x307F;&#x306F;FFNN&#x3067;&#x6C42;&#x3081;&#x308B;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>&#x3B1;</mi><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>T</mi><mi>x</mi></msub></msubsup><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><msub><mi>e</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\alpha=\frac{\exp(e_{ij})}{ \sum_{k=1}^{T_x}\exp(e_{ik})} ,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">&#x3B1;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.7684049999999998em;vertical-align:-0.7360849999999999em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.03232em;"><span style="top:-2.5069749999999997em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9757499999999999em;"><span style="top:-2.1527714285714286em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.9876571428571426em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.23056em;"><span style="top:-2.3em;margin-left:-0.13889em;margin-right:0.1em;"><span class="pstrut" style="height:2.5em;"></span><span class="mord mathnormal mtight">x</span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3472285714285714em;"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mop mtight"><span class="mtight">e</span><span class="mtight">x</span><span class="mtight">p</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">ik</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.50732em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">e</span><span class="mtight">x</span><span class="mtight">p</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.7360849999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><msub><mi>s</mi><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e_{ij}=a(s_{i-1},h_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">ij</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transfomer_Attention1.png" alt="&#x6DF1;&#x5C64;day4_Transfomer_Attention1.png"></p>
<pre class="language-text">Attention&#x306F;&#x8F9E;&#x66F8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;
    query(&#x691C;&#x7D22;&#x30AF;&#x30A8;&#x30EA;)&#x306B;&#x4E00;&#x81F4;&#x3059;&#x308B;key&#x3092;&#x7D22;&#x5F15;&#x3057;&#x3001;&#x5BFE;&#x5FDC;&#x3059;&#x308B;value&#x3092;&#x53D6;&#x308A;&#x51FA;&#x3059;&#x64CD;&#x4F5C;
    &#x3067;&#x3042;&#x308B;&#x3068;&#x898B;&#x306A;&#x3059;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;&#x3002;&#x8F9E;&#x66F8;&#x30AA;&#x30D6;&#x30B8;&#x30A7;&#x30AF;&#x30C8;&#x306E;&#x6A5F;&#x80FD;&#x3068;&#x540C;&#x3058;&#x3002;
</pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>&#x3C3;</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span>(query<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2190;</mo></mrow><annotation encoding="application/x-tex">\leftarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2190;</span></span></span></span>k2) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> v2</p>
<table>
<thead>
<tr>
<th style="text-align:center">key</th>
<th style="text-align:center">value<br>Attention weight</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">k1</td>
<td style="text-align:center">v1</td>
</tr>
<tr>
<td style="text-align:center">k2</td>
<td style="text-align:center">v2</td>
</tr>
<tr>
<td style="text-align:center">k3</td>
<td style="text-align:center">v3</td>
</tr>
<tr>
<td style="text-align:center">k4</td>
<td style="text-align:center">v4</td>
</tr>
</tbody>
</table>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transfomer_Attention2.png" alt="&#x6DF1;&#x5C64;day4_Transfomer_Attention2.png"></p>
<h3 class="mume-header" id="trnasformervaswani-et-al-2017">Trnasformer(Vaswani et al., 2017)</h3>

<pre class="language-text">Attention is all you need.
    - 2017&#x5E74;6&#x6708;&#x306B;&#x767B;&#x5834;
    - RNN&#x3092;&#x4F7F;&#x308F;&#x306A;&#x3044;
    - &#x5FC5;&#x8981;&#x306A;&#x306E;&#x306F;Attention&#x3060;&#x3051;
    - &#x5F53;&#x6642;&#x306E;SOTA&#x3092;&#x306F;&#x308B;&#x304B;&#x306B;&#x5C11;&#x306A;&#x3044;&#x8A08;&#x7B97;&#x91CF;&#x3067;&#x5B9F;&#x73FE;
    - &#x82F1;&#x4ECF;(3600&#x4E07;&#x6587;)&#x306E;&#x5B66;&#x7FD2;&#x3092;8GPU&#x3067;3.5&#x65E5;&#x3067;&#x5B8C;&#x4E86;
</pre>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transfomer_Transformer1.png" alt="&#x6DF1;&#x5C64;day4_Transfomer_Transformer1.png"></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transfomer_Attention3.png" alt="&#x6DF1;&#x5C64;day4_Transfomer_Attention3.png"></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transformer_Self-Attention.png" alt="&#x6DF1;&#x5C64;day4_Transfomer_Self-Attention.png"></p>
<h3 class="mume-header" id="position-wise-feed-forward-networks">Position-Wise Feed-Forward Networks</h3>

<p>&#x4F4D;&#x7F6E;&#x60C5;&#x5831;&#x3092;&#x4FDD;&#x6301;&#x3057;&#x305F;&#x307E;&#x307E;&#x9806;&#x4F1D;&#x64AD;&#x3055;&#x305B;&#x308B;</p>
<ul>
<li>&#x5404;Attention&#x5C64;&#x306E;&#x51FA;&#x529B;&#x3092;&#x6C7A;&#x5B9A;<br>
2&#x5C64;&#x306E;&#x5168;&#x7D50;&#x5408;NN<br>
&#x7DDA;&#x5F62;&#x5909;&#x63DB;&#x2192;ReLU&#x2192;&#x7DDA;&#x5F62;&#x5909;&#x63DB;</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>x</mi><msub><mi>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo stretchy="false">)</mo><msub><mi>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">FFN(x)=max(0,xW_1+b_1)W_2+b_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">FFN</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mn>1</mn></msub><mo>&#x2208;</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>512</mn><mo>&#xD7;</mo><mn>2048</mn></mrow></msup><mspace width="1em"></mspace><msub><mi>b</mi><mn>1</mn></msub><mo>&#x2208;</mo><msup><mi mathvariant="double-struck">R</mi><mn>2048</mn></msup></mrow><annotation encoding="application/x-tex">W_1 \isin \mathbb{R}^{512\times 2048} \quad b_1 \isin \mathbb{R}^{2048}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">512</span><span class="mbin mtight">&#xD7;</span><span class="mord mtight">2048</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2048</span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mn>2</mn></msub><mo>&#x2208;</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>2048</mn><mo>&#xD7;</mo><mn>512</mn></mrow></msup><mspace width="1em"></mspace><msub><mi>b</mi><mn>2</mn></msub><mo>&#x2208;</mo><msup><mi mathvariant="double-struck">R</mi><mn>512</mn></msup></mrow><annotation encoding="application/x-tex">W_2 \isin \mathbb{R}^{2048\times 512} \quad b_2 \isin \mathbb{R}^{512}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2048</span><span class="mbin mtight">&#xD7;</span><span class="mord mtight">512</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">512</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 class="mume-header" id="scaled-dot-product-attention">Scaled dot product attention</h3>

<p>&#x5168;&#x5358;&#x8A9E;&#x306B;&#x95A2;&#x3059;&#x308B;Attention&#x3092;&#x307E;&#x3068;&#x3081;&#x3066;&#x8A08;&#x7B97;&#x3059;&#x308B;</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x6B21;&#x5143;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30B9;&#x30B1;&#x30FC;&#x30EA;&#x30F3;&#x30B0;</mtext></mrow><annotation encoding="application/x-tex">&#x6B21;&#x5143;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30B9;&#x30B1;&#x30FC;&#x30EA;&#x30F3;&#x30B0;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">&#x6B21;&#x5143;&#x306B;&#x5FDC;&#x3058;&#x3066;&#x30B9;&#x30B1;&#x30FC;&#x30EA;&#x30F3;&#x30B0;</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo stretchy="false">)</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">Attention(Q,K,V)=sofftmax(\frac{QK^T}{\sqrt{d_k}})V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">tt</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.627473em;vertical-align:-0.538em;"></span><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">ff</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.089473em;"><span style="top:-2.5864385em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8622307142857143em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.8222307142857144em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.17776928571428574em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Q</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.538em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>q</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>2</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>2</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>2</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>3</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>1</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>3</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>q</mi><mn>3</mn></msub><mo>&#x22C5;</mo><msub><mi>k</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}q_1 \\q_2 \\ q_3 \end{bmatrix}=
\begin{bmatrix}k_1 &amp; k_2 &amp; k_3 \end{bmatrix}=
\begin{bmatrix}
q_1\cdot k_1 &amp; q_1\cdot k_2 &amp; q_1\cdot k_3 \\
q_2\cdot k_1 &amp; q_2\cdot k_2 &amp; q_2\cdot k_3 \\
q_3\cdot k_1 &amp; q_3\cdot k_2 &amp; q_3\cdot k_3 \\
\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace><mi>Q</mi><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>K</mi></mrow><annotation encoding="application/x-tex">\quad Q \qquad \qquad K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.2</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.7</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.4</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.3</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.8</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0.1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>v</mi><mn>3</mn></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0.1</mn><msub><mi>v</mi><mn>1</mn></msub><mo>+</mo><mn>0.2</mn><msub><mi>v</mi><mn>1</mn></msub><mo>+</mo><mn>0.7</mn><msub><mi>v</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0.4</mn><msub><mi>v</mi><mn>2</mn></msub><mo>+</mo><mn>0.3</mn><msub><mi>v</mi><mn>2</mn></msub><mo>+</mo><mn>0.3</mn><msub><mi>v</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0.8</mn><msub><mi>v</mi><mn>3</mn></msub><mo>+</mo><mn>0.1</mn><msub><mi>v</mi><mn>3</mn></msub><mo>+</mo><mn>0.1</mn><msub><mi>v</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
0.1 &amp; 0.2 &amp; 0.7 \\
0.4 &amp; 0.3 &amp; 0.3 \\
0.8 &amp; 0.1 &amp; 0.1 \\
\end{bmatrix}
\begin{bmatrix}
v_1 \\
v_2 \\
v_3 \\
\end{bmatrix}=
\begin{bmatrix}
0.1v_1 + 0.2v_1 + 0.7v_1 \\
0.4v_2 + 0.3v_2 + 0.3v_2 \\
0.8v_3 + 0.1v_3 + 0.1v_3 \\
\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.4</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.2</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.7</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.3</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.60004em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A3;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A1;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.1</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.7</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.4</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0.8</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.1</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0.1</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A6;</span></span></span><span style="top:-3.3970000000000002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span style="height:0.016em;width:0.667em;"><svg width="0.667em" height="0.016em" style="width:0.667em" viewBox="0 0 667 16" preserveAspectRatio="xMinYMin"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>&#x23A4;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>Q</mi><mi>K</mi><mo stretchy="false">)</mo><mspace width="2em"></mspace><mi>V</mi></mrow><annotation encoding="application/x-tex">softmax(QK) \qquad V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mclose">)</span><span class="mspace" style="margin-right:2em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transformer_ScaledDotProductAttention.png" alt="png"></p>
<h3 class="mume-header" id="multi-head-attention">Multi-Head attention</h3>

<p>&#x91CD;&#x307F;&#x306E;&#x7570;&#x306A;&#x308B;8&#x500B;&#x306E;&#x30D8;&#x30C3;&#x30C9;&#x3092;&#x4F7F;&#x7528;</p>
<ul>
<li>
<p>8&#x500B;&#x306E;Scaled Dot-Product Attention&#x306E;&#x51FA;&#x529B;&#x3092;Cancat</p>
</li>
<li>
<p>&#x305D;&#x308C;&#x305E;&#x308C;&#x306E;&#x30D8;&#x30C3;&#x30C9;&#x304C;&#x7570;&#x306A;&#x308B;&#x7A2E;&#x985E;&#x306E;&#x60C5;&#x5831;&#x3092;&#x53CE;&#x96C6;</p>
</li>
</ul>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transformer_MultiHeadAttention.png" alt="png"></p>
<h3 class="mume-header" id="decoder">Decoder</h3>

<ul>
<li>
<p>Encoder&#x3068;&#x540C;&#x3058;&#x304F;6&#x5C64;<br>
&#x5404;&#x5C64;&#x3067;2&#x7A2E;&#x985E;&#x306E;&#x6CE8;&#x610F;&#x6A5F;&#x69CB;<br>
&#x6CE8;&#x610F;&#x6A5F;&#x69CB;&#x306E;&#x4ED5;&#x7D44;&#x307F;&#x306F;Encoder&#x3068;&#x540C;&#x3058;</p>
</li>
<li>
<p>&#x81EA;&#x5DF1;&#x6CE8;&#x610F;&#x6A5F;&#x69CB;<br>
&#x751F;&#x6210;&#x5358;&#x8A9E;&#x5217;&#x306E;&#x60C5;&#x5831;&#x3092;&#x53CE;&#x96C6;<br>
&#x76F4;&#x4E0B;&#x306E;&#x5C64;&#x306E;&#x51FA;&#x529B;&#x3078;&#x306E;&#x30A2;&#x30C6;&#x30F3;&#x30B7;&#x30E7;&#x30F3;<br>
&#x672A;&#x6765;&#x306E;&#x60C5;&#x5831;&#x3092;&#x898B;&#x306A;&#x3044;&#x3088;&#x3046;&#x306B;&#x30DE;&#x30B9;&#x30AF;</p>
</li>
<li>
<p>Encoder-Decoder Attention<br>
&#x5165;&#x529B;&#x5206;&#x306E;&#x60C5;&#x5831;&#x3092;&#x53CE;&#x96C6;<br>
Encoder&#x306E;&#x51FA;&#x529B;&#x3078;&#x306E;&#x30A2;&#x30C6;&#x30F3;&#x30B7;&#x30E7;&#x30F3;</p>
</li>
<li>
<p>Add(Residual Connection)<br>
&#x5165;&#x51FA;&#x529B;&#x306E;&#x5DEE;&#x5206;&#x3092;&#x5B66;&#x7FD2;&#x3055;&#x305B;&#x308B;<br>
&#x5B9F;&#x88C5;&#x4E0A;&#x306F;&#x51FA;&#x529B;&#x306B;&#x5165;&#x529B;&#x3092;&#x305D;&#x306E;&#x307E;&#x307E;&#x52A0;&#x7B97;&#x3059;&#x308B;&#x3060;&#x3051;<br>
&#x52B9;&#x679C;&#xFF1A;&#x5B66;&#x7FD2;&#x30FB;&#x30C6;&#x30B9;&#x30C8;&#x30A8;&#x30E9;&#x30FC;&#x306E;&#x4F4E;&#x6E1B;</p>
</li>
<li>
<p>Norm(Layer Normalization)<br>
&#x5404;&#x5C64;&#x306B;&#x304A;&#x3044;&#x3066;&#x30D0;&#x30A4;&#x30A2;&#x30B9;&#x3092;&#x9664;&#x304F;&#x6D3B;&#x6027;&#x5316;&#x95A2;&#x6570;&#x306E;&#x5165;&#x529B;&#x3092;&#x5E73;&#x5747;0&#x3001;&#x5206;&#x6563;1&#x306B;&#x6B63;&#x5247;&#x5316;<br>
&#x52B9;&#x679C;&#xFF1A;&#x5B66;&#x7FD2;&#x306E;&#x9AD8;&#x901F;&#x5316;</p>
</li>
</ul>
<h3 class="mume-header" id="position-encoding">Position Encoding</h3>

<p>RNN&#x3092;&#x7528;&#x3044;&#x306A;&#x3044;&#x306E;&#x3067;&#x5358;&#x8A9E;&#x5217;&#x306E;&#x8A9E;&#x9806;&#x60C5;&#x5831;&#x3092;&#x8FFD;&#x52A0;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;</p>
<ul>
<li>&#x5358;&#x8A9E;&#x306E;&#x4F4D;&#x7F6E;&#x60C5;&#x5831;&#x3092;&#x30A8;&#x30F3;&#x30B3;&#x30FC;&#x30C9;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mi>sin</mi><mo>&#x2061;</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><mn>512</mn></mrow></msup></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">PE_{(pos,2i)}=\sin\begin{pmatrix}\frac{pos}{10000^{2i/512}}\end{pmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.225425em;vertical-align:-0.36271250000000005em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8627125em;"><span style="top:-3.0227125em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/512</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.36271250000000005em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><msub><mi>E</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>s</mi><mo separator="true">,</mo><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mi>cos</mi><mo>&#x2061;</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi>p</mi><mi>o</mi><mi>s</mi></mrow><mrow><mn>1000</mn><msup><mn>0</mn><mrow><mn>2</mn><mi>i</mi><mi mathvariant="normal">/</mi><mn>512</mn></mrow></msup></mrow></mfrac></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">PE_{(pos,2i+1)}=\cos\begin{pmatrix}\frac{pos}{10000^{2i/512}}\end{pmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.225425em;vertical-align:-0.36271250000000005em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8627125em;"><span style="top:-3.0227125em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7475em;"><span style="top:-2.614575em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1000</span><span class="mord mtight"><span class="mord mtight">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8220357142857143em;"><span style="top:-2.8220357142857138em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5357142857142856em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">i</span><span class="mord mtight">/512</span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">os</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.38542499999999996em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.36271250000000005em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></li>
</ul>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_Transformer_PositionEncoding.png" alt="png"></p>
<h3 class="mume-header" id="13-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">13-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">Transformer&#x306F;Encoder-Decoder&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x3060;&#x304C;
RNN&#x3092;&#x4F7F;&#x7528;&#x305B;&#x305A;Attention&#x306E;&#x6982;&#x5FF5;&#x3092;&#x4E2D;&#x5FC3;&#x306B;&#x6210;&#x308A;&#x7ACB;&#x3063;&#x3066;&#x3044;&#x308B;&#x70B9;&#x304C;&#x7279;&#x5FB4;&#x7684;&#x3067;&#x3042;&#x308B;&#x3002;
Encoder&#x3001;Decoder&#x5171;&#x306B;RNN&#x3067;&#x306F;&#x4FDD;&#x6301;&#x3067;&#x304D;&#x3066;&#x3044;&#x305F;&#x6642;&#x7CFB;&#x5217;&#x60C5;&#x5831;&#x306E;&#x4EE3;&#x308F;&#x308A;&#x306B;
&#x4F4D;&#x7F6E;&#x60C5;&#x5831;&#x3092;&#x4ED8;&#x4E0E;&#x3059;&#x308B;PositionEncoding&#x306E;&#x30E6;&#x30CB;&#x30C3;&#x30C8;&#x304C;&#x5165;&#x53E3;&#x306B;&#x7D44;&#x307F;&#x8FBC;&#x307E;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
&#x305D;&#x306E;&#x5F8C;&#x7D9A;&#x306B;&#x306F;&#x5168;&#x5358;&#x8A9E;&#x306B;&#x95A2;&#x3059;&#x308B;Attention&#x3092;&#x307E;&#x3068;&#x3081;&#x3066;&#x8A08;&#x7B97;&#x3059;&#x308B;Scaled dot Product Attention&#x304C;&#x8907;&#x6570;&#x675F;&#x306D;&#x3089;&#x308C;&#x305F;
Multi-Head Attention&#x306E;&#x30E6;&#x30CB;&#x30C3;&#x30C8;&#x304C;&#x3042;&#x308B;&#x3002;
&#x3053;&#x308C;&#x306F;&#x5165;&#x51FA;&#x529B;&#x5171;&#x306B;&#x7DDA;&#x5F62;&#x5909;&#x63DB;&#x3055;&#x308C;&#x305F;&#x5024;&#x3068;&#x306A;&#x308B;&#x3002;
&#x3055;&#x3089;&#x306B;Encoder&#x306E;&#x5834;&#x5408;&#x306F;Position-Wise Feed-Forward Networks&#x306B;&#x3066;&#x4F4D;&#x7F6E;&#x60C5;&#x5831;&#x3092;&#x4FDD;&#x6301;&#x3057;&#x305F;&#x307E;&#x307E;
&#x9806;&#x4F1D;&#x64AD;&#x3055;&#x305B;&#x308B;&#x30E6;&#x30CB;&#x30C3;&#x30C8;&#x304C;&#x7D9A;&#x304F;&#x3002;
Decoder&#x5074;&#x306B;&#x306F;&#x672A;&#x6765;&#x306E;&#x5358;&#x8A9E;&#x3092;&#x30AB;&#x30F3;&#x30CB;&#x30F3;&#x30B0;&#x3055;&#x305B;&#x306A;&#x3044;&#x3088;&#x3046;&#x30DE;&#x30B9;&#x30AF;&#x3059;&#x308B;&#x81EA;&#x5DF1;&#x6CE8;&#x610F;&#x6A5F;&#x69CB;&#x3068;&#x3001;
Encoder&#x5074;&#x306E;&#x51FA;&#x529B;&#x3068;Decoder&#x5074;&#x306E;&#x5165;&#x529B;&#x3092;&#x57FA;&#x306B;&#x7D50;&#x679C;&#x3092;&#x51FA;&#x529B;&#x3059;&#x308B;&#x30BD;&#x30FC;&#x30B9;&#x30FB;&#x30BF;&#x30FC;&#x30B2;&#x30C3;&#x30C8;&#x6CE8;&#x610F;&#x6A5F;&#x69CB;&#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x3002;
&#x8907;&#x6570;&#x306E;&#x30E6;&#x30CB;&#x30C3;&#x30C8;&#x304B;&#x3089;&#x69CB;&#x6210;&#x3055;&#x308C;&#x308B;&#x305F;&#x3081;&#x8907;&#x96D1;&#x306A;&#x5370;&#x8C61;&#x306F;&#x3042;&#x308B;&#x304C;&#x3001;RNN&#x306E;&#x3088;&#x3046;&#x306B;&#x8A08;&#x7B97;&#x91CF;&#x3068;&#x8A18;&#x61B6;&#x91CF;&#x304C;&#x81A8;&#x3089;&#x3080;&#x3082;&#x306E;&#x3067;&#x306F;&#x306A;&#x3044;&#x3002;
Attention&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x7FFB;&#x8A33;&#x5143;&#x306E;&#x5404;&#x5358;&#x8A9E;&#x306E;&#x91CD;&#x307F;&#x306E;&#x52A0;&#x91CD;&#x5E73;&#x5747;&#x3092;
&#x6C42;&#x3081;&#x308B;&#x6982;&#x5FF5;&#x304C;Transformer&#x306E;&#x809D;&#x3068;&#x8A00;&#x3048;&#x308B;&#x3002;
</pre>
<h3 class="mume-header" id="13-2%E5%AE%9F%E8%A3%85%E6%BC%94%E7%BF%92%E7%B5%90%E6%9E%9C">13-2.&#x5B9F;&#x88C5;&#x6F14;&#x7FD2;&#x7D50;&#x679C;</h3>

<p>Attention&#x306E;&#x6709;&#x7121;&#x306B;&#x3088;&#x308B;&#x5404;seq2seq&#x30E2;&#x30C7;&#x30EB;&#x306E;BLEU&#x6BD4;&#x8F03;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Attention&#x3092;&#x7528;&#x3044;&#x306A;&#x3044;seq2seq&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x5B9F;&#x884C;&#x7D50;&#x679C;</span>
src<span class="token punctuation">:</span> <span class="token keyword">is</span> there <span class="token builtin">any</span> hope of his success ?
tgt<span class="token punctuation">:</span> &#x5F7C; &#x306E; &#x6210;&#x529F; &#x306E; &#x898B;&#x8FBC;&#x307F; &#x306F; &#x3042; &#x308A; &#x307E; &#x3059; &#x304B; &#x3002;
out<span class="token punctuation">:</span> &#x5F7C; &#x306E; &#x6210;&#x529F; &#x304C; &#x6210;&#x529F; &#x3059;&#x308B; &#x306E; &#x3067; &#x3059; &#x304B; &#x3002;

src<span class="token punctuation">:</span> show your own business <span class="token punctuation">.</span>
tgt<span class="token punctuation">:</span> &#x81EA;&#x5206; &#x306E; &#x4E8B; &#x3092; &#x3057;&#x308D; &#x3002;
out<span class="token punctuation">:</span> &#x81EA;&#x5206; &#x306E; &#x81EA;&#x5206; &#x306E; <span class="token operator">&lt;</span>UNK<span class="token operator">&gt;</span> &#x3092; &#x3057; &#x3002;

src<span class="token punctuation">:</span> he lived a hard life <span class="token punctuation">.</span>
tgt<span class="token punctuation">:</span> &#x5F7C; &#x306F; &#x3064;&#x3089; &#x3044; &#x4EBA;&#x751F; &#x3092; &#x9001; &#x3063; &#x305F; &#x3002;
out<span class="token punctuation">:</span> &#x5F7C; &#x306F; &#x8F9B; &#x751F;&#x6D3B; &#x3092; &#x9001; &#x3063; &#x305F; &#x3002;

<span class="token comment"># BLEU&#x306E;&#x51FA;&#x529B;</span>
<span class="token number">17.6073276538058</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Attention&#x3092;&#x7528;&#x3044;&#x305F;seq2seq&#x30E2;&#x30C7;&#x30EB;(Transformer)&#x306E;&#x5B9F;&#x884C;&#x7D50;&#x679C;</span>
src<span class="token punctuation">:</span> <span class="token keyword">is</span> there <span class="token builtin">any</span> hope of his success ?
tgt<span class="token punctuation">:</span> &#x5F7C; &#x306E; &#x6210;&#x529F; &#x306E; &#x898B;&#x8FBC;&#x307F; &#x306F; &#x3042; &#x308A; &#x307E; &#x3059; &#x304B; &#x3002;
out<span class="token punctuation">:</span> &#x5F7C; &#x306E; &#x6210;&#x529F; &#x306E; &#x671B;&#x307F; &#x306F; &#x3042; &#x308B; &#x306E; &#x3067; &#x3059; &#x304B; &#x3002;

src<span class="token punctuation">:</span> show your own business <span class="token punctuation">.</span>
tgt<span class="token punctuation">:</span> &#x81EA;&#x5206; &#x306E; &#x4E8B; &#x3092; &#x3057;&#x308D; &#x3002;
out<span class="token punctuation">:</span> &#x541B; &#x306E; &#x5546;&#x58F2; &#x3092; <span class="token operator">&lt;</span>UNK<span class="token operator">&gt;</span> &#x306B; &#x3057; &#x3066; &#x3044; &#x3063; &#x305F; &#x3002;

src<span class="token punctuation">:</span> he lived a hard life <span class="token punctuation">.</span>
tgt<span class="token punctuation">:</span> &#x5F7C; &#x306F; &#x3064;&#x3089; &#x3044; &#x4EBA;&#x751F; &#x3092; &#x9001; &#x3063; &#x305F; &#x3002;
out<span class="token punctuation">:</span> &#x5F7C; &#x306F; &#x4E00;&#x751F; &#x61F8;&#x547D; &#x306B; &#x66AE;&#x3089; &#x3057; &#x305F; &#x3002;

src<span class="token punctuation">:</span> i study english every day <span class="token punctuation">.</span>
tgt<span class="token punctuation">:</span> &#x79C1; &#x306F; &#x6BCE;&#x65E5; &#x82F1;&#x8A9E; &#x306E; &#x52C9;&#x5F37; &#x3092; &#x3059;&#x308B; &#x3002;
out<span class="token punctuation">:</span> &#x79C1; &#x306F; &#x6BCE;&#x65E5; &#x82F1;&#x8A9E; &#x3092; &#x52C9;&#x5F37; &#x3057; &#x307E; &#x3059; &#x3002;

<span class="token comment"># BLEU&#x306E;&#x51FA;&#x529B;</span>
<span class="token number">24.506523871995793</span>
</pre><p>&#x3010;&#x8003;&#x5BDF;&#x3011;<br>
Attention&#x3092;&#x7528;&#x3044;&#x3066;&#x3044;&#x306A;&#x3044;&#x5834;&#x5408;&#x3001;&#x65AD;&#x7247;&#x7684;&#x306A;&#x8868;&#x73FE;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x304C;&#x3001;<br>
Attention&#x3092;&#x7528;&#x3044;&#x308B;&#x3068;&#x3001;&#x6587;&#x7AE0;&#x3068;&#x3057;&#x3066;&#x306E;&#x69CB;&#x6210;&#x304C;&#x81EA;&#x7136;&#x306A;&#x5370;&#x8C61;&#x3092;&#x53D7;&#x3051;&#x308B;&#x3002;</p>
<h2 class="mume-header" id="14section6%E7%89%A9%E4%BD%93%E6%A4%9C%E7%9F%A5%E3%82%BB%E3%82%B0%E3%83%A1%E3%83%B3%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3">14.Section6:&#x7269;&#x4F53;&#x691C;&#x77E5;&#x30FB;&#x30BB;&#x30B0;&#x30E1;&#x30F3;&#x30C6;&#x30FC;&#x30B7;&#x30E7;&#x30F3;</h2>

<table>
<thead>
<tr>
<th style="text-align:center">&#x30BF;&#x30B9;&#x30AF;</th>
<th style="text-align:center">&#x51FA;&#x529B;</th>
<th style="text-align:center">&#x96E3;&#x6613;&#x5EA6;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&#x5206;&#x985E;</td>
<td style="text-align:center">(&#x753B;&#x50CF;&#x306B;&#x5BFE;&#x3057;&#x5358;&#x4E00;&#x307E;&#x305F;&#x306F;&#x8907;&#x6570;&#x306E;)<br>&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;</td>
<td style="text-align:center">&#x7269;&#x4F53;&#x306E;&#x4F4D;&#x7F6E;&#x4E0D;&#x8981;</td>
</tr>
<tr>
<td style="text-align:center">&#x7269;&#x4F53;&#x691C;&#x77E5;</td>
<td style="text-align:center">Bounding Box<br>(bbox/BB)</td>
<td style="text-align:center">&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x533A;&#x5225;&#x4E0D;&#x8981;</td>
</tr>
<tr>
<td style="text-align:center">&#x610F;&#x5473;&#x9818;&#x57DF;<br>&#x5206;&#x5272;</td>
<td style="text-align:center">(&#x5404;&#x30D4;&#x30AF;&#x30BB;&#x30EB;&#x306B;&#x5BFE;&#x3057;&#x5358;&#x4E00;&#x306E;)<br>&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;</td>
<td style="text-align:center">&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x533A;&#x5225;&#x4E0D;&#x8981;</td>
</tr>
<tr>
<td style="text-align:center">&#x500B;&#x4F53;&#x9818;&#x57DF;<br>&#x5206;&#x5272;</td>
<td style="text-align:center">(&#x5404;&#x30D4;&#x30AF;&#x30BB;&#x30EB;&#x306B;&#x5BFE;&#x3057;&#x5358;&#x4E00;&#x306E;)<br>&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;</td>
<td style="text-align:center">&#x30A4;&#x30F3;&#x30B9;&#x30BF;&#x30F3;&#x30B9;&#x306E;&#x533A;&#x5225;&#x5FC5;&#x8981;</td>
</tr>
</tbody>
</table>
<pre class="language-text">&#x4EE3;&#x8868;&#x7684;&#x30C7;&#x30FC;&#x30BF;&#x30BB;&#x30C3;&#x30C8;
    &#x30A2;&#x30EB;&#x30B4;&#x30EA;&#x30BA;&#x30E0;&#x306E;&#x7CBE;&#x5EA6;&#x3092;&#x56F3;&#x308B;&#x306B;&#x306F;&#x3001;&#x5171;&#x901A;&#x306E;&#x30C7;&#x30FC;&#x30BF;&#x30BB;&#x30C3;&#x30C8;&#x304C;&#x5FC5;&#x8981;
    &#x3069;&#x3093;&#x306A;&#x753B;&#x50CF;&#x304C;&#x542B;&#x307E;&#x308C;&#x3066;&#x3044;&#x308B;&#x306E;&#x304B;&#xFF1F;
</pre>
<table>
<thead>
<tr>
<th style="text-align:center">&#x30C7;&#x30FC;&#x30BF;&#x30BB;&#x30C3;&#x30C8;&#x540D;</th>
<th style="text-align:center">&#x30AF;&#x30E9;&#x30B9;</th>
<th style="text-align:center">Train+Val</th>
<th style="text-align:center">BOX/&#x753B;&#x50CF;</th>
<th style="text-align:center" colspan="2">&#x88DC;&#x8DB3;</th>

</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">VOC12</td>
<td style="text-align:center">20</td>
<td style="text-align:center">11,540</td>
<td style="text-align:center">2.4</td>
<td style="text-align:center">Instance<br>Annotation</td>
<td style="text-align:center">Visual Object Class</td>
</tr>
<tr>
<td style="text-align:center">ILSVRC17</td>
<td style="text-align:center">200</td>
<td style="text-align:center">476,668</td>
<td style="text-align:center">1.1</td>
<td style="text-align:center">-</td>
<td style="text-align:center">ImageNet&#x306E;&#x30B5;&#x30D6;&#x30BB;&#x30C3;&#x30C8;<br>ImageNet Scale Visual Recognition Challenge</td>
</tr>
<tr>
<td style="text-align:center">MS COCO18</td>
<td style="text-align:center">80</td>
<td style="text-align:center">123,287</td>
<td style="text-align:center">7.3</td>
<td style="text-align:center">Instance<br>Annotation</td>
<td style="text-align:center">Common Object in Context</td>
</tr>
<tr>
<td style="text-align:center">OICOD18</td>
<td style="text-align:center">500</td>
<td style="text-align:center">1,743,042</td>
<td style="text-align:center">7.0</td>
<td style="text-align:center">Instance<br>Annotation</td>
<td style="text-align:center">Open Images V4&#x306E;&#x30B5;&#x30D6;&#x30BB;&#x30C3;&#x30C8;</td>
</tr>
</tbody>
</table>
<p>&#x203B;&#x3044;&#x305A;&#x308C;&#x3082;&#x7269;&#x4F53;&#x691C;&#x51FA;&#x30B3;&#x30F3;&#x30DA;&#x30F3;&#x30B7;&#x30E7;&#x30F3;&#x3067;&#x7528;&#x3044;&#x3089;&#x308C;&#x305F;&#x30C7;&#x30FC;&#x30BF;&#x30BB;&#x30C3;&#x30C8;<br>
&#x203B;&#x4ED6;&#x306B;&#x3082;CIFAR-10/CIFAR-100,Food-101,<br>
&#x3000;&#x697D;&#x5929;&#x30C7;&#x30FC;&#x30BF;&#xFF08;&#x6587;&#x5B57;&#x9818;&#x57DF;&#x30A2;&#x30CE;&#x30C6;&#x30FC;&#x30B7;&#x30E7;&#x30F3;&#x753B;&#x50CF;&#xFF09;etc.<br>
&#x203B;Instance Annotation&#x3068;&#x306F;&#x7269;&#x4F53;&#x3053;&#x3053;&#x306B;&#x30E9;&#x30D9;&#x30EB;&#x304C;&#x4E0E;&#x3048;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x3092;&#x3055;&#x3059;</p>
<p>BOX/&#x753B;&#x50CF;(1&#x753B;&#x50CF;&#x3042;&#x305F;&#x308A;&#x306B;&#x73FE;&#x308F;&#x308C;&#x308B;BOX&#x306E;&#x6570;)<br>
&#x2192;&#x5C0F;&#x3055;&#x3044;&#xFF1A;&#x30A2;&#x30A4;&#x30B3;&#x30F3;&#x7684;&#x306A;&#x6620;&#x308A;&#x3002;&#x65E5;&#x5E38;&#x611F;&#x3068;&#x306F;&#x304B;&#x3051;&#x96E2;&#x308C;&#x3084;&#x3059;&#x3044;<br>
&#x2192;&#x5927;&#x304D;&#x3044;&#xFF1A;&#x90E8;&#x5206;&#x7684;&#x306A;&#x91CD;&#x306A;&#x308A;&#x7B49;&#x3082;&#x307F;&#x3089;&#x308C;&#x308B;&#x65E5;&#x5E38;&#x306E;&#x30B3;&#x30F3;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x306B;&#x8FD1;&#x3044;</p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E7%89%A9%E4%BD%93%E6%A4%9C%E7%9F%A5_%E3%83%9D%E3%82%B8%E3%82%B7%E3%83%A7%E3%83%8B%E3%83%B3%E3%82%B0%E3%83%9E%E3%83%83%E3%83%97.png" alt="png"><br>
&#x76EE;&#x7684;&#x306B;&#x5FDC;&#x3058;&#x305F;&#x9078;&#x629E;&#x3092;<br>
&#x30AF;&#x30E9;&#x30B9;&#x6570;&#x304C;&#x591A;&#x3044;&#x3053;&#x3068;&#x306F;&#x3046;&#x308C;&#x3057;&#x3044;&#x306E;&#x304B;&#xFF1F;<br>
&#xFF08;&#x540C;&#x3058;&#x3082;&#x306E;&#x306A;&#x306E;&#x306B;&#x9055;&#x3046;&#x30AF;&#x30E9;&#x30B9;&#x5206;&#x3051;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#xFF09;</p>
<pre class="language-text">&#x8A55;&#x4FA1;&#x6307;&#x6A19;
</pre>
<p>Confusion Matrix(&#x6DF7;&#x5408;&#x884C;&#x5217;)</p>
<table>
<thead>
<tr>
<th style="text-align:center"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2193;</mo><mtext>&#x771F;&#x5024;</mtext><mi mathvariant="normal">\</mi><mtext>&#x4E88;&#x6E2C;</mtext><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\downarrow&#x771F;&#x5024;\backslash&#x4E88;&#x6E2C;\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mrel">&#x2193;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x771F;&#x5024;</span><span class="mord">\</span><span class="mord cjk_fallback">&#x4E88;&#x6E2C;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&#x2192;</span></span></span></span></th>
<th style="text-align:center">Positive</th>
<th style="text-align:center">Negative</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Positive</td>
<td style="text-align:center">True<br>Positive</td>
<td style="text-align:center">False<br>Negative</td>
</tr>
<tr>
<td style="text-align:center">Negative</td>
<td style="text-align:center">False<br>Positive</td>
<td style="text-align:center">True<br>Negative</td>
</tr>
</tbody>
</table>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x6B63;&#x89E3;&#x7387;</mtext><mo stretchy="false">(</mo><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">&#x6B63;&#x89E3;&#x7387;(Precision)=\frac{TP}{TP+FP}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x6B63;&#x89E3;&#x7387;</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&#x518D;&#x73FE;&#x7387;</mtext><mo stretchy="false">(</mo><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">&#x518D;&#x73FE;&#x7387;(Recall)=\frac{TP}{TP+FN}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">&#x518D;&#x73FE;&#x7387;</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>confidence&#x306E;&#x95BE;&#x5024;&#x3092;&#x5909;&#x5316;&#x3055;&#x305B;&#x308B;&#x3053;&#x3068;&#x3067;<br>
Precision-Recall curve&#x304C;&#x63CF;&#x3051;&#x308B;</p>
<p>&#x901A;&#x5E38;&#x306E;&#x30AF;&#x30E9;&#x30B9;&#x5206;&#x985E;</p>
<table>
<thead>
<tr>
<th style="text-align:center">No</th>
<th style="text-align:center">confidence</th>
<th style="text-align:center">pred.<br>(threshold=0.5)</th>
<th style="text-align:center">pred.<br>(threshold=0.8)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">s1</td>
<td style="text-align:center">0.88</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">s2</td>
<td style="text-align:center">0.82</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">s3</td>
<td style="text-align:center">0.71</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">s4</td>
<td style="text-align:center">0.52</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">s5</td>
<td style="text-align:center">0.49</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">s6</td>
<td style="text-align:center">0.44</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>
<p>&#x7269;&#x4F53;&#x691C;&#x77E5;</p>
<table>
<thead>
<tr>
<th style="text-align:center">No</th>
<th style="text-align:center">confidence</th>
<th style="text-align:center">pred.<br>(threshold=0.5)</th>
<th style="text-align:center">BB<br>(threshold=0.5)</th>
<th style="text-align:center">pred.<br>(threshold=0.8)</th>
<th style="text-align:center">BB<br>(threshold=0.8)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">p1</td>
<td style="text-align:center">0.92</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">x1,y1<br>w1,h1</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">x1,y1<br>w1,h1</td>
</tr>
<tr>
<td style="text-align:center">p2</td>
<td style="text-align:center">0.85</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">x2,y2<br>w2,h2</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">x2,y2<br>w2,h2</td>
</tr>
<tr>
<td style="text-align:center">p3</td>
<td style="text-align:center">0.81</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">x3,y3<br>w3,h3</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">x3,y3<br>w3,h3</td>
</tr>
<tr>
<td style="text-align:center">p4</td>
<td style="text-align:center">0.70</td>
<td style="text-align:center">&#x72AC;</td>
<td style="text-align:center">x4,y4<br>w4,h4</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">p5</td>
<td style="text-align:center">0.69</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">x5,y5<br>w5,h5</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">p6</td>
<td style="text-align:center">0.54</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">x6,y6<br>w6,h6</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<pre class="language-text">IoU:Intersection over Union
    &#x7269;&#x4F53;&#x691C;&#x51FA;&#x306B;&#x304A;&#x3044;&#x3066;&#x306F;&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;&#x3060;&#x3051;&#x3067;&#x306F;&#x306A;&#x304F;&#x3001;
    &#x7269;&#x4F53;&#x4F4D;&#x7F6E;&#x306E;&#x4E88;&#x6E2C;&#x7CBE;&#x5EA6;&#x3082;&#x8A55;&#x4FA1;&#x3057;&#x305F;&#x3044;&#xFF01;&#xFF01;
</pre>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>o</mi><mi>U</mi><mo>=</mo><mfrac><mrow><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mspace width="1em"></mspace><mi>o</mi><mi>f</mi><mspace width="1em"></mspace><mi>O</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>l</mi><mi>a</mi><mi>p</mi></mrow><mrow><mi>A</mi><mi>r</mi><mi>e</mi><mi>a</mi><mspace width="1em"></mspace><mi>o</mi><mi>f</mi><mspace width="1em"></mspace><mi>U</mi><mi>n</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mspace width="1em"></mspace><mtext>&#x203B;</mtext><mi>J</mi><mi>a</mi><mi>c</mi><mi>c</mi><mi>a</mi><mi>r</mi><mi>d</mi><mtext>&#x4FC2;&#x6570;</mtext></mrow><annotation encoding="application/x-tex">IoU=\frac{Area\quad of\quad Overlap}{Area\quad of\quad Union}=\frac{TP}{TP+FP+FN} \quad &#x203B;Jaccard&#x4FC2;&#x6570;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.4133239999999998em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span><span class="mspace mtight" style="margin-right:1.4285714285714286em;"></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mspace mtight" style="margin-right:1.4285714285714286em;"></span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="mord mathnormal mtight">ni</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">a</span><span class="mspace mtight" style="margin-right:1.4285714285714286em;"></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mspace mtight" style="margin-right:1.4285714285714286em;"></span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">er</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">&#x203B;</span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mord mathnormal">a</span><span class="mord mathnormal">cc</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">&#x4FC2;&#x6570;</span></span></span></span></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E7%89%A9%E4%BD%93%E6%A4%9C%E7%9F%A5_IoU.png" alt="png"></p>
<p>conf.&gt;0.5&#x306E;&#x4E88;&#x6E2C;&#x7FA4;</p>
<table>
<thead>
<tr>
<th style="text-align:center">No</th>
<th style="text-align:center">conf.</th>
<th style="text-align:center">pred.</th>
<th style="text-align:center">IoU</th>
<th style="text-align:left">result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">p1</td>
<td style="text-align:center">0.92</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.88</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">p2</td>
<td style="text-align:center">0.85</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">0.46</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&lt;0.5&#x3088;&#x308A;FP</td>
</tr>
<tr>
<td style="text-align:center">p3</td>
<td style="text-align:center">0.81</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">0.92</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">p4</td>
<td style="text-align:center">0.70</td>
<td style="text-align:center">&#x72AC;</td>
<td style="text-align:center">0.83</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">p5</td>
<td style="text-align:center">0.69</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.76</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3060;&#x304C;<br>&#x691C;&#x51FA;&#x6E08;&#x307F;&#x306A;&#x306E;&#x3067;FP</td>
</tr>
<tr>
<td style="text-align:center">p6</td>
<td style="text-align:center">0.54</td>
<td style="text-align:center">&#x8ECA;</td>
<td style="text-align:center">0.20</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&lt;0.5&#x3088;&#x308A;FP</td>
</tr>
</tbody>
</table>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac><mo>=</mo><mfrac><mn>3</mn><mrow><mn>3</mn><mo>+</mo><mn>3</mn></mrow></mfrac><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">Precition=\frac{TP}{TP+FP}=\frac{3}{3+3}=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0.50</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo>=</mo><mfrac><mn>3</mn><mrow><mn>3</mn><mo>+</mo><mn>0</mn></mrow></mfrac><mo>=</mo><mn>1.00</mn></mrow><annotation encoding="application/x-tex">Recall=\frac{TP}{TP+FN}=\frac{3}{3+0}=1.00</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1.00</span></span></span></span></p>
<p>conf.&#x306E;&#x95BE;&#x5024;:0.5<br>
IoU&#x306E;&#x95BE;&#x5024;:0.5</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">Pic.</th>
<th style="text-align:center">conf.</th>
<th style="text-align:center">pred.</th>
<th style="text-align:center">IoU</th>
<th style="text-align:left">TP/FP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">P1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.92</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.88</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">P2</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0.85</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.46</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&lt;0.5&#x3088;&#x308A;FP</td>
</tr>
<tr>
<td style="text-align:center">P3</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0.81</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.92</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">P4</td>
<td style="text-align:center">3</td>
<td style="text-align:center">0.70</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.83</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3088;&#x308A;TP</td>
</tr>
<tr>
<td style="text-align:center">P5</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0.69</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.76</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&gt;0.5&#x3060;&#x304C;<br>&#x691C;&#x51FA;&#x6E08;&#x307F;&#x306A;&#x306E;&#x3067;FP</td>
</tr>
<tr>
<td style="text-align:center">P6</td>
<td style="text-align:center">3</td>
<td style="text-align:center">0.54</td>
<td style="text-align:center">&#x4EBA;</td>
<td style="text-align:center">0.20</td>
<td style="text-align:left"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#x2192;</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">&#x2192;</span></span></span></span> IoU&lt;0.5&#x3088;&#x308A;FP</td>
</tr>
</tbody>
</table>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mi>e</mi><mi>c</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>P</mi></mrow></mfrac><mo>=</mo><mfrac><mn>3</mn><mrow><mn>3</mn><mo>+</mo><mn>3</mn></mrow></mfrac><mo>=</mo><mn>0.50</mn></mrow><annotation encoding="application/x-tex">Precition=\frac{TP}{TP+FP}=\frac{3}{3+3}=0.50</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">rec</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">FP</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="mord mtight">3</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0.50</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>e</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>l</mi><mo>=</mo><mfrac><mrow><mi>T</mi><mi>P</mi></mrow><mrow><mi>T</mi><mi>P</mi><mo>+</mo><mi>F</mi><mi>N</mi></mrow></mfrac><mo>=</mo><mfrac><mn>3</mn><mrow><mn>3</mn><mo>+</mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">Recall=\frac{TP}{TP+FN}=\frac{3}{3+1}=0.75</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">ec</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">ll</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275662em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">FN</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">TP</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.2484389999999999em;vertical-align:-0.403331em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.403331em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0.75</span></span></span></span><br>
False Negative&#x304C;1&#x3064;&#x5B58;&#x5728;&#x3059;&#x308B;&#x306E;&#x3067;+1(Pic4)<br>
&#x3000;All-Gound-Truth</p>
<p>PR&#x66F2;&#x7DDA;&#xFF1A;IoU&#x306E;&#x95BE;&#x5024;&#x3092;&#x56FA;&#x5B9A;&#x3057;confidence&#x306E;&#x95BE;&#x5024;&#x3092;&#x5909;&#x3048;&#x306A;&#x304C;&#x3089;&#x63CF;&#x3051;&#x308B;&#x66F2;&#x7DDA;<br>
<img src="./img/%E6%B7%B1%E5%B1%A4day4_%E7%89%A9%E4%BD%93%E6%A4%9C%E7%9F%A5_PRcurve.png" alt="png"></p>
<h3 class="mume-header" id="def-average-precision">Def. Average Precision</h3>

<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>P</mi><mo>=</mo><mstyle scriptlevel="0" displaystyle="true"><msubsup><mo>&#x222B;</mo><mn>0</mn><mn>1</mn></msubsup><mi>P</mi><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mi>d</mi><mi>R</mi><mo stretchy="false">(</mo><mtext>&#x548C;&#x8A33;&#xFF1A;</mtext><mi>P</mi><mi>R</mi><mtext>&#x66F2;&#x7DDA;&#x306E;&#x4E0B;&#x5074;&#x9762;&#x7A4D;&#xFF09;</mtext></mstyle></mrow><annotation encoding="application/x-tex">AP=\displaystyle \int_{0}^{1} P(R)dR (&#x548C;&#x8A33;&#xFF1A;PR&#x66F2;&#x7DDA;&#x306E;&#x4E0B;&#x5074;&#x9762;&#x7A4D;&#xFF09;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.4759580000000003em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5640080000000003em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord cjk_fallback">&#x548C;&#x8A33;&#xFF1A;</span><span class="mord mathnormal" style="margin-right:0.00773em;">PR</span><span class="mord cjk_fallback">&#x66F2;&#x7DDA;&#x306E;&#x4E0B;&#x5074;&#x9762;&#x7A4D;&#xFF09;</span></span></span></span><br>
&#x305F;&#x3060;&#x3057;&#x3001;&#x3053;&#x308C;&#x306F;&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;&#x56FA;&#x5B9A;&#x306E;&#x5143;&#x8003;&#x3048;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x306B;&#x6CE8;&#x610F;</p>
<h3 class="mume-header" id="mapmean-average-precision">mAP:mean Average Precision</h3>

<p>&#x7B97;&#x8853;&#x5E73;&#x5747;:&#x30AF;&#x30E9;&#x30B9;&#x6570;&#x304C;C&#x306E;&#x3068;&#x304D;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>A</mi><mi>P</mi><mo>=</mo><mfrac><mn>1</mn><mi>C</mi></mfrac><mstyle scriptlevel="0" displaystyle="true"><munderover><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>A</mi><msub><mi>P</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">mAP=\frac{1}{C}\displaystyle \sum_{i=1}^C AP_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">&#x8ECA;</th>
<th style="text-align:center">&#x4EBA;</th>
<th style="text-align:center">&#x72AC;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">AP</td>
<td style="text-align:center">86.4</td>
<td style="text-align:center">67.2</td>
<td style="text-align:center">64.3</td>
</tr>
<tr>
<td style="text-align:center">mAP</td>
<td style="text-align:center" colspan="3">&#x7D04;72.6</td>


</tr>
</tbody>
</table>
<p>MS COCO&#x3067;&#x5C0E;&#x5165;&#x3055;&#x308C;&#x305F;&#x6307;&#x6A19;<br>
IoU&#x95BE;&#x5024;&#x3092;0.5&#x304B;&#x3089;0.95&#x307E;&#x3067;0.05&#x523B;&#x307F;&#x3067;AP&amp;mAP&#x3092;&#x8A08;&#x7B97;&#x3057;&#x7B97;&#x8853;&#x5E73;&#x5747;&#x3092;&#x8A08;&#x7B97;</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>A</mi><msub><mi>P</mi><mrow><mi>c</mi><mi>o</mi><mi>c</mi><mi>o</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>m</mi><mi>A</mi><msub><mi>P</mi><mn>0.5</mn></msub><mo>+</mo><mi>m</mi><mi>A</mi><msub><mi>P</mi><mn>0.55</mn></msub><mo>+</mo><mo>&#x22C5;</mo><mo>+</mo><mi>m</mi><mi>A</mi><msub><mi>P</mi><mn>0.95</mn></msub></mrow><mn>10</mn></mfrac></mrow><annotation encoding="application/x-tex">mAP_{coco}=\frac{mAP_{0.5}+mAP_{0.55}+\cdot +mAP_{0.95}}{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">coco</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.233431em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8884309999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">A</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0.5</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">A</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0.55</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">+&#x22C5;+</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">A</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">0.95</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h3 class="mume-header" id="fpsflames-per-second">FPS(Flames per Second)</h3>

<p>&#x5FDC;&#x7528;&#x4E0A;&#x306E;&#x8981;&#x8ACB;&#x304B;&#x3089;&#x3001;&#x691C;&#x51FA;&#x7CBE;&#x5EA6;&#x306B;&#x52A0;&#x3048;&#x691C;&#x51FA;&#x901F;&#x5EA6;&#x3082;&#x554F;&#x984C;&#x3068;&#x306A;&#x308B;&#x3002;</p>
<p>2012 AlexNet&#x306E;&#x767B;&#x5834;&#x3092;&#x76AE;&#x5207;&#x308A;&#x306B;&#x3001;&#x6642;&#x4EE3;&#x306F;SIFT&#x304B;&#x3089;DCNN&#x3078;</p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x5E74;</th>
<th style="text-align:center">&#x4EE3;&#x8868;&#x7684;&#x306A;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;</th>
<th style="text-align:center">&#x7269;&#x4F53;&#x691C;&#x77E5;&#x306E;&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2012</td>
<td style="text-align:center">AlexNet</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td style="text-align:center">2013</td>
<td style="text-align:center">-</td>
<td style="text-align:center">DetectorNet/RCNN</td>
</tr>
<tr>
<td style="text-align:center">2014</td>
<td style="text-align:center">VGGNet/GoogLeNet</td>
<td style="text-align:center">SPPNet</td>
</tr>
<tr>
<td style="text-align:center">2015</td>
<td style="text-align:center">ResNet</td>
<td style="text-align:center">Fast RCNN/Faster RCNN<br>YOLO/SSD</td>
</tr>
<tr>
<td style="text-align:center">2016</td>
<td style="text-align:center">Inception-ResNet/DenseNet</td>
<td style="text-align:center">RFCN/YOLO9000</td>
</tr>
<tr>
<td style="text-align:center">2017</td>
<td style="text-align:center">MobileNet</td>
<td style="text-align:center">FPN/Mask RCNN/RetinaNet</td>
</tr>
<tr>
<td style="text-align:center">2018</td>
<td style="text-align:center">AmoebaNet</td>
<td style="text-align:center">CornerNet</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:left">&#x691C;&#x51FA;&#x5668;</th>
<th style="text-align:left">&#x8AAC;&#x660E;</th>
<th style="text-align:left">&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2&#x6BB5;&#x968E;&#x691C;&#x51FA;&#x5668;<br>(Two-stage detector)</td>
<td style="text-align:left">&#x30FB;&#x5019;&#x88DC;&#x9818;&#x57DF;&#x306E;&#x691C;&#x51FA;&#x3068;&#x30AF;&#x30E9;&#x30B9;&#x63A8;&#x5B9A;&#x3092;<br>&#x5225;&#x3005;&#x306B;&#x884C;&#x3046;<br>&#x30FB;&#x76F8;&#x5BFE;&#x7684;&#x306B;&#x7CBE;&#x5EA6;&#x304C;&#x9AD8;&#x3044;&#x50BE;&#x5411;<br>&#x30FB;&#x76F8;&#x5BFE;&#x7684;&#x306B;&#x8A08;&#x7B97;&#x91CF;&#x304C;&#x5927;&#x304D;&#x304F;<br>&#x63A8;&#x8AD6;&#x3082;&#x9045;&#x3044;&#x50BE;&#x5411;</td>
<td style="text-align:left">RCNN<br>SPPNet<br>Fast RCNN<br>RFCN<br>FPN<br>Mask RCNN</td>
</tr>
<tr>
<td style="text-align:left">1&#x6BB5;&#x968E;&#x691C;&#x51FA;&#x5668;<br>(One-stage detector)</td>
<td style="text-align:left">&#x30FB;&#x5019;&#x88DC;&#x9818;&#x57DF;&#x306E;&#x691C;&#x51FA;&#x3068;&#x30AF;&#x30E9;&#x30B9;&#x63A8;&#x5B9A;&#x3092;<br>&#x540C;&#x6642;&#x306B;&#x884C;&#x3046;<br>&#x30FB;&#x76F8;&#x5BFE;&#x7684;&#x306B;&#x7CBE;&#x5EA6;&#x304C;&#x4F4E;&#x3044;&#x50BE;&#x5411;<br>&#x30FB;&#x76F8;&#x5BFE;&#x7684;&#x306B;&#x8A08;&#x7B97;&#x91CF;&#x304C;&#x5C0F;&#x3055;&#x304F;<br>&#x63A8;&#x8AD6;&#x3082;&#x65E9;&#x3044;&#x50BE;&#x5411;</td>
<td style="text-align:left">DetctorNet<br>SSD<br>YOLO<br>YOLO9000<br>RetinaNet<br>CornerNet</td>
</tr>
</tbody>
</table>
<p>SSD:Single Shot Detector<br>
VGG16&#x304C;&#x30D9;&#x30FC;&#x30B9;&#x3068;&#x306A;&#x308B;&#x3002;</p>
<p>&#x30DE;&#x30C3;&#x30D7;&#x4E2D;&#x306E;&#xFF11;&#x3064;&#x306E;&#x7279;&#x5FB4;&#x91CF;&#x306B;&#x304A;&#x3051;&#x308B;1&#x3064;&#x306E;Default Box&#x306B;&#x3064;&#x3044;&#x3066;<br>
&#x51FA;&#x529B;&#x30B5;&#x30A4;&#x30BA;:#<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>+</mo><mn>4</mn><mo stretchy="false">(</mo><mtext>&#x30AA;&#x30D5;&#x30BB;&#x30C3;&#x30C8;&#x9805;</mtext><mo>:</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>x</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>y</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>w</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>h</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Class + 4(&#x30AA;&#x30D5;&#x30BB;&#x30C3;&#x30C8;&#x9805;:\Delta_{x},\Delta_{y},\Delta_{w},\Delta_{h})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Cl</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mopen">(</span><span class="mord cjk_fallback">&#x30AA;&#x30D5;&#x30BB;&#x30C3;&#x30C8;&#x9805;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>&#x30DE;&#x30C3;&#x30D7;&#x4E2D;&#x306E;&#x5404;&#x7279;&#x5FB4;&#x91CF;&#x306B;k&#x500B;&#x306E;Default Box&#x3092;&#x7528;&#x610F;&#x3059;&#x308B;&#x3068;&#x304D;&#x3001;<br>
&#x51FA;&#x529B;&#x30B5;&#x30A4;&#x30BA;:k(#<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>+</mo><mn>4</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Class + 4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Cl</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span></span></span></span></p>
<p>&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x306E;&#x30B5;&#x30A4;&#x30BA;&#x304C;m&#xD7;n&#x306E;&#x5834;&#x5408;<br>
&#x51FA;&#x529B;&#x30B5;&#x30A4;&#x30BA;:k(#<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>+</mo><mn>4</mn><mo stretchy="false">)</mo><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Class + 4) mn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">Cl</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ss</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mclose">)</span><span class="mord mathnormal">mn</span></span></span></span></p>
<p>&#x7279;&#x5FB4;&#x30DE;&#x30C3;&#x30D7;&#x3054;&#x3068;&#x306B;&#x7528;&#x610F;&#x3059;&#x308B;DefaultBox&#x6570;&#xFF1A;k&#xD7;mn</p>
<p>SSD&#x306B;&#x304A;&#x3051;&#x308B;&#x30AA;&#x30D5;&#x30BB;&#x30C3;&#x30C8;&#x9805;&#x76EE;&#x306E;&#x6CE8;&#x610F;<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><mn>0.1</mn><mo>&#xD7;</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>x</mi></msub><mo>&#xD7;</mo><msub><mi>w</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x=x_0+0.1&#xD7;\Delta_x&#xD7;w_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0.1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><mn>0.1</mn><mo>&#xD7;</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>y</mi></msub><mo>&#xD7;</mo><msub><mi>h</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">y=y_0+0.1&#xD7;\Delta_y&#xD7;h_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0.1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>&#xD7;</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mn>0.2</mn><mo>&#xD7;</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>w</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w=w_0&#xD7;\exp(0.2&#xD7;\Delta_w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">0.2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msub><mi>h</mi><mn>0</mn></msub><mo>&#xD7;</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mn>0.2</mn><mo>&#xD7;</mo><msub><mi mathvariant="normal">&#x394;</mi><mi>h</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h=h_0&#xD7;\exp(0.2&#xD7;\Delta_h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">0.2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><img src="./img/%E6%B7%B1%E5%B1%A4day4_%E7%89%A9%E4%BD%93%E6%A4%9C%E7%9F%A5_SSD_DefaultBox2.png" alt="png"></p>
<p>&#x591A;&#x6570;&#x306E;DefaultBox&#x3092;&#x7528;&#x610F;&#x3057;&#x305F;&#x3053;&#x3068;&#x3067;&#x751F;&#x305A;&#x308B;&#x554F;&#x984C;&#x306E;&#x5BFE;&#x51E6;</p>
<p>Non-Maximum Suppression<br>
&#x2192;&#x540C;&#x3058;&#x7269;&#x4F53;&#x3092;&#x8907;&#x6570;&#x306E;DefaultBox&#x3067;&#x691C;&#x51FA;&#x3057;&#x3066;&#x3057;&#x307E;&#x3046;&#x3002;<br>
IoU&#x3068;Confidence&#x304C;&#x6700;&#x3082;&#x9AD8;&#x3044;&#x3082;&#x306E;&#x3092;&#x63A1;&#x7528;<br>
&#x203B;RCNN&#x3067;&#x3082;&#x65E2;&#x306B;&#x7528;&#x3044;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<p>Hard Negative Mining<br>
&#x2192;&#x80CC;&#x666F;(Negatove)&#x3068;&#x3057;&#x3066;&#x691C;&#x51FA;&#x3055;&#x308C;&#x308B;Bounding Box&#x304C;&#x591A;&#x304F;&#x306A;&#x308A;&#x4E0D;&#x5747;&#x8861;&#x3068;&#x306A;&#x308B;<br>
Positive&#x3068;Negative&#x306E;&#x5272;&#x5408;&#x3092;1:3&#x306B;&#x3059;&#x308B;&#x3002;</p>
<p>DSSD:Deconvolution Single Shot Detector<br>
&#x2192;ResNet&#x3092;&#x7528;&#x3044;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<h3 class="mume-header" id="14-1%E8%AC%9B%E7%BE%A9%E5%86%85%E5%AE%B9%E3%81%BE%E3%81%A8%E3%82%81">14-1.&#x8B1B;&#x7FA9;&#x5185;&#x5BB9;&#x307E;&#x3068;&#x3081;</h3>

<pre class="language-text">&#x3053;&#x306E;&#x9805;&#x3067;&#x306F;&#x7269;&#x4F53;&#x691C;&#x77E5;&#x306B;&#x4FC2;&#x308B;&#x57FA;&#x790E;&#x77E5;&#x8B58;&#x3068;&#x8A55;&#x4FA1;&#x6307;&#x6A19;&#x306B;&#x3064;&#x3044;&#x3066;&#x5B66;&#x3093;&#x3060;&#x3002;
&#x4E0E;&#x3048;&#x3089;&#x308C;&#x305F;&#x753B;&#x50CF;&#x306B;&#x5BFE;&#x3057;&#x3066;&#x3001;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x306B;Bounding Box&#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x77E9;&#x5F62;&#x9818;&#x57DF;&#x3092;&#x914D;&#x7F6E;&#x3057;&#x3001;
&#x6307;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x30AF;&#x30E9;&#x30B9;&#x30E9;&#x30D9;&#x30EB;&#x306B;&#x5BFE;&#x3059;&#x308B;confidence&#x3092;&#x6700;&#x9069;&#x5316;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;
&#x77E9;&#x5F62;&#x9818;&#x57DF;&#x3092;&#x8ABF;&#x6574;&#x3057;&#x3066;&#x3044;&#x304F;&#x65B9;&#x6CD5;&#x304C;&#x3068;&#x3089;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;
&#x8A55;&#x4FA1;&#x6307;&#x6A19;&#x3068;&#x3057;&#x3066;IoU&#x3068;&#x3044;&#x3046;&#x7269;&#x4F53;&#x691C;&#x77E5;&#x306E;&#x4F4D;&#x7F6E;&#x306E;&#x78BA;&#x304B;&#x3089;&#x3057;&#x3055;&#x3092;&#x8868;&#x3059;&#x3082;&#x306E;&#x304C;&#x3042;&#x308B;&#x304C;&#x3001;
&#x306A;&#x305C;&#x30AA;&#x30FC;&#x30D0;&#x30FC;&#x30E9;&#x30C3;&#x30D7;&#x3057;&#x3066;&#x3044;&#x308B;&#x5272;&#x5408;&#x3092;&#x7528;&#x3044;&#x3066;&#x3044;&#x308B;&#x304B;&#x3001;&#x3068;&#x3044;&#x3046;&#x80CC;&#x666F;&#x306B;&#x3064;&#x3044;&#x3066;
&#x89E3;&#x8AAC;&#x524D;&#x306B;&#x81EA;&#x554F;&#x81EA;&#x7B54;&#x3067;&#x304D;&#x305F;&#x3053;&#x3068;&#x306F;&#x5927;&#x304D;&#x3044;&#x3002;
&#x6B63;&#x89E3;&#x7387;&#x3068;&#x518D;&#x73FE;&#x7387;&#x306E;&#x6C42;&#x3081;&#x65B9;&#x306B;&#x3064;&#x3044;&#x3066;&#x3082;&#x901A;&#x5E38;&#x306E;&#x30AF;&#x30E9;&#x30B9;&#x5206;&#x985E;&#x3068;&#x306F;&#x9055;&#x3044;&#x3001;confidence&#x3068;
IoU2&#x3064;&#x306E;&#x6307;&#x6A19;&#x306B;&#x57FA;&#x3065;&#x3044;&#x3066;&#x6C7A;&#x5B9A;&#x3055;&#x308C;&#x308B;&#x3002;&#x3042;&#x308B;&#x7279;&#x5B9A;&#x306E;&#x30AF;&#x30E9;&#x30B9;&#x30EC;&#x30D9;&#x30EB;&#x306B;&#x5BFE;&#x3059;&#x308B;
&#x8A55;&#x4FA1;&#x304C;&#x660E;&#x793A;&#x3055;&#x308C;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F;False Negative&#x3068;&#x3057;&#x3066;&#x518D;&#x73FE;&#x7387;&#x306E;&#x5206;&#x6BCD;&#x306B;&#x52A0;&#x3048;&#x3089;&#x308C;&#x308B;
&#x70B9;&#x306F;&#x5F53;&#x521D;&#x306F;&#x7406;&#x89E3;&#x304C;&#x81F3;&#x3089;&#x306A;&#x304B;&#x3063;&#x305F;&#x304C;&#x3059;&#x3079;&#x3066;&#x306E;Ground-Truth&#x304C;&#x5206;&#x6BCD;&#x3068;&#x3057;&#x3066;
&#x8868;&#x308C;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;&#x3053;&#x3068;&#x304C;&#x5F90;&#x3005;&#x306B;&#x7406;&#x89E3;&#x3067;&#x304D;&#x305F;&#x3002;
&#x30D5;&#x30EC;&#x30FC;&#x30E0;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x4F8B;&#x3068;&#x3057;&#x3066;VGG16&#x3092;&#x30D9;&#x30FC;&#x30B9;&#x3068;&#x3057;&#x305F;SSD&#x304C;&#x53D6;&#x308A;&#x4E0A;&#x3052;&#x3089;&#x308C;&#x305F;&#x304C;&#x3001;
&#x69CB;&#x9020;&#x3092;&#x8A73;&#x3057;&#x304F;&#x3072;&#x3082;&#x89E3;&#x304F;&#x3068;&#x8A08;&#x7B97;&#x306B;&#x3088;&#x308A;&#x30C7;&#x30D5;&#x30A9;&#x30EB;&#x30C8;&#x30DC;&#x30C3;&#x30AF;&#x30B9;&#x306E;&#x6570;&#x304C;8,732&#x500B;&#x3068;&#x306A;&#x308B;&#x3002;
&#x305F;&#x3060;&#x76EE;&#x65B0;&#x3057;&#x3055;&#x306F;&#x306A;&#x304F;&#x3053;&#x308C;&#x307E;&#x3067;&#x5B66;&#x3093;&#x3060;&#x7573;&#x307F;&#x8FBC;&#x307F;&#x30CB;&#x30E5;&#x30FC;&#x30E9;&#x30EB;&#x30CD;&#x30C3;&#x30C8;&#x30EF;&#x30FC;&#x30AF;&#x306E;&#x5FDC;&#x7528;&#x306B;&#x3088;&#x308A;&#x3001;
&#x7269;&#x4F53;&#x691C;&#x77E5;&#x3092;&#x5B9F;&#x73FE;&#x3067;&#x304D;&#x3066;&#x3044;&#x308B;&#x3053;&#x3068;&#x304C;&#x7406;&#x89E3;&#x3067;&#x304D;&#x305F;&#x3002;
</pre>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>